"use strict";(self.webpackChunkclg_web=self.webpackChunkclg_web||[]).push([[383],{7091:()=>{},7521:(e,t,s)=>{s.r(t),s.d(t,{default:()=>fe});var n=s(5043),a=s(184),d=s(4706),i=s(579);const r=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!1);(0,n.useEffect)(()=>{r()},[]);const r=async()=>{t([{_id:"1",message:"System maintenance scheduled for tonight",type:"warning"},{_id:"2",message:"New feature update available",type:"info"}])};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsxs)("div",{className:"dashboard-header",children:[(0,i.jsx)("h1",{children:"Dashboard"}),(0,i.jsxs)("div",{className:"alert-icon",onClick:()=>a(!s),children:["\ud83d\udd14",e.length>0&&(0,i.jsx)("span",{className:"alert-count",children:e.length})]})]}),(0,i.jsx)("p",{children:"Welcome to the Admin Dashboard. Here is a quick overview of the school management system."}),s&&(0,i.jsx)("div",{className:"alerts-panel",children:0===e.length?(0,i.jsx)("p",{children:"No new alerts."}):e.map(s=>(0,i.jsx)(d.A,{message:s.message,type:s.type,onClose:()=>{return n=s._id,void t(e.filter(e=>e._id!==n));var n},duration:5e3},s._id))}),(0,i.jsxs)("div",{className:"stats-grid",children:[(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("h3",{children:"Total Students"}),(0,i.jsx)("p",{children:"1200"})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("h3",{children:"Total Staff"}),(0,i.jsx)("p",{children:"150"})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("h3",{children:"Pending Fees"}),(0,i.jsx)("p",{children:"\u20b950000"})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("h3",{children:"Today\u2019s Attendance"}),(0,i.jsx)("p",{children:"95%"})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("h3",{children:"Upcoming Exams"}),(0,i.jsx)("p",{children:"3"})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("h3",{children:"Active Enquiries"}),(0,i.jsx)("p",{children:"25"})]})]}),(0,i.jsx)("p",{children:"Use the side navigation to access different modules."})]})};var l=s(9379),o=s(9722);const c=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(null),[d,r]=(0,n.useState)({title:"",body:"",priority:"normal",category:"general",audience_scope:{roles:[],class_ids:[],course_ids:[],department_ids:[],student_ids:[]},channels:{in_app:!0,email:!1,sms:!1},attachments:[],publish_at:"",expires_at:"",session_id:""}),[c,p]=(0,n.useState)({status:"",category:"",priority:"",session_id:""}),[x,h]=(0,n.useState)("list"),[u,m]=(0,n.useState)(!1),g=(0,n.useCallback)(async()=>{m(!0);try{const e=await o.A.get("/api/notice",{params:c});t(e.data)}catch(e){console.error("Error fetching notices:",e)}m(!1)},[c]);(0,n.useEffect)(()=>{"list"===x&&g()},[x,g]);const j=e=>{const{name:t,value:s}=e.target;r((0,l.A)((0,l.A)({},d),{},{[t]:s}))},y=(e,t)=>{r((0,l.A)((0,l.A)({},d),{},{audience_scope:(0,l.A)((0,l.A)({},d.audience_scope),{},{[e]:t})}))},b=(e,t)=>{r((0,l.A)((0,l.A)({},d),{},{channels:(0,l.A)((0,l.A)({},d.channels),{},{[e]:t})}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Circulars / Notice"}),(0,i.jsx)("p",{children:"Create and manage notices for students and staff."}),(0,i.jsxs)("div",{className:"button-group",children:[(0,i.jsx)("button",{className:"btn",onClick:()=>{r({title:"",body:"",priority:"normal",category:"general",audience_scope:{roles:[],class_ids:[],course_ids:[],department_ids:[],student_ids:[]},channels:{in_app:!0,email:!1,sms:!1},attachments:[],publish_at:"",expires_at:"",session_id:""}),a(null),h("form")},children:"Create Notice"}),(0,i.jsx)("button",{className:"btn",onClick:()=>h("list"),children:"View Notices"})]}),"list"===x&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{children:"View Notices"}),(0,i.jsxs)("div",{className:"filters",children:[(0,i.jsxs)("select",{name:"status",value:c.status,onChange:e=>p((0,l.A)((0,l.A)({},c),{},{status:e.target.value})),children:[(0,i.jsx)("option",{value:"",children:"All Status"}),(0,i.jsx)("option",{value:"draft",children:"Draft"}),(0,i.jsx)("option",{value:"scheduled",children:"Scheduled"}),(0,i.jsx)("option",{value:"published",children:"Published"}),(0,i.jsx)("option",{value:"archived",children:"Archived"}),(0,i.jsx)("option",{value:"cancelled",children:"Cancelled"})]}),(0,i.jsxs)("select",{name:"category",value:c.category,onChange:e=>p((0,l.A)((0,l.A)({},c),{},{category:e.target.value})),children:[(0,i.jsx)("option",{value:"",children:"All Categories"}),(0,i.jsx)("option",{value:"academic",children:"Academic"}),(0,i.jsx)("option",{value:"exam",children:"Exam"}),(0,i.jsx)("option",{value:"fee",children:"Fee"}),(0,i.jsx)("option",{value:"general",children:"General"}),(0,i.jsx)("option",{value:"transport",children:"Transport"}),(0,i.jsx)("option",{value:"hostel",children:"Hostel"})]}),(0,i.jsxs)("select",{name:"priority",value:c.priority,onChange:e=>p((0,l.A)((0,l.A)({},c),{},{priority:e.target.value})),children:[(0,i.jsx)("option",{value:"",children:"All Priorities"}),(0,i.jsx)("option",{value:"low",children:"Low"}),(0,i.jsx)("option",{value:"normal",children:"Normal"}),(0,i.jsx)("option",{value:"high",children:"High"})]}),(0,i.jsx)("input",{type:"text",placeholder:"Session ID",value:c.session_id,onChange:e=>p((0,l.A)((0,l.A)({},c),{},{session_id:e.target.value}))})]}),u?(0,i.jsx)("p",{children:"Loading..."}):(0,i.jsx)("ul",{className:"notice-list",children:e.map(e=>(0,i.jsxs)("li",{children:[(0,i.jsx)("h3",{children:e.title}),(0,i.jsxs)("p",{children:[e.body.substring(0,100),"..."]}),(0,i.jsxs)("p",{children:["Status: ",e.status]}),(0,i.jsx)("button",{onClick:()=>(e=>{a(e),r({title:e.title,body:e.body,priority:e.priority,category:e.category,audience_scope:e.audience_scope,channels:e.channels,attachments:e.attachments,publish_at:e.publish_at,expires_at:e.expires_at,session_id:e.session_id}),h("form")})(e),children:"Edit"}),"draft"===e.status&&(0,i.jsx)("button",{onClick:()=>(async e=>{try{await o.A.post("/api/notice/".concat(e,"/publish")),alert("Notice published"),g()}catch(t){console.error("Error publishing notice:",t)}})(e.circular_id),children:"Publish Now"}),"draft"===e.status&&(0,i.jsx)("button",{onClick:()=>(async e=>{try{await o.A.post("/api/notice/".concat(e,"/schedule")),alert("Notice scheduled"),g()}catch(t){console.error("Error scheduling notice:",t)}})(e.circular_id),children:"Schedule"}),"published"===e.status&&(0,i.jsx)("button",{onClick:()=>(async e=>{try{await o.A.post("/api/notice/".concat(e,"/archive")),alert("Notice archived"),g()}catch(t){console.error("Error archiving notice:",t)}})(e.circular_id),children:"Archive"}),"published"===e.status&&(0,i.jsx)("button",{onClick:()=>(async e=>{try{await o.A.post("/api/notice/".concat(e,"/cancel")),alert("Notice cancelled"),g()}catch(t){console.error("Error cancelling notice:",t)}})(e.circular_id),children:"Cancel"}),(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=1;await o.A.post("/api/notice/".concat(e,"/read"),{recipient_id:t}),alert("Marked as read")}catch(t){console.error("Error marking as read:",t)}})(e.circular_id),children:"Mark as Read"})]},e.circular_id))})]}),"form"===x&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{children:s?"Edit Notice":"Create Notice"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s?(async()=>{try{await o.A.put("/api/notice/".concat(s.circular_id),d),alert("Notice updated"),h("list"),g()}catch(e){console.error("Error updating notice:",e)}})():(async()=>{try{await o.A.post("/api/notice",d),alert("Notice created as draft"),h("list"),g()}catch(e){console.error("Error creating notice:",e)}})()},children:[(0,i.jsx)("label",{children:"Title:"}),(0,i.jsx)("input",{type:"text",name:"title",value:d.title,onChange:j,required:!0}),(0,i.jsx)("label",{children:"Body:"}),(0,i.jsx)("textarea",{name:"body",value:d.body,onChange:j,required:!0}),(0,i.jsx)("label",{children:"Priority:"}),(0,i.jsxs)("select",{name:"priority",value:d.priority,onChange:j,children:[(0,i.jsx)("option",{value:"low",children:"Low"}),(0,i.jsx)("option",{value:"normal",children:"Normal"}),(0,i.jsx)("option",{value:"high",children:"High"})]}),(0,i.jsx)("label",{children:"Category:"}),(0,i.jsxs)("select",{name:"category",value:d.category,onChange:j,children:[(0,i.jsx)("option",{value:"academic",children:"Academic"}),(0,i.jsx)("option",{value:"exam",children:"Exam"}),(0,i.jsx)("option",{value:"fee",children:"Fee"}),(0,i.jsx)("option",{value:"general",children:"General"}),(0,i.jsx)("option",{value:"transport",children:"Transport"}),(0,i.jsx)("option",{value:"hostel",children:"Hostel"})]}),(0,i.jsx)("label",{children:"Audience Scope:"}),(0,i.jsx)("input",{type:"text",placeholder:"Roles (comma separated)",value:d.audience_scope.roles?d.audience_scope.roles.join(","):"",onChange:e=>y("roles",e.target.value.split(","))}),(0,i.jsx)("input",{type:"text",placeholder:"Class IDs (comma separated)",value:d.audience_scope.class_ids?d.audience_scope.class_ids.join(","):"",onChange:e=>y("class_ids",e.target.value.split(","))}),(0,i.jsx)("label",{children:"Channels:"}),(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:d.channels.in_app,onChange:e=>b("in_app",e.target.checked)})," In-App"]}),(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:d.channels.email,onChange:e=>b("email",e.target.checked)})," Email"]}),(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:d.channels.sms,onChange:e=>b("sms",e.target.checked)})," SMS"]}),(0,i.jsx)("label",{children:"Attachments:"}),(0,i.jsx)("input",{type:"file",multiple:!0,onChange:e=>{return t=Array.from(e.target.files),void r((0,l.A)((0,l.A)({},d),{},{attachments:t}));var t}}),(0,i.jsx)("label",{children:"Publish At:"}),(0,i.jsx)("input",{type:"datetime-local",name:"publish_at",value:d.publish_at,onChange:j}),(0,i.jsx)("label",{children:"Expires At:"}),(0,i.jsx)("input",{type:"datetime-local",name:"expires_at",value:d.expires_at,onChange:j}),(0,i.jsx)("label",{children:"Session ID:"}),(0,i.jsx)("input",{type:"text",name:"session_id",value:d.session_id,onChange:j}),(0,i.jsxs)("button",{type:"submit",children:[s?"Update":"Create"," Notice"]})]})]})]})};var p=s(5496);const x=()=>{const[e,t]=(0,n.useState)({title:"",description:"",deadline:"",priority:"Medium"}),[s,a]=(0,n.useState)(!1),[d,r]=(0,n.useState)(""),o=s=>{t((0,l.A)((0,l.A)({},e),{},{[s.target.name]:s.target.value}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Add Work"}),(0,i.jsx)("p",{children:"Create new tasks for staff members."}),d&&(0,i.jsx)("div",{className:"alert ".concat(d.includes("success")?"alert-success":"alert-error"),children:d}),(0,i.jsxs)("form",{onSubmit:async s=>{s.preventDefault(),a(!0),r("");try{const s=await p.AP.createTask(e);s.success?(r("Task created successfully!"),t({title:"",description:"",deadline:"",priority:"Medium"})):r(s.error||"Failed to create task")}catch(n){r("An error occurred while creating the task")}finally{a(!1)}},className:"work-form",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"title",children:"Task Title *"}),(0,i.jsx)("input",{type:"text",id:"title",name:"title",value:e.title,onChange:o,required:!0,placeholder:"Enter task title"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"description",children:"Description *"}),(0,i.jsx)("textarea",{id:"description",name:"description",value:e.description,onChange:o,required:!0,placeholder:"Enter task description",rows:"4"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"deadline",children:"Deadline *"}),(0,i.jsx)("input",{type:"date",id:"deadline",name:"deadline",value:e.deadline,onChange:o,required:!0,min:(new Date).toISOString().split("T")[0]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"priority",children:"Priority"}),(0,i.jsxs)("select",{id:"priority",name:"priority",value:e.priority,onChange:o,children:[(0,i.jsx)("option",{value:"Low",children:"Low"}),(0,i.jsx)("option",{value:"Medium",children:"Medium"}),(0,i.jsx)("option",{value:"High",children:"High"})]})]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:s,children:s?"Creating...":"Create Task"})]})]})},h=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)({task_id:"",staff_id:"",notes:""}),[o,c]=(0,n.useState)(!1),[x,h]=(0,n.useState)(""),[u,m]=(0,n.useState)(!0);(0,n.useEffect)(()=>{g()},[]);const g=async()=>{try{const[e,s]=await Promise.all([p.AP.getAllTasks(),p.$I.getStaff()]);if(e.success){const s=e.data.filter(e=>"Open"===e.status);t(s)}s.success&&a(s.data)}catch(e){h("Failed to load data")}finally{m(!1)}},j=e=>{r((0,l.A)((0,l.A)({},d),{},{[e.target.name]:e.target.value}))};return u?(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Assign Work"}),(0,i.jsx)("p",{children:"Loading..."})]}):(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Assign Work"}),(0,i.jsx)("p",{children:"Assign tasks to staff members."}),x&&(0,i.jsx)("div",{className:"alert ".concat(x.includes("success")?"alert-success":"alert-error"),children:x}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),c(!0),h("");try{const e=await p.AP.assignTask(d);e.success?(h("Task assigned successfully!"),r({task_id:"",staff_id:"",notes:""}),g()):h(e.error||"Failed to assign task")}catch(t){h("An error occurred while assigning the task")}finally{c(!1)}},className:"assign-form",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"task_id",children:"Select Task *"}),(0,i.jsxs)("select",{id:"task_id",name:"task_id",value:d.task_id,onChange:j,required:!0,children:[(0,i.jsx)("option",{value:"",children:"Choose a task..."}),e.map(e=>(0,i.jsxs)("option",{value:e.task_id,children:[e.title," (ID: ",e.task_id,")"]},e.task_id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"staff_id",children:"Assign To Staff *"}),(0,i.jsxs)("select",{id:"staff_id",name:"staff_id",value:d.staff_id,onChange:j,required:!0,children:[(0,i.jsx)("option",{value:"",children:"Choose staff member..."}),s.map(e=>(0,i.jsxs)("option",{value:e._id,children:[e.name," - ",e.designation]},e._id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"notes",children:"Notes (Optional)"}),(0,i.jsx)("textarea",{id:"notes",name:"notes",value:d.notes,onChange:j,placeholder:"Add any special instructions...",rows:"3"})]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:o||0===e.length||0===s.length,children:o?"Assigning...":"Assign Task"})]}),0===e.length&&(0,i.jsx)("div",{className:"info-message",children:"No unassigned tasks available. Create new tasks first."})]})},u=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)({task_id:"",content:"",attachments:[]}),[d,r]=(0,n.useState)(!1),[o,c]=(0,n.useState)(""),[x,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{u()},[]);const u=async()=>{try{const e=await p.AP.getTaskStatus();e.success&&t(e.data)}catch(e){c("Failed to load assigned tasks")}finally{h(!1)}},m=e=>{a((0,l.A)((0,l.A)({},s),{},{[e.target.name]:e.target.value}))};return x?(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Add Work Report"}),(0,i.jsx)("p",{children:"Loading..."})]}):(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Add Work Report"}),(0,i.jsx)("p",{children:"Submit progress reports for your assigned tasks."}),o&&(0,i.jsx)("div",{className:"alert ".concat(o.includes("success")?"alert-success":"alert-error"),children:o}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),r(!0),c("");try{const e={task_id:parseInt(s.task_id),content:s.content,attachments:[]},t=await p.AP.submitReport(e);t.success?(c("Report submitted successfully!"),a({task_id:"",content:"",attachments:[]})):c(t.error||"Failed to submit report")}catch(t){c("An error occurred while submitting the report")}finally{r(!1)}},className:"report-form",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"task_id",children:"Select Task *"}),(0,i.jsxs)("select",{id:"task_id",name:"task_id",value:s.task_id,onChange:m,required:!0,children:[(0,i.jsx)("option",{value:"",children:"Choose a task..."}),e.map(e=>(0,i.jsxs)("option",{value:e.task_id,children:[e.task_id.title," (ID: ",e.task_id.task_id,")"]},e.task_id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"content",children:"Report Content *"}),(0,i.jsx)("textarea",{id:"content",name:"content",value:s.content,onChange:m,required:!0,placeholder:"Describe your progress, challenges faced, and next steps...",rows:"6"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"attachments",children:"Attachments (Optional)"}),(0,i.jsx)("input",{type:"file",id:"attachments",name:"attachments",onChange:e=>{const t=Array.from(e.target.files);a((0,l.A)((0,l.A)({},s),{},{attachments:t}))},multiple:!0,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"}),(0,i.jsx)("small",{className:"help-text",children:"Supported formats: PDF, DOC, DOCX, JPG, PNG"})]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:d||0===e.length,children:d?"Submitting...":"Submit Report"})]}),0===e.length&&(0,i.jsx)("div",{className:"info-message",children:"No assigned tasks available. Please contact your administrator."})]})},m=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)([]),[l,o]=(0,n.useState)(!1),[c,x]=(0,n.useState)(!0),h=(0,n.useCallback)(async()=>{o(!0);try{const e=await p.AP.getTaskStatus(s);e.success&&r(e.data)}catch(e){console.error("Failed to fetch task status:",e)}finally{o(!1)}},[s]);(0,n.useEffect)(()=>{u()},[]),(0,n.useEffect)(()=>{s&&h()},[s,h]);const u=async()=>{try{const e=await p.$I.getStaff();e.success&&t(e.data)}catch(e){console.error("Failed to fetch staff:",e)}finally{x(!1)}},m=e=>{switch(e){case"Completed":return"#28a745";case"In Progress":return"#ffc107";case"Open":default:return"#6c757d";case"Assigned":return"#007bff";case"Closed":return"#dc3545"}},g=e=>new Date(e).toLocaleDateString();return c?(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Staff Work Details"}),(0,i.jsx)("p",{children:"Loading..."})]}):(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Staff Work Details"}),(0,i.jsx)("p",{children:"View detailed work information and status for staff members."}),(0,i.jsx)("div",{className:"filters",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"staff-select",children:"Select Staff Member:"}),(0,i.jsxs)("select",{id:"staff-select",value:s,onChange:e=>a(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"All Staff"}),e.map(e=>(0,i.jsxs)("option",{value:e._id,children:[e.name," - ",e.designation]},e._id))]})]})}),l?(0,i.jsx)("p",{children:"Loading task details..."}):(0,i.jsx)("div",{className:"work-details-table",children:0===d.length?(0,i.jsx)("div",{className:"no-data",children:s?"No tasks assigned to this staff member.":"Select a staff member to view their tasks."}):(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Task ID"}),(0,i.jsx)("th",{children:"Task Title"}),(0,i.jsx)("th",{children:"Description"}),(0,i.jsx)("th",{children:"Priority"}),(0,i.jsx)("th",{children:"Deadline"}),(0,i.jsx)("th",{children:"Status"}),(0,i.jsx)("th",{children:"Progress"}),(0,i.jsx)("th",{children:"Assigned Date"})]})}),(0,i.jsx)("tbody",{children:d.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.task_id.task_id}),(0,i.jsx)("td",{children:e.task_id.title}),(0,i.jsx)("td",{className:"description-cell",children:e.task_id.description.length>50?"".concat(e.task_id.description.substring(0,50),"..."):e.task_id.description}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"priority-badge priority-".concat(e.task_id.priority.toLowerCase()),children:e.task_id.priority})}),(0,i.jsx)("td",{children:g(e.task_id.deadline)}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"status-badge",style:{backgroundColor:m(e.task_id.status)},children:e.task_id.status})}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"progress-bar",children:[(0,i.jsx)("div",{className:"progress-fill",style:{width:"".concat(e.completion_percentage,"%")}}),(0,i.jsxs)("span",{className:"progress-text",children:[e.completion_percentage,"%"]})]})}),(0,i.jsx)("td",{children:g(e.createdAt)})]},e._id))})]})}),(0,i.jsx)("style",{jsx:!0,children:"\n        .filters {\n          margin-bottom: 20px;\n          padding: 15px;\n          background-color: #f8f9fa;\n          border-radius: 4px;\n        }\n\n        .form-group {\n          margin-bottom: 0;\n        }\n\n        .form-group label {\n          display: block;\n          margin-bottom: 5px;\n          font-weight: bold;\n        }\n\n        .form-group select {\n          width: 300px;\n          padding: 8px;\n          border: 1px solid #ddd;\n          border-radius: 4px;\n          font-size: 14px;\n        }\n\n        .work-details-table {\n          overflow-x: auto;\n        }\n\n        table {\n          width: 100%;\n          border-collapse: collapse;\n          margin-top: 20px;\n          background-color: white;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n\n        th, td {\n          padding: 12px;\n          text-align: left;\n          border-bottom: 1px solid #ddd;\n        }\n\n        th {\n          background-color: #f8f9fa;\n          font-weight: bold;\n        }\n\n        .description-cell {\n          max-width: 200px;\n          word-wrap: break-word;\n        }\n\n        .priority-badge {\n          padding: 4px 8px;\n          border-radius: 12px;\n          color: white;\n          font-size: 12px;\n          font-weight: bold;\n        }\n\n        .priority-high {\n          background-color: #dc3545;\n        }\n\n        .priority-medium {\n          background-color: #ffc107;\n          color: #212529;\n        }\n\n        .priority-low {\n          background-color: #28a745;\n        }\n\n        .status-badge {\n          padding: 4px 8px;\n          border-radius: 12px;\n          color: white;\n          font-size: 12px;\n          font-weight: bold;\n        }\n\n        .progress-bar {\n          width: 100px;\n          height: 20px;\n          background-color: #e9ecef;\n          border-radius: 10px;\n          position: relative;\n          overflow: hidden;\n        }\n\n        .progress-fill {\n          height: 100%;\n          background-color: #007bff;\n          transition: width 0.3s ease;\n        }\n\n        .progress-text {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          font-size: 12px;\n          font-weight: bold;\n          color: #fff;\n        }\n\n        .no-data {\n          text-align: center;\n          padding: 40px;\n          color: #6c757d;\n          font-style: italic;\n        }\n      "})]})},g=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)([]),[l,o]=(0,n.useState)([]),[c,x]=(0,n.useState)(!1),[h,u]=(0,n.useState)(!0),[m,g]=(0,n.useState)("updates"),j=(0,n.useCallback)(async()=>{x(!0);try{if("updates"===m){const e=await p.AP.getTaskUpdates(s);e.success&&r(e.data)}else{const e=await p.AP.getPendingReports();if(e.success){const t=e.data.filter(e=>e.task_id.task_id===parseInt(s));o(t)}}}catch(e){console.error("Failed to fetch data:",e)}finally{x(!1)}},[s,m]);(0,n.useEffect)(()=>{y()},[]),(0,n.useEffect)(()=>{s&&j()},[s,m,j]);const y=async()=>{try{const e=await p.AP.getAllTasks();e.success&&t(e.data)}catch(e){console.error("Failed to fetch tasks:",e)}finally{u(!1)}},b=async(e,t,s)=>{try{(await p.AP.reviewReport({report_id:e,status:t,comments:s})).success?(j(),alert("Report ".concat(t," successfully!"))):alert("Failed to review report")}catch(n){alert("Error reviewing report")}},f=e=>new Date(e).toLocaleString();return h?(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Staff Work Updates"}),(0,i.jsx)("p",{children:"Loading..."})]}):(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Staff Work Updates"}),(0,i.jsx)("p",{children:"Track progress, review reports, and manage task updates."}),(0,i.jsxs)("div",{className:"filters",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"task-select",children:"Select Task:"}),(0,i.jsxs)("select",{id:"task-select",value:s,onChange:e=>a(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"Choose a task..."}),e.map(e=>(0,i.jsxs)("option",{value:e.task_id,children:[e.title," (ID: ",e.task_id,")"]},e.task_id))]})]}),s&&(0,i.jsxs)("div",{className:"tab-buttons",children:[(0,i.jsx)("button",{className:"tab-btn ".concat("updates"===m?"active":""),onClick:()=>g("updates"),children:"Task Updates"}),(0,i.jsx)("button",{className:"tab-btn ".concat("reports"===m?"active":""),onClick:()=>g("reports"),children:"Work Reports"})]})]}),s?c?(0,i.jsx)("p",{children:"Loading..."}):(0,i.jsxs)("div",{className:"updates-container",children:["updates"===m?(0,i.jsxs)("div",{className:"updates-section",children:[(0,i.jsx)("h3",{children:"Task Updates Timeline"}),0===d.length?(0,i.jsx)("p",{children:"No updates available for this task."}):(0,i.jsx)("div",{className:"updates-list",children:d.map(e=>(0,i.jsxs)("div",{className:"update-item",children:[(0,i.jsxs)("div",{className:"update-header",children:[(0,i.jsx)("strong",{children:e.staff_id.name}),(0,i.jsx)("span",{className:"update-time",children:f(e.timestamp)})]}),(0,i.jsx)("div",{className:"update-content",children:e.content}),e.admin_comments.length>0&&(0,i.jsxs)("div",{className:"admin-comments",children:[(0,i.jsx)("h4",{children:"Admin Comments:"}),e.admin_comments.map((e,t)=>(0,i.jsxs)("div",{className:"comment",children:[(0,i.jsxs)("strong",{children:[e.commented_by.name,":"]})," ",e.comment,(0,i.jsxs)("span",{className:"comment-time",children:["(",f(e.commented_at),")"]})]},t))]}),(0,i.jsx)("div",{className:"comment-form",children:(0,i.jsx)("input",{type:"text",placeholder:"Add admin comment...",onKeyPress:t=>{"Enter"===t.key&&((async(e,t)=>{if(t.trim())try{(await p.AP.addComment({update_id:e,comment:t})).success?j():alert("Failed to add comment")}catch(s){alert("Error adding comment")}})(e.update_id,t.target.value),t.target.value="")}})})]},e.update_id))})]}):(0,i.jsxs)("div",{className:"reports-section",children:[(0,i.jsx)("h3",{children:"Work Reports"}),0===l.length?(0,i.jsx)("p",{children:"No pending reports for this task."}):(0,i.jsx)("div",{className:"reports-list",children:l.map(e=>(0,i.jsxs)("div",{className:"report-item",children:[(0,i.jsxs)("div",{className:"report-header",children:[(0,i.jsx)("strong",{children:e.staff_id.name}),(0,i.jsx)("span",{className:"report-time",children:f(e.createdAt)}),(0,i.jsx)("span",{className:"status-badge status-".concat(e.status),children:e.status})]}),(0,i.jsx)("div",{className:"report-content",children:e.content}),"pending"===e.status&&(0,i.jsxs)("div",{className:"report-actions",children:[(0,i.jsx)("button",{className:"btn-approve",onClick:()=>b(e.report_id,"reviewed",""),children:"Approve"}),(0,i.jsx)("button",{className:"btn-reject",onClick:()=>{const t=prompt("Enter rejection comments:");null!==t&&b(e.report_id,"rejected",t)},children:"Reject"})]}),"rejected"===e.status&&e.admin_comments&&(0,i.jsxs)("div",{className:"rejection-comments",children:[(0,i.jsx)("strong",{children:"Rejection Reason:"})," ",e.admin_comments]})]},e.report_id))})]}),(0,i.jsx)("div",{className:"task-actions",children:(0,i.jsx)("button",{className:"btn-close-task",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to close this task?"))try{(await p.AP.closeTask(e)).success?(alert("Task closed successfully!"),y(),j()):alert("Failed to close task")}catch(t){alert("Error closing task")}})(s),children:"Close Task"})})]}):(0,i.jsx)("div",{className:"no-selection",children:"Please select a task to view updates and reports."}),(0,i.jsx)("style",{jsx:!0,children:"\n        .filters {\n          margin-bottom: 20px;\n          padding: 15px;\n          background-color: #f8f9fa;\n          border-radius: 4px;\n        }\n\n        .form-group {\n          margin-bottom: 15px;\n        }\n\n        .form-group label {\n          display: block;\n          margin-bottom: 5px;\n          font-weight: bold;\n        }\n\n        .form-group select {\n          width: 300px;\n          padding: 8px;\n          border: 1px solid #ddd;\n          border-radius: 4px;\n          font-size: 14px;\n        }\n\n        .tab-buttons {\n          display: flex;\n          gap: 10px;\n        }\n\n        .tab-btn {\n          padding: 8px 16px;\n          border: 1px solid #ddd;\n          background: white;\n          cursor: pointer;\n          border-radius: 4px;\n        }\n\n        .tab-btn.active {\n          background-color: #007bff;\n          color: white;\n          border-color: #007bff;\n        }\n\n        .no-selection {\n          text-align: center;\n          padding: 40px;\n          color: #6c757d;\n          font-style: italic;\n        }\n\n        .updates-container {\n          margin-top: 20px;\n        }\n\n        .updates-list, .reports-list {\n          margin-top: 15px;\n        }\n\n        .update-item, .report-item {\n          border: 1px solid #ddd;\n          border-radius: 8px;\n          padding: 15px;\n          margin-bottom: 15px;\n          background-color: white;\n        }\n\n        .update-header, .report-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 10px;\n        }\n\n        .update-time, .report-time {\n          color: #6c757d;\n          font-size: 12px;\n        }\n\n        .update-content, .report-content {\n          margin-bottom: 10px;\n          line-height: 1.5;\n        }\n\n        .admin-comments {\n          background-color: #f8f9fa;\n          padding: 10px;\n          border-radius: 4px;\n          margin-top: 10px;\n        }\n\n        .comment {\n          margin-bottom: 5px;\n          font-size: 14px;\n        }\n\n        .comment-time {\n          color: #6c757d;\n          font-size: 12px;\n        }\n\n        .comment-form input {\n          width: 100%;\n          padding: 8px;\n          border: 1px solid #ddd;\n          border-radius: 4px;\n          margin-top: 10px;\n        }\n\n        .status-badge {\n          padding: 4px 8px;\n          border-radius: 12px;\n          color: white;\n          font-size: 12px;\n          font-weight: bold;\n        }\n\n        .status-pending {\n          background-color: #ffc107;\n          color: #212529;\n        }\n\n        .status-reviewed {\n          background-color: #28a745;\n        }\n\n        .status-rejected {\n          background-color: #dc3545;\n        }\n\n        .report-actions {\n          display: flex;\n          gap: 10px;\n          margin-top: 10px;\n        }\n\n        .btn-approve {\n          background-color: #28a745;\n          color: white;\n          border: none;\n          padding: 8px 16px;\n          border-radius: 4px;\n          cursor: pointer;\n        }\n\n        .btn-reject {\n          background-color: #dc3545;\n          color: white;\n          border: none;\n          padding: 8px 16px;\n          border-radius: 4px;\n          cursor: pointer;\n        }\n\n        .rejection-comments {\n          background-color: #f8d7da;\n          color: #721c24;\n          padding: 10px;\n          border-radius: 4px;\n          margin-top: 10px;\n        }\n\n        .task-actions {\n          margin-top: 30px;\n          text-align: center;\n        }\n\n        .btn-close-task {\n          background-color: #dc3545;\n          color: white;\n          border: none;\n          padding: 10px 20px;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 16px;\n        }\n\n        .btn-close-task:hover {\n          background-color: #c82333;\n        }\n      "})]})};var j=s(1036);const y=()=>{const[e,t]=(0,n.useState)({name:"",contact:"",stream:"",source:"",remarks:""}),[s,a]=(0,n.useState)({}),[d,r]=(0,n.useState)(!1),o=(e,t)=>{let s="";switch(e){case"name":t.trim()||(s="Name is required");break;case"contact":t.trim()?/^\d{10}$/.test(t)||(s="Contact must be 10 digits"):s="Contact is required";break;case"stream":t.trim()||(s="Stream is required");break;case"source":t.trim()||(s="Source is required")}return s},c=e=>{const{name:t,value:s}=e.target,n=o(t,s);a(e=>(0,l.A)((0,l.A)({},e),{},{[t]:n}))},x=e=>{const{name:n,value:d}=e.target;t(e=>(0,l.A)((0,l.A)({},e),{},{[n]:d})),s[n]&&a(e=>(0,l.A)((0,l.A)({},e),{},{[n]:""}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Add Enquiry"}),(0,i.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),(()=>{const t={};return Object.keys(e).forEach(s=>{const n=o(s,e[s]);n&&(t[s]=n)}),a(t),0===Object.keys(t).length})()){r(!0);try{const s=await p.wo.addEnquiry(e);s.success?(j.oR.success("Enquiry added successfully"),t({name:"",contact:"",stream:"",source:"",remarks:""}),a({}),window.confirm("Would you like to add a follow-up now?")):j.oR.error(s.error||"Failed to add enquiry")}catch(n){j.oR.error("Something went wrong. Please try again.")}finally{r(!1)}}},children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Name *"}),(0,i.jsx)("input",{type:"text",name:"name",value:e.name,onChange:x,onBlur:c,className:s.name?"error":"",placeholder:"Enter full name"}),s.name&&(0,i.jsx)("span",{className:"error-text",children:s.name})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Contact *"}),(0,i.jsx)("input",{type:"text",name:"contact",value:e.contact,onChange:x,onBlur:c,className:s.contact?"error":"",placeholder:"10-digit mobile number",maxLength:"10"}),s.contact&&(0,i.jsx)("span",{className:"error-text",children:s.contact})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Stream *"}),(0,i.jsxs)("select",{name:"stream",value:e.stream,onChange:x,onBlur:c,className:s.stream?"error":"",children:[(0,i.jsx)("option",{value:"",children:"Select Stream"}),(0,i.jsx)("option",{value:"Science",children:"Science"}),(0,i.jsx)("option",{value:"Commerce",children:"Commerce"}),(0,i.jsx)("option",{value:"Arts",children:"Arts"}),(0,i.jsx)("option",{value:"Engineering",children:"Engineering"}),(0,i.jsx)("option",{value:"Medical",children:"Medical"})]}),s.stream&&(0,i.jsx)("span",{className:"error-text",children:s.stream})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Source *"}),(0,i.jsxs)("select",{name:"source",value:e.source,onChange:x,onBlur:c,className:s.source?"error":"",children:[(0,i.jsx)("option",{value:"",children:"Select Source"}),(0,i.jsx)("option",{value:"Walk-in",children:"Walk-in"}),(0,i.jsx)("option",{value:"Call",children:"Call"}),(0,i.jsx)("option",{value:"Web",children:"Web"}),(0,i.jsx)("option",{value:"Referral",children:"Referral"}),(0,i.jsx)("option",{value:"Advertisement",children:"Advertisement"})]}),s.source&&(0,i.jsx)("span",{className:"error-text",children:s.source})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Remarks"}),(0,i.jsx)("textarea",{name:"remarks",value:e.remarks,onChange:x,placeholder:"Additional remarks",rows:"3"})]}),(0,i.jsx)("button",{type:"submit",disabled:d,children:d?"Saving...":"Save Enquiry"})]})]})},b=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)(!0),[o,c]=(0,n.useState)(""),[x,h]=(0,n.useState)({name:"",contact:"",dateRange:{start:"",end:""}}),[u,m]=(0,n.useState)(null),[g,y]=(0,n.useState)(!1),[b,f]=(0,n.useState)([]),[v,S]=(0,n.useState)(null),C=localStorage.getItem("role");(0,n.useEffect)(()=>{w()},[]);const w=async()=>{try{const e=await p.wo.getEnquiries();e.success?(t(e.data),a(e.data)):j.oR.error("Failed to fetch enquiries")}catch(e){j.oR.error("Something went wrong")}finally{r(!1)}},A=(0,n.useCallback)(t=>{let s=e;t&&(s=e.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())||e.contact.includes(t))),x.dateRange.start&&x.dateRange.end&&(s=s.filter(e=>{const t=new Date(e.createdAt),s=new Date(x.dateRange.start),n=new Date(x.dateRange.end);return t>=s&&t<=n})),a(s)},[e,x]),k=(0,n.useCallback)(e=>{v&&clearTimeout(v);const t=setTimeout(()=>{A(e)},500);S(t)},[v,A]),N=()=>{y(!1),m(null),f([])};return d?(0,i.jsx)("div",{className:"menu-content",children:"Loading..."}):(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Enquiry Detail"}),(0,i.jsxs)("div",{className:"search-filters",children:[(0,i.jsx)("div",{className:"search-bar",children:(0,i.jsx)("input",{type:"text",placeholder:"Search by name or contact...",value:o,onChange:e=>{const t=e.target.value;c(t),k(t)}})}),(0,i.jsxs)("div",{className:"date-filters",children:[(0,i.jsx)("input",{type:"date",name:"start",value:x.dateRange.start,onChange:e=>h(t=>(0,l.A)((0,l.A)({},t),{},{dateRange:(0,l.A)((0,l.A)({},t.dateRange),{},{start:e.target.value})})),placeholder:"Start Date"}),(0,i.jsx)("input",{type:"date",name:"end",value:x.dateRange.end,onChange:e=>h(t=>(0,l.A)((0,l.A)({},t),{},{dateRange:(0,l.A)((0,l.A)({},t.dateRange),{},{end:e.target.value})})),placeholder:"End Date"})]}),"admin"===C&&(0,i.jsx)("button",{onClick:async()=>{try{const e={};o&&(e.search=o),x.dateRange.start&&(e.startDate=x.dateRange.start),x.dateRange.end&&(e.endDate=x.dateRange.end);const t=await p.wo.exportEnquiries(e);if(t.success){const e=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=e,s.setAttribute("download","enquiry_details.xlsx"),document.body.appendChild(s),s.click(),s.remove(),j.oR.success("Export completed")}else j.oR.error("Failed to export enquiries")}catch(e){j.oR.error("Something went wrong during export")}},className:"export-btn",children:"Export to Excel"})]}),(0,i.jsx)("div",{className:"table-container",children:(0,i.jsxs)("table",{className:"enquiry-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Name"}),(0,i.jsx)("th",{children:"Contact"}),(0,i.jsx)("th",{children:"Stream"}),(0,i.jsx)("th",{children:"Date"}),(0,i.jsx)("th",{children:"Status"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsx)("tbody",{children:0===s.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"6",children:"No records found for selected filters."})}):s.map(e=>{var t;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{children:e.contact}),(0,i.jsx)("td",{children:e.stream}),(0,i.jsx)("td",{children:new Date(e.createdAt).toLocaleDateString()}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"status-badge ".concat(null===(t=e.status)||void 0===t?void 0:t.toLowerCase()),children:e.status||"Pending"})}),(0,i.jsxs)("td",{children:[(0,i.jsx)("button",{onClick:()=>(async e=>{m(e),y(!0);try{const t=await p.wo.getFollowUps(e.id);t.success&&f(t.data)}catch(t){console.error("Failed to fetch follow-ups")}})(e),children:"View"}),"admin"===C&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>(e=>{console.log("Edit enquiry:",e)})(e),children:"Edit"}),(0,i.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this enquiry?"))try{(await p.wo.deleteEnquiry(e)).success?(j.oR.success("Enquiry deleted successfully"),w()):j.oR.error("Failed to delete enquiry")}catch(t){j.oR.error("Something went wrong")}})(e.id),children:"Delete"})]})]})]},e.id)})})]})}),g&&u&&(0,i.jsx)("div",{className:"modal-overlay",onClick:N,children:(0,i.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("h2",{children:"Enquiry Details"}),(0,i.jsxs)("div",{className:"enquiry-info",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Name:"})," ",u.name]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Contact:"})," ",u.contact]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Stream:"})," ",u.stream]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Source:"})," ",u.source]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Remarks:"})," ",u.remarks]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Status:"})," ",u.status]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Date:"})," ",new Date(u.createdAt).toLocaleString()]})]}),(0,i.jsx)("h3",{children:"Follow-up History"}),(0,i.jsx)("div",{className:"follow-up-timeline",children:0===b.length?(0,i.jsx)("p",{children:"No follow-ups yet."}):b.map(e=>(0,i.jsxs)("div",{className:"timeline-item",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Date:"})," ",new Date(e.createdAt).toLocaleString()]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Status:"})," ",e.status]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Notes:"})," ",e.notes]}),e.reminderDate&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Reminder:"})," ",new Date(e.reminderDate).toLocaleDateString()]})]},e.id))}),(0,i.jsx)("button",{onClick:N,children:"Close"})]})})]})},f=()=>{const e={1:[{id:1,status:"Pending",notes:"Initial contact made",createdAt:"2023-10-01T10:00:00Z"},{id:2,status:"Contacted",notes:"Followed up on interest",createdAt:"2023-10-05T14:30:00Z"}],2:[{id:3,status:"Pending",notes:"Waiting for response",createdAt:"2023-09-28T09:15:00Z"}],3:[],4:[{id:4,status:"Converted",notes:"Enrolled successfully",createdAt:"2023-10-10T16:45:00Z"}]},[t]=(0,n.useState)([{id:1,name:"John Doe",contact:"1234567890",stream:"Science"},{id:2,name:"Jane Smith",contact:"0987654321",stream:"Commerce"},{id:3,name:"Alice Johnson",contact:"1122334455",stream:"Arts"},{id:4,name:"Bob Brown",contact:"5566778899",stream:"Engineering"}]),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)({status:"",notes:"",reminderDate:null}),[o,c]=(0,n.useState)([]),[x,h]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1);(0,n.useEffect)(()=>{},[]);const g=t=>{a(t),c(t&&e[t]||[])},y=e=>{const{name:t,value:s}=e.target;r(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Enquiry Follow-up"}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),s?d.status?d.notes.trim()?!(d.reminderDate&&d.reminderDate<new Date)||(j.oR.error("Reminder date must be in the future"),0):(j.oR.error("Please enter follow-up notes"),0):(j.oR.error("Please select a status"),0):(j.oR.error("Please select an enquiry"),0)){h(!0);try{const e={enquiryId:s,status:d.status,notes:d.notes,reminderDate:d.reminderDate,notificationEnabled:u},t=await p.wo.addFollowUp(e);t.success?(j.oR.success("Follow-up added successfully"),g(s),r({status:"",notes:"",reminderDate:null}),m(!1)):j.oR.error(t.error||"Failed to add follow-up")}catch(t){j.oR.error("Something went wrong. Please try again.")}finally{h(!1)}}},children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Select Enquiry *"}),(0,i.jsxs)("select",{value:s,onChange:e=>g(e.target.value),required:!0,children:[(0,i.jsx)("option",{value:"",children:"Choose an enquiry"}),t.map(e=>(0,i.jsxs)("option",{value:e.id,children:[e.name," - ",e.contact," (",e.stream,")"]},e.id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Status *"}),(0,i.jsxs)("select",{name:"status",value:d.status,onChange:y,required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select Status"}),(0,i.jsx)("option",{value:"Pending",children:"Pending"}),(0,i.jsx)("option",{value:"Contacted",children:"Contacted"}),(0,i.jsx)("option",{value:"Converted",children:"Converted"}),(0,i.jsx)("option",{value:"Dropped",children:"Dropped"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Follow-up Notes *"}),(0,i.jsx)("textarea",{name:"notes",value:d.notes,onChange:y,placeholder:"Enter follow-up details...",rows:"4",required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Reminder Date"}),(0,i.jsx)("input",{type:"date",value:d.reminderDate?d.reminderDate.toISOString().split("T")[0]:"",onChange:e=>{return t=new Date(e.target.value),void r(e=>(0,l.A)((0,l.A)({},e),{},{reminderDate:t}));var t},min:(new Date).toISOString().split("T")[0]})]}),(0,i.jsx)("div",{className:"form-group",children:(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:u,onChange:e=>m(e.target.checked)}),"Enable Notification"]})}),(0,i.jsx)("button",{type:"submit",disabled:x,children:x?"Saving...":"Save Follow-up"})]}),s&&(0,i.jsxs)("div",{className:"timeline-view",children:[(0,i.jsx)("h2",{children:"Follow-up Timeline"}),0===o.length?(0,i.jsx)("p",{children:"No follow-ups yet for this enquiry."}):(0,i.jsx)("div",{className:"timeline",children:o.map((e,t)=>(0,i.jsxs)("div",{className:"timeline-item",children:[(0,i.jsx)("div",{className:"timeline-marker"}),(0,i.jsxs)("div",{className:"timeline-content",children:[(0,i.jsx)("h4",{children:e.status}),(0,i.jsx)("p",{children:e.notes}),(0,i.jsx)("small",{children:new Date(e.createdAt).toLocaleString()}),e.reminderDate&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Reminder:"})," ",new Date(e.reminderDate).toLocaleDateString()]})]})]},e.id))})]})]})},v=()=>{const[e,t]=(0,n.useState)({name:"",contact:"",purpose:"",linkedEnquiryId:""}),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)({}),[o,c]=(0,n.useState)(!1),[x,h]=(0,n.useState)("");(0,n.useEffect)(()=>{u()},[]);const u=async()=>{try{const e=await p.wo.getEnquiries();e.success&&a(e.data)}catch(e){console.error("Failed to fetch enquiries")}},m=(e,t)=>{let s="";switch(e){case"name":t.trim()||(s="Name is required");break;case"contact":t.trim()?/^\d{10}$/.test(t)||(s="Contact must be 10 digits"):s="Contact is required";break;case"purpose":t.trim()||(s="Purpose is required")}return s},g=e=>{const{name:t,value:s}=e.target,n=m(t,s);r(e=>(0,l.A)((0,l.A)({},e),{},{[t]:n})),"contact"===t&&s&&/^\d{10}$/.test(s)&&y(s)},y=async e=>{try{const t=await p.wo.getVisitedList({contact:e,recent:!0});if(t.success&&t.data.length>0){const e=t.data[0],s=new Date(e.inTime),n=(new Date-s)/36e5;h(n<24?"Warning: This contact visited ".concat(Math.round(n),' hours ago for "').concat(e.purpose,'".'):"")}else h("")}catch(t){console.error("Failed to check duplicate visitor")}},b=e=>{const{name:s,value:n}=e.target;t(e=>(0,l.A)((0,l.A)({},e),{},{[s]:n})),d[s]&&r(e=>(0,l.A)((0,l.A)({},e),{},{[s]:""})),"contact"===s&&h("")};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Add Visitor"}),x&&(0,i.jsx)("div",{className:"warning-message",children:x}),(0,i.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),(()=>{const t={};return Object.keys(e).forEach(s=>{if("linkedEnquiryId"!==s){const n=m(s,e[s]);n&&(t[s]=n)}}),r(t),0===Object.keys(t).length})()){c(!0);try{const s=(0,l.A)((0,l.A)({},e),{},{inTime:(new Date).toISOString()}),n=await p.wo.addVisitor(s);n.success?(j.oR.success("Visitor logged successfully"),t({name:"",contact:"",purpose:"",linkedEnquiryId:""}),r({}),h(""),window.confirm("Visitor logged successfully. Would you like to view the visited list?")):j.oR.error(n.error||"Failed to add visitor")}catch(n){j.oR.error("Something went wrong. Please try again.")}finally{c(!1)}}},children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Name *"}),(0,i.jsx)("input",{type:"text",name:"name",value:e.name,onChange:b,onBlur:g,className:d.name?"error":"",placeholder:"Enter visitor name"}),d.name&&(0,i.jsx)("span",{className:"error-text",children:d.name})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Contact *"}),(0,i.jsx)("input",{type:"text",name:"contact",value:e.contact,onChange:b,onBlur:g,className:d.contact?"error":"",placeholder:"10-digit mobile number",maxLength:"10"}),d.contact&&(0,i.jsx)("span",{className:"error-text",children:d.contact})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Purpose *"}),(0,i.jsx)("input",{type:"text",name:"purpose",value:e.purpose,onChange:b,onBlur:g,className:d.purpose?"error":"",placeholder:"Purpose of visit"}),d.purpose&&(0,i.jsx)("span",{className:"error-text",children:d.purpose})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Linked Enquiry (Optional)"}),(0,i.jsxs)("select",{name:"linkedEnquiryId",value:e.linkedEnquiryId,onChange:b,children:[(0,i.jsx)("option",{value:"",children:"Select enquiry if applicable"}),s.map(e=>(0,i.jsxs)("option",{value:e.id,children:[e.name," - ",e.contact," (",e.stream,")"]},e.id))]})]}),(0,i.jsx)("button",{type:"submit",disabled:o,children:o?"Logging...":"Log Visitor"})]})]})},S=()=>{const e=[{id:1,name:"John Doe",contact:"1234567890",purpose:"Enquiry about Science stream",inTime:"2023-10-01T10:00:00Z",outTime:"2023-10-01T12:30:00Z",linkedEnquiry:!0},{id:2,name:"Jane Smith",contact:"0987654321",purpose:"Meeting with counselor",inTime:"2023-10-02T09:15:00Z",outTime:"2023-10-02T11:45:00Z",linkedEnquiry:!1},{id:3,name:"Alice Johnson",contact:"1122334455",purpose:"Campus tour",inTime:"2023-10-03T14:00:00Z",outTime:null,linkedEnquiry:!0},{id:4,name:"Bob Brown",contact:"5566778899",purpose:"Fee payment",inTime:"2023-10-04T16:20:00Z",outTime:"2023-10-04T17:10:00Z",linkedEnquiry:!1},{id:5,name:"Charlie Wilson",contact:"6677889900",purpose:"Admission inquiry",inTime:"2023-10-05T11:00:00Z",outTime:"2023-10-05T13:30:00Z",linkedEnquiry:!0}],[t]=(0,n.useState)(e),[s,a]=(0,n.useState)(e),[d,r]=(0,n.useState)({date:"",name:"",contact:""}),o=localStorage.getItem("role");(0,n.useEffect)(()=>{},[]);const c=(0,n.useCallback)(()=>{let e=t;d.date&&(e=e.filter(e=>new Date(e.inTime).toDateString()===new Date(d.date).toDateString())),d.name&&(e=e.filter(e=>e.name.toLowerCase().includes(d.name.toLowerCase()))),d.contact&&(e=e.filter(e=>e.contact.includes(d.contact))),a(e)},[t,d]);(0,n.useEffect)(()=>{c()},[c]);const x=e=>{const{name:t,value:s}=e.target;r(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))},h=(e,t)=>{if(!t)return"Still visiting";const s=new Date(e),n=new Date(t)-s,a=Math.floor(n/36e5),d=Math.floor(n%36e5/6e4);return"".concat(a,"h ").concat(d,"m")},u=(e,t)=>{if(!t)return!1;const s=new Date(e);return(new Date(t)-s)/36e5>2};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Visited List"}),(0,i.jsxs)("div",{className:"filters-section",children:[(0,i.jsxs)("div",{className:"filter-group",children:[(0,i.jsx)("label",{children:"Date:"}),(0,i.jsx)("input",{type:"date",name:"date",value:d.date,onChange:x})]}),(0,i.jsxs)("div",{className:"filter-group",children:[(0,i.jsx)("label",{children:"Name:"}),(0,i.jsx)("input",{type:"text",name:"name",value:d.name,onChange:x,placeholder:"Search by name"})]}),(0,i.jsxs)("div",{className:"filter-group",children:[(0,i.jsx)("label",{children:"Contact:"}),(0,i.jsx)("input",{type:"text",name:"contact",value:d.contact,onChange:x,placeholder:"Search by contact"})]}),"admin"===o&&(0,i.jsx)("button",{onClick:async()=>{try{const e=await p.wo.exportVisitors(d);if(e.success){const t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=t,s.setAttribute("download","visited_list.xlsx"),document.body.appendChild(s),s.click(),s.remove(),j.oR.success("Export completed")}else j.oR.error("Failed to export visitors")}catch(e){j.oR.error("Something went wrong during export")}},className:"export-btn",children:"Export to Excel"})]}),(0,i.jsx)("div",{className:"table-container",children:(0,i.jsxs)("table",{className:"visitors-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Name"}),(0,i.jsx)("th",{children:"Contact"}),(0,i.jsx)("th",{children:"Purpose"}),(0,i.jsx)("th",{children:"In-Time"}),(0,i.jsx)("th",{children:"Out-Time"}),(0,i.jsx)("th",{children:"Duration"}),(0,i.jsx)("th",{children:"Linked Enquiry"})]})}),(0,i.jsx)("tbody",{children:0===s.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"7",children:"No visitors found for selected filters."})}):s.map(e=>(0,i.jsxs)("tr",{className:u(e.inTime,e.outTime)?"long-visit":"",children:[(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{children:e.contact}),(0,i.jsx)("td",{children:e.purpose}),(0,i.jsx)("td",{children:new Date(e.inTime).toLocaleString()}),(0,i.jsx)("td",{children:e.outTime?new Date(e.outTime).toLocaleString():"Still visiting"}),(0,i.jsx)("td",{children:h(e.inTime,e.outTime)}),(0,i.jsx)("td",{children:e.linkedEnquiry?"Yes":"No"})]},e.id))})]})}),(0,i.jsxs)("div",{className:"summary-section",children:[(0,i.jsxs)("p",{children:["Total Visitors: ",s.length]}),(0,i.jsxs)("p",{children:["Currently Visiting: ",s.filter(e=>!e.outTime).length]}),(0,i.jsxs)("p",{children:["Long Visits (",">","2 hours): ",s.filter(e=>u(e.inTime,e.outTime)).length]})]})]})};var C=s(6396);const w={2023001:{name:"Aman Verma",course:"B.Tech",branch:"CSE"},2023002:{name:"Priya Sharma",course:"B.Tech",branch:"ECE"},2023003:{name:"Rahul Kumar",course:"B.Tech",branch:"ME"},2023004:{name:"Sneha",course:"B.Tech",branch:"CE"}},A=()=>{const[e,t]=(0,n.useState)({studentId:"",name:"",course:"",branch:"",reason:""}),[s,a]=(0,n.useState)(!1),[d,r]=(0,n.useState)("");return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Transfer Certificate"}),(0,i.jsx)("p",{children:"Generate transfer certificates for students."}),(0,i.jsxs)("form",{onSubmit:async s=>{s.preventDefault(),e.studentId&&e.reason?(a(!0),setTimeout(()=>{a(!1),(()=>{const t=new C.Ay;t.setFont("helvetica","bold"),t.setFontSize(20),t.text("TRANSFER CERTIFICATE",105,30,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","normal"),t.text("College Name",20,50),t.text("Address Line 1",20,60),t.text("Address Line 2",20,70),t.text("City, State - PIN",20,80),t.setFontSize(14),t.text("This is to certify that",20,100),t.setFontSize(16),t.setFont("helvetica","bold"),t.text(e.name,20,115),t.setFontSize(14),t.setFont("helvetica","normal"),t.text("Student ID: ".concat(e.studentId),20,130),t.text("Course: ".concat(e.course),20,140),t.text("Branch: ".concat(e.branch),20,150),t.text("has been a student of this institution and is leaving for the following reason:",20,165),t.setFont("helvetica","bold"),t.text(e.reason,20,180),t.setFont("helvetica","normal"),t.text("Date: ".concat((new Date).toLocaleDateString()),20,200),t.text("Principal",150,220),t.text("College Seal",150,230),t.save("Transfer_Certificate_".concat(e.studentId,".pdf"))})(),r("Transfer Certificate issued successfully!"),t({studentId:"",name:"",course:"",branch:"",reason:""})},1e3)):r("Please fill in all required fields")},children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"tc-student-id",children:"Student ID:"}),(0,i.jsx)("input",{type:"text",id:"tc-student-id",name:"studentId",value:e.studentId,onChange:async e=>{const s=e.target.value;t(e=>(0,l.A)((0,l.A)({},e),{},{studentId:s})),s.trim()?(a(!0),setTimeout(()=>{const e=w[s];a(!1),e?(t(t=>(0,l.A)((0,l.A)({},t),{},{name:e.name,course:e.course,branch:e.branch})),r("")):(t(e=>(0,l.A)((0,l.A)({},e),{},{name:"",course:"",branch:""})),r("Student not found"))},500)):(t(e=>(0,l.A)((0,l.A)({},e),{},{name:"",course:"",branch:""})),r(""))},required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"tc-student-name",children:"Student Name:"}),(0,i.jsx)("input",{type:"text",id:"tc-student-name",name:"name",value:e.name,readOnly:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"tc-course",children:"Course:"}),(0,i.jsx)("input",{type:"text",id:"tc-course",name:"course",value:e.course,readOnly:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"tc-branch",children:"Branch:"}),(0,i.jsx)("input",{type:"text",id:"tc-branch",name:"branch",value:e.branch,readOnly:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"tc-reason",children:"Reason for Transfer:"}),(0,i.jsx)("input",{type:"text",id:"tc-reason",name:"reason",value:e.reason,onChange:e=>{const{name:s,value:n}=e.target;t(e=>(0,l.A)((0,l.A)({},e),{},{[s]:n}))},required:!0})]}),(0,i.jsx)("button",{type:"submit",disabled:s,children:s?"Generating...":"Generate TC"})]}),d&&(0,i.jsx)("p",{className:d.includes("success")?"success":"error",children:d})]})},k={2023001:{name:"Aman Verma",course:"B.Tech",branch:"CSE"},2023002:{name:"Priya Sharma",course:"B.Tech",branch:"ECE"},2023003:{name:"Rahul Kumar",course:"B.Tech",branch:"ME"},2023004:{name:"Sneha ",course:"B.Tech",branch:"CE"}},N=()=>{const[e,t]=(0,n.useState)({studentId:"",name:"",course:"",branch:""}),[s,a]=(0,n.useState)(!1),[d,r]=(0,n.useState)("");return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Character Certificate"}),(0,i.jsx)("p",{children:"Generate character certificates for students."}),(0,i.jsxs)("form",{onSubmit:async s=>{s.preventDefault(),e.studentId?(a(!0),setTimeout(()=>{a(!1),(()=>{const t=new C.Ay;t.setFont("helvetica","bold"),t.setFontSize(20),t.text("CHARACTER CERTIFICATE",105,30,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","normal"),t.text("College Name",20,50),t.text("Address Line 1",20,60),t.text("Address Line 2",20,70),t.text("City, State - PIN",20,80),t.setFontSize(14),t.text("This is to certify that",20,100),t.setFontSize(16),t.setFont("helvetica","bold"),t.text(e.name,20,115),t.setFontSize(14),t.setFont("helvetica","normal"),t.text("Student ID: ".concat(e.studentId),20,130),t.text("Course: ".concat(e.course),20,140),t.text("Branch: ".concat(e.branch),20,150),t.text("has been a student of this institution and bears a good moral character.",20,165),t.text("During the period of study, the student has shown good conduct and behavior.",20,175),t.setFont("helvetica","normal"),t.text("Date: ".concat((new Date).toLocaleDateString()),20,200),t.text("Principal",150,220),t.text("College Seal",150,230),t.save("Character_Certificate_".concat(e.studentId,".pdf"))})(),r("Character Certificate issued successfully!"),t({studentId:"",name:"",course:"",branch:""})},1e3)):r("Please enter Student ID")},children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"cc-student-id",children:"Student ID:"}),(0,i.jsx)("input",{type:"text",id:"cc-student-id",name:"studentId",value:e.studentId,onChange:async e=>{const s=e.target.value;t(e=>(0,l.A)((0,l.A)({},e),{},{studentId:s})),s.trim()?(a(!0),setTimeout(()=>{const e=k[s];a(!1),e?(t(t=>(0,l.A)((0,l.A)({},t),{},{name:e.name,course:e.course,branch:e.branch})),r("")):(t(e=>(0,l.A)((0,l.A)({},e),{},{name:"",course:"",branch:""})),r("Student not found"))},500)):(t(e=>(0,l.A)((0,l.A)({},e),{},{name:"",course:"",branch:""})),r(""))},required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"cc-student-name",children:"Student Name:"}),(0,i.jsx)("input",{type:"text",id:"cc-student-name",name:"name",value:e.name,readOnly:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"cc-course",children:"Course:"}),(0,i.jsx)("input",{type:"text",id:"cc-course",name:"course",value:e.course,readOnly:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"cc-branch",children:"Branch:"}),(0,i.jsx)("input",{type:"text",id:"cc-branch",name:"branch",value:e.branch,readOnly:!0})]}),(0,i.jsx)("button",{type:"submit",disabled:s,children:s?"Generating...":"Generate CC"})]}),d&&(0,i.jsx)("p",{className:d.includes("success")?"success":"error",children:d})]})},_={"Fees Report":"This report provides details on fee collections, including student IDs, amounts paid/unpaid, and transaction dates.","Staff Report":"View staff information such as IDs, names, departments, roles, and active status.","Certificate Report":"Track certificate issuance for students, including types, statuses, and dates.","Circular Report":"List circulars and notices, targeted roles, and their active status.","Work Management Report":"Monitor assigned tasks, staff involved, completion status, and dates.","Expense Report":"Summarize expenses by category, department, amounts, and dates.","Enquiry Report":"Review enquiries from various sources, details, statuses, and dates.","Collection Report":"View fee collection statistics by course, year, and semester.","Defaulter Report":"List students with outstanding fee payments.","Payment Statistics":"Comprehensive payment statistics and trends.","Concession Report":"Track concessions and scholarships granted to students.","Receipt Report":"View generated receipts and their status."},R=["Fees Report","Staff Report","Certificate Report","Circular Report","Work Management Report","Expense Report","Enquiry Report","Collection Report","Defaulter Report","Payment Statistics","Concession Report","Receipt Report"],D={"Fees Report":[{label:"Date Range (From)",type:"date",id:"startDate"},{label:"Date Range (To)",type:"date",id:"endDate"},{label:"Student ID",type:"text",id:"student-id"},{label:"Status",type:"select",options:["Paid","Unpaid"],id:"status"}],"Staff Report":[{label:"Date Range (From)",type:"date",id:"startDate"},{label:"Date Range (To)",type:"date",id:"endDate"},{label:"Staff ID",type:"text",id:"staff-id"},{label:"Department",type:"select",options:["IT","HR","Finance"],id:"department"},{label:"Status",type:"select",options:["Active","Inactive"],id:"status"},{label:"Role",type:"select",options:["Teacher","Admin"],id:"role"}],"Certificate Report":[{label:"Date Range (From)",type:"date",id:"startDate"},{label:"Date Range (To)",type:"date",id:"endDate"},{label:"Student ID",type:"text",id:"student-id"},{label:"Status",type:"select",options:["Issued","Pending"],id:"status"}],"Circular Report":[{label:"Date Range (From)",type:"date",id:"startDate"},{label:"Date Range (To)",type:"date",id:"endDate"},{label:"Role",type:"select",options:["All","Staff","Students"],id:"role"},{label:"Status",type:"select",options:["Active","Inactive"],id:"status"}],"Work Management Report":[{label:"Date Range (From)",type:"date",id:"startDate"},{label:"Date Range (To)",type:"date",id:"endDate"},{label:"Staff ID",type:"text",id:"staff-id"},{label:"Status",type:"select",options:["Completed","Pending"],id:"status"}],"Expense Report":[{label:"Date Range (From)",type:"date",id:"startDate"},{label:"Date Range (To)",type:"date",id:"endDate"},{label:"Category",type:"select",options:["Office","Travel","Maintenance"],id:"category"},{label:"Department",type:"select",options:["IT","HR","Finance"],id:"department"}],"Enquiry Report":[{label:"Date Range (From)",type:"date",id:"startDate"},{label:"Date Range (To)",type:"date",id:"endDate"},{label:"Source",type:"select",options:["Website","Phone","Walk-in"],id:"source"},{label:"Status",type:"select",options:["Open","Closed"],id:"status"}],"Collection Report":[{label:"Course",type:"select",options:["B.A","B.Sc","B.Ed"],id:"course"},{label:"Year",type:"number",id:"year"},{label:"Semester",type:"number",id:"semester"},{label:"Batch",type:"text",id:"batch"},{label:"Start Date",type:"date",id:"startDate"},{label:"End Date",type:"date",id:"endDate"}],"Defaulter Report":[{label:"Course",type:"select",options:["B.A","B.Sc","B.Ed"],id:"course"},{label:"Year",type:"number",id:"year"},{label:"Semester",type:"number",id:"semester"},{label:"Days Overdue",type:"number",id:"daysOverdue"}],"Payment Statistics":[{label:"Course",type:"select",options:["B.A","B.Sc","B.Ed"],id:"course"},{label:"Year",type:"number",id:"year"},{label:"Semester",type:"number",id:"semester"}],"Concession Report":[{label:"Course",type:"select",options:["B.A","B.Sc","B.Ed"],id:"course"},{label:"Academic Year",type:"number",id:"academicYear"},{label:"Semester",type:"number",id:"semester"},{label:"Type",type:"text",id:"type"}],"Receipt Report":[{label:"Course",type:"select",options:["B.A","B.Sc","B.Ed"],id:"course"},{label:"Year",type:"number",id:"year"},{label:"Semester",type:"number",id:"semester"},{label:"Start Date",type:"date",id:"startDate"},{label:"End Date",type:"date",id:"endDate"}]},T=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)({}),[d,r]=(0,n.useState)([]),[o,c]=(0,n.useState)(""),[p,x]=(0,n.useState)({key:null,direction:"asc"}),[h,u]=(0,n.useState)(1),[m,g]=(0,n.useState)(!1),[j,y]=(0,n.useState)(""),b=(e,t)=>{a((0,l.A)((0,l.A)({},s),{},{[e]:t}))},f=e=>{switch(e){case"Staff Report":return[{id:1,staffId:"ST001",name:"John Doe",department:"IT",status:"Active",role:"Teacher"},{id:2,staffId:"ST002",name:"Jane Smith",department:"HR",status:"Active",role:"Admin"}];case"Certificate Report":return[{id:1,studentId:"S001",type:"Transfer",status:"Issued",date:"2023-01-01"},{id:2,studentId:"S002",type:"Character",status:"Pending",date:"2023-01-02"}];case"Circular Report":return[{id:1,title:"Holiday Notice",role:"All",status:"Active",date:"2023-01-01"},{id:2,title:"Exam Schedule",role:"Students",status:"Active",date:"2023-01-02"}];case"Work Management Report":return[{id:1,staffId:"ST001",task:"Update Website",status:"Completed",date:"2023-01-01"},{id:2,staffId:"ST002",task:"Prepare Report",status:"Pending",date:"2023-01-02"}];case"Expense Report":return[{id:1,category:"Office",amount:2e3,department:"IT",date:"2023-01-01"},{id:2,category:"Travel",amount:1500,department:"HR",date:"2023-01-02"}];case"Enquiry Report":return[{id:1,source:"Website",details:"Admission Query",status:"Open",date:"2023-01-01"},{id:2,source:"Phone",details:"Fee Structure",status:"Closed",date:"2023-01-02"}];default:return[]}},v=[...d].sort((e,t)=>e[p.key]<t[p.key]?"asc"===p.direction?-1:1:e[p.key]>t[p.key]?"asc"===p.direction?1:-1:0).filter(e=>Object.values(e).some(e=>e.toString().toLowerCase().includes(o.toLowerCase()))),S=v.slice(10*(h-1),10*h);return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Report Generator"}),!e&&(0,i.jsx)("div",{className:"section",children:(0,i.jsx)("p",{children:"Welcome to the Reports Module. Here you can generate various reports for the school management system. Select a report type from the dropdown below to get started."})}),(0,i.jsxs)("div",{className:"section",children:[(0,i.jsx)("label",{children:"Report Type"}),(0,i.jsxs)("select",{value:e,onChange:e=>{t(e.target.value),a({}),r([])},children:[(0,i.jsx)("option",{value:"",children:"Select Report Type"}),R.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),e&&(0,i.jsx)("p",{className:"report-description",children:_[e]})]}),e&&(0,i.jsxs)("div",{className:"section",children:[(0,i.jsx)("h3",{children:"Filters"}),D[e].map(e=>(0,i.jsxs)("div",{className:"filter-item",children:[(0,i.jsx)("label",{children:e.label}),"text"===e.type&&(0,i.jsx)("input",{type:"text",id:"filter-".concat(e.id),value:s[e.id]||"",onChange:t=>b(e.id,t.target.value)}),"date"===e.type&&(0,i.jsx)("input",{type:"date",id:"filter-".concat(e.id),value:s[e.id]||"",onChange:t=>b(e.id,t.target.value)}),"select"===e.type&&(0,i.jsxs)("select",{id:"filter-".concat(e.id),value:s[e.id]||"",onChange:t=>b(e.id,t.target.value),children:[(0,i.jsx)("option",{value:"",children:"Select"}),e.options.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),"number"===e.type&&(0,i.jsx)("input",{type:"number",id:"filter-".concat(e.id),value:s[e.id]||"",onChange:t=>b(e.id,t.target.value)})]},e.id))]}),e&&(0,i.jsx)("div",{className:"section",children:(0,i.jsx)("button",{className:"btn",onClick:async()=>{g(!0),y("");try{const t=localStorage.getItem("token");let n="",a=new URLSearchParams;switch(Object.entries(s).forEach(e=>{let[t,s]=e;s&&a.append(t,s)}),e){case"Collection Report":n="http://localhost:5000/api/reports/collections?".concat(a);break;case"Defaulter Report":n="http://localhost:5000/api/reports/defaulters?".concat(a);break;case"Payment Statistics":n="http://localhost:5000/api/reports/payments/stats?".concat(a);break;case"Concession Report":n="http://localhost:5000/api/reports/concessions?".concat(a);break;case"Receipt Report":n="http://localhost:5000/api/reports/receipts?".concat(a);break;case"Fees Report":n="http://localhost:5000/api/payments/all?".concat(a);break;default:return r(f(e)),void g(!1)}const d=await fetch(n,{headers:{Authorization:"Bearer ".concat(t)}});if(d.ok){const e=await d.json();r(Array.isArray(e)?e:[e]),y("Report generated successfully")}else{const e=await d.json();y(e.message||"Failed to generate report"),r([])}}catch(t){y("Error generating report: "+t.message),r([])}finally{g(!1)}},disabled:m,children:m?"Generating Report...":"Generate Report"})}),m&&(0,i.jsx)("div",{className:"section",children:(0,i.jsx)("div",{className:"loading-message",children:"Generating report, please wait..."})}),j&&(0,i.jsx)("div",{className:"section message ".concat(j.includes("Error")||j.includes("Failed")?"error":"success"),children:j}),d.length>0&&(0,i.jsxs)("div",{className:"section",children:[(0,i.jsx)("h3",{children:"Report Results"}),(0,i.jsx)("input",{type:"text",placeholder:"Search...",value:o,onChange:e=>c(e.target.value)}),(0,i.jsxs)("table",{className:"report-table",children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:Object.keys(d[0]).map(e=>(0,i.jsxs)("th",{onClick:()=>(e=>{let t="asc";p.key===e&&"asc"===p.direction&&(t="desc"),x({key:e,direction:t})})(e),style:{cursor:"pointer"},children:[e.charAt(0).toUpperCase()+e.slice(1)," ",p.key===e?"asc"===p.direction?"\u2191":"\u2193":""]},e))})}),(0,i.jsx)("tbody",{children:S.map(e=>(0,i.jsx)("tr",{children:Object.values(e).map((e,t)=>(0,i.jsx)("td",{children:e},t))},e.id))})]}),(0,i.jsxs)("div",{className:"pagination",children:[(0,i.jsx)("button",{onClick:()=>u(h-1),disabled:1===h,children:"Previous"}),(0,i.jsxs)("span",{children:["Page ",h]}),(0,i.jsx)("button",{onClick:()=>u(h+1),disabled:10*h>=v.length,children:"Next"})]})]}),d.length>0&&(0,i.jsxs)("div",{className:"section",children:[(0,i.jsx)("h3",{children:"Export Report"}),(0,i.jsx)("button",{className:"btn",onClick:()=>{alert("Export to Excel functionality would be implemented here.")},children:"Export to Excel"}),(0,i.jsx)("button",{className:"btn",onClick:()=>{alert("Export to PDF functionality would be implemented here.")},children:"Export to PDF"})]})]})},E=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)({}),[d,r]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[p,x]=(0,n.useState)(null),h=(0,n.useMemo)(()=>({Dashboard:{category:"Communication",tooltip:"Main dashboard for overview"},Fees:{category:"Administrative",tooltip:"Manage fee collection and receipts"},Staff:{category:"Administrative",tooltip:"Staff registration and management"},Certificates:{category:"Academic",tooltip:"Issue TC/CC to students"},Circulars:{category:"Communication",tooltip:"Create and manage notices"},"Work Management":{category:"Administrative",tooltip:"Assign and track tasks"},Expenses:{category:"Administrative",tooltip:"Track and approve expenses"},Enquiries:{category:"Academic",tooltip:"Handle student enquiries"},Reports:{category:"System",tooltip:"Generate various reports"},Permissions:{category:"System",tooltip:"Manage role permissions"}}),[]),u=(0,n.useMemo)(()=>({Admin:Object.keys(h),Staff:["Dashboard","Certificates","Circulars","Work Management","Enquiries","Reports"],Student:["Dashboard","Fees","Certificates","Circulars","Enquiries"]}),[h]);(0,n.useEffect)(()=>{if(e){const t={};u[e].forEach(s=>{t[s]="Student"!==e}),a(t)}},[e,u]);const m=e=>{p("Exporting to ".concat(e,"..."))},g=Object.keys(s).filter(e=>e.toLowerCase().includes(d.toLowerCase())).reduce((e,t)=>{const s=h[t].category;return e[s]||(e[s]=[]),e[s].push(t),e},{}),j=e?"".concat(Object.keys(s).filter(e=>s[e]).length," modules assigned"):"";return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Assign Permissions"}),p&&(0,i.jsx)("div",{className:"alert alert-".concat(p.type),children:p.message}),(0,i.jsxs)("div",{className:"section",children:[(0,i.jsx)("label",{children:"Select Role"}),(0,i.jsxs)("select",{value:e,onChange:e=>{t(e.target.value),r("")},children:[(0,i.jsx)("option",{value:"",children:"Select Role"}),["Admin","Staff","Student"].map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),e&&(0,i.jsxs)("div",{className:"role-description",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Description:"})," ",{Admin:"Full access to all modules",Staff:"Operational role with access to certificates and circulars",Student:"Limited access for viewing and submitting enquiries"}[e]]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Current Access Summary:"})," ",j]})]})]}),e&&(0,i.jsxs)("div",{className:"section",children:[(0,i.jsx)("h3",{children:"Assign Modules"}),Object.keys(g).map(t=>(0,i.jsxs)("div",{className:"module-group",children:[(0,i.jsx)("h4",{children:t}),(0,i.jsx)("div",{className:"module-list",children:g[t].map(t=>(0,i.jsxs)("div",{className:"module-item",children:[(0,i.jsxs)("label",{className:"checkbox-label",children:[(0,i.jsx)("input",{type:"checkbox",checked:s[t]||!1,onChange:()=>(t=>{"Student"!==e&&a(e=>(0,l.A)((0,l.A)({},e),{},{[t]:!e[t]}))})(t),disabled:"Student"===e}),t]}),(0,i.jsx)("span",{className:"tooltip",title:h[t].tooltip,children:"?"})]},t))})]},t)),"Student"===e&&(0,i.jsx)("p",{className:"note",children:'Enquiries module is marked as "Submit-only" for students.'})]}),e&&(0,i.jsxs)("div",{className:"section",children:[(0,i.jsx)("label",{children:"Search Modules"}),(0,i.jsx)("input",{type:"text",placeholder:"Search modules...",value:d,onChange:e=>r(e.target.value)})]}),e&&(0,i.jsx)("div",{className:"section",children:(0,i.jsx)("button",{className:"btn btn-primary",onClick:()=>{x({message:"Permissions saved successfully!",type:"success"}),setTimeout(()=>x(null),3e3)},children:"Save Permissions"})}),e&&(0,i.jsxs)("div",{className:"section",children:[(0,i.jsx)("h3",{children:"Export & Audit"}),(0,i.jsxs)("div",{className:"export-controls",children:[(0,i.jsx)("button",{className:"btn",onClick:()=>m("Excel"),children:"Export to Excel"}),(0,i.jsx)("button",{className:"btn",onClick:()=>m("PDF"),children:"Export to PDF"})]}),(0,i.jsxs)("div",{className:"effective-date",children:[(0,i.jsx)("label",{children:"Effective Date"}),(0,i.jsx)("input",{type:"date",value:o,onChange:e=>c(e.target.value)})]}),(0,i.jsxs)("div",{className:"audit-log",children:[(0,i.jsx)("h4",{children:"Audit Log"}),(0,i.jsx)("ul",{children:(0,i.jsx)("li",{children:"Last updated by admin_01 on 2025-10-22"})})]})]})]})},B=()=>{const[e,t]=(0,n.useState)({name:"",email:"",password:"",role:"student",department:"B.A",year:"",semester:"",mobileNumber:"",designation:"",subject:"",subjectsTaught:"",qualifications:"",joiningDate:"",phone:"",address:"",staffId:""}),[s,a]=(0,n.useState)(!1),[d,r]=(0,n.useState)([]);(0,n.useEffect)(()=>{(async()=>{const e=await p.$I.getDesignations();e.success&&r(e.data)})()},[]);const o=e=>{const{name:s,value:n}=e.target;t(e=>(0,l.A)((0,l.A)({},e),{},{[s]:n}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Add User"}),(0,i.jsx)("p",{children:"Register new users with roles: Admin, Faculty, Student."}),(0,i.jsxs)("form",{onSubmit:async s=>{s.preventDefault(),a(!0);try{const s=localStorage.getItem("token"),n=(0,l.A)({},e);"Fees Administrator"===e.designation&&(delete n.department,delete n.subject);const a=await fetch("http://localhost:5000/api/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify((0,l.A)((0,l.A)({},n),{},{subjectsTaught:n.subjectsTaught?n.subjectsTaught.split(",").map(e=>e.trim()):[]}))}),d=await a.json();a.ok?(j.oR.success("User added successfully!"),t({name:"",email:"",password:"",role:"student",department:"B.A",year:"",semester:"",mobileNumber:"",designation:"",subject:"",subjectsTaught:"",qualifications:"",joiningDate:"",phone:"",address:"",staffId:""})):j.oR.error(d.message||"Failed to add user")}catch(n){j.oR.error("Network error. Please try again.")}finally{a(!1)}},style:{maxWidth:"600px"},children:[(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Name:"}),(0,i.jsx)("input",{type:"text",name:"name",value:e.name,onChange:o,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Email:"}),(0,i.jsx)("input",{type:"email",name:"email",value:e.email,onChange:o,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Password:"}),(0,i.jsx)("input",{type:"password",name:"password",value:e.password,onChange:o,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Role:"}),(0,i.jsxs)("select",{name:"role",value:e.role,onChange:o,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"admin",children:"Admin"}),(0,i.jsx)("option",{value:"faculty",children:"Faculty"}),(0,i.jsx)("option",{value:"student",children:"Student"})]})]}),"student"===e.role&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Department:"}),(0,i.jsxs)("select",{name:"department",value:e.department,onChange:o,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"B.A",children:"B.A"}),(0,i.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,i.jsx)("option",{value:"B.Ed",children:"B.Ed"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Year:"}),(0,i.jsx)("input",{type:"number",name:"year",value:e.year,onChange:o,required:!0,min:"1",max:"3",style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Semester:"}),(0,i.jsx)("input",{type:"number",name:"semester",value:e.semester,onChange:o,required:!0,min:"1",max:"6",style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Mobile Number:"}),(0,i.jsx)("input",{type:"text",name:"mobileNumber",value:e.mobileNumber,onChange:o,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),"faculty"===e.role&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Staff ID:"}),(0,i.jsx)("input",{type:"text",name:"staffId",value:e.staffId,onChange:o,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Designation:"}),(0,i.jsxs)("select",{name:"designation",value:e.designation,onChange:o,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Designation"}),d.map(e=>(0,i.jsx)("option",{value:e.name,children:e.name},e._id))]})]}),"Fees Administrator"!==e.designation&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Department:"}),(0,i.jsxs)("select",{name:"department",value:e.department,onChange:o,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"B.A",children:"B.A"}),(0,i.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,i.jsx)("option",{value:"B.Ed",children:"B.Ed"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Subject:"}),(0,i.jsx)("input",{type:"text",name:"subject",value:e.subject,onChange:o,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Subjects Taught (comma-separated):"}),(0,i.jsx)("input",{type:"text",name:"subjectsTaught",value:e.subjectsTaught,onChange:o,placeholder:"e.g., Mathematics, Physics",style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Qualifications:"}),(0,i.jsx)("input",{type:"text",name:"qualifications",value:e.qualifications,onChange:o,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Joining Date:"}),(0,i.jsx)("input",{type:"date",name:"joiningDate",value:e.joiningDate,onChange:o,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Phone:"}),(0,i.jsx)("input",{type:"text",name:"phone",value:e.phone,onChange:o,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Address:"}),(0,i.jsx)("textarea",{name:"address",value:e.address,onChange:o,rows:"3",style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),(0,i.jsx)("button",{type:"submit",disabled:s,style:{padding:"10px 20px",backgroundColor:s?"#ccc":"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:s?"not-allowed":"pointer"},children:s?"Adding User...":"Add User"})]})]})},P=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[d,r]=(0,n.useState)(""),[o,c]=(0,n.useState)(null),[p,x]=(0,n.useState)({}),[h,u]=(0,n.useState)(null),[m,g]=(0,n.useState)("");(0,n.useEffect)(()=>{j()},[]);const j=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/users",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e)}else r("Failed to fetch users")}catch(e){r("Network error. Please try again.")}finally{a(!1)}},y=e=>{const{name:t,value:s}=e.target;x(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))};return s?(0,i.jsx)("div",{className:"menu-content",children:"Loading users..."}):(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Manage Users"}),(0,i.jsx)("p",{children:"Edit, delete, or reset passwords for existing users."}),d&&(0,i.jsx)("div",{style:{padding:"10px",marginBottom:"20px",backgroundColor:d.includes("successfully")?"#d4edda":"#f8d7da",color:d.includes("successfully")?"#155724":"#721c24",border:"1px solid",borderColor:d.includes("successfully")?"#c3e6cb":"#f5c6cb",borderRadius:"4px"},children:d}),(0,i.jsx)("div",{style:{overflowX:"auto"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"20px"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"12px",border:"1px solid #dee2e6",textAlign:"left"},children:"Name"}),(0,i.jsx)("th",{style:{padding:"12px",border:"1px solid #dee2e6",textAlign:"left"},children:"Email"}),(0,i.jsx)("th",{style:{padding:"12px",border:"1px solid #dee2e6",textAlign:"left"},children:"Role"}),(0,i.jsx)("th",{style:{padding:"12px",border:"1px solid #dee2e6",textAlign:"left"},children:"Department"}),(0,i.jsx)("th",{style:{padding:"12px",border:"1px solid #dee2e6",textAlign:"left"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"12px",border:"1px solid #dee2e6"},children:e.name||e.username||e.email}),(0,i.jsx)("td",{style:{padding:"12px",border:"1px solid #dee2e6"},children:e.email}),(0,i.jsx)("td",{style:{padding:"12px",border:"1px solid #dee2e6",textTransform:"capitalize"},children:e.role}),(0,i.jsx)("td",{style:{padding:"12px",border:"1px solid #dee2e6"},children:e.department||"-"}),(0,i.jsxs)("td",{style:{padding:"12px",border:"1px solid #dee2e6"},children:[(0,i.jsx)("button",{onClick:()=>(e=>{c(e),x({name:e.name||e.username||"",email:e.email,role:e.role,department:e.department||"",year:e.year||"",semester:e.semester||"",mobileNumber:e.mobileNumber||"",designation:e.designation||"",subject:e.subject||"",subjectsTaught:e.subjectsTaught?e.subjectsTaught.join(", "):"",qualifications:e.qualifications||"",joiningDate:e.joiningDate?e.joiningDate.split("T")[0]:"",phone:e.phone||"",address:e.address||"",staffId:e.staffId||""})})(e),style:{marginRight:"5px",padding:"5px 10px",backgroundColor:"#ffc107",color:"white",border:"none",borderRadius:"3px",cursor:"pointer"},children:"Edit"}),(0,i.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete ".concat(e.name||e.username||e.email,"?")))try{const t=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/users/".concat(e._id,"/").concat(e.role),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}});if(s.ok)r("User deleted successfully!"),j();else{const e=await s.json();r(e.message||"Failed to delete user")}}catch(t){r("Network error. Please try again.")}})(e),style:{marginRight:"5px",padding:"5px 10px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"3px",cursor:"pointer"},children:"Delete"}),(0,i.jsx)("button",{onClick:()=>u(e),style:{padding:"5px 10px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"3px",cursor:"pointer"},children:"Reset Password"})]})]},e._id))})]})}),o&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"8px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflowY:"auto"},children:[(0,i.jsx)("h2",{children:"Edit User"}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/users/".concat(o._id,"/").concat(o.role),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify((0,l.A)((0,l.A)({},p),{},{subjectsTaught:p.subjectsTaught?p.subjectsTaught.split(",").map(e=>e.trim()):[]}))}),s=await t.json();t.ok?(r("User updated successfully!"),c(null),j()):r(s.message||"Failed to update user")}catch(t){r("Network error. Please try again.")}},children:[(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Name:"}),(0,i.jsx)("input",{type:"text",name:"name",value:p.name,onChange:y,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Email:"}),(0,i.jsx)("input",{type:"email",name:"email",value:p.email,onChange:y,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),"student"===o.role&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Department:"}),(0,i.jsxs)("select",{name:"department",value:p.department,onChange:y,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"B.A",children:"B.A"}),(0,i.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,i.jsx)("option",{value:"B.Ed",children:"B.Ed"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Year:"}),(0,i.jsx)("input",{type:"number",name:"year",value:p.year,onChange:y,required:!0,min:"1",max:"3",style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Semester:"}),(0,i.jsx)("input",{type:"number",name:"semester",value:p.semester,onChange:y,required:!0,min:"1",max:"6",style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Mobile Number:"}),(0,i.jsx)("input",{type:"text",name:"mobileNumber",value:p.mobileNumber,onChange:y,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),"faculty"===o.role&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Staff ID:"}),(0,i.jsx)("input",{type:"text",name:"staffId",value:p.staffId,onChange:y,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Designation:"}),(0,i.jsx)("input",{type:"text",name:"designation",value:p.designation,onChange:y,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Department:"}),(0,i.jsxs)("select",{name:"department",value:p.department,onChange:y,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"B.A",children:"B.A"}),(0,i.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,i.jsx)("option",{value:"B.Ed",children:"B.Ed"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Subject:"}),(0,i.jsx)("input",{type:"text",name:"subject",value:p.subject,onChange:y,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Subjects Taught (comma-separated):"}),(0,i.jsx)("input",{type:"text",name:"subjectsTaught",value:p.subjectsTaught,onChange:y,placeholder:"e.g., Mathematics, Physics",style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Qualifications:"}),(0,i.jsx)("input",{type:"text",name:"qualifications",value:p.qualifications,onChange:y,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Joining Date:"}),(0,i.jsx)("input",{type:"date",name:"joiningDate",value:p.joiningDate,onChange:y,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Phone:"}),(0,i.jsx)("input",{type:"text",name:"phone",value:p.phone,onChange:y,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Address:"}),(0,i.jsx)("textarea",{name:"address",value:p.address,onChange:y,rows:"3",style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[(0,i.jsx)("button",{type:"submit",style:{padding:"10px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Update User"}),(0,i.jsx)("button",{type:"button",onClick:()=>c(null),style:{padding:"10px 20px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Cancel"})]})]})]})}),h&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"8px",maxWidth:"400px",width:"90%"},children:[(0,i.jsx)("h2",{children:"Reset Password"}),(0,i.jsxs)("p",{children:["Reset password for ",h.name||h.username||h.email]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"New Password:"}),(0,i.jsx)("input",{type:"password",value:m,onChange:e=>g(e.target.value),required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[(0,i.jsx)("button",{onClick:async()=>{if(m)try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/users/reset-password/".concat(h._id,"/").concat(h.role),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({newPassword:m})});if(t.ok)r("Password reset successfully!"),u(null),g("");else{const e=await t.json();r(e.message||"Failed to reset password")}}catch(e){r("Network error. Please try again.")}else r("Please enter a new password")},style:{padding:"10px 20px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Reset Password"}),(0,i.jsx)("button",{onClick:()=>{u(null),g("")},style:{padding:"10px 20px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Cancel"})]})]})})]})},I=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)({session_name:"",start_date:"",end_date:"",description:""}),[d,r]=(0,n.useState)(!1),[o,c]=(0,n.useState)("");(0,n.useEffect)(()=>{p()},[]);const p=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/erp/sessions",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e)}}catch(e){console.error("Error fetching sessions:",e)}},x=e=>{const{name:t,value:s}=e.target;a(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Session Management"}),(0,i.jsx)("p",{children:"Create and manage academic sessions."}),o&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:o.includes("Error")?"#ffebee":"#e8f5e8",color:o.includes("Error")?"#c62828":"#2e7d32"},children:o}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),r(!0),c(""),new Date(s.start_date)>=new Date(s.end_date))return c("End date must be after start date"),void r(!1);try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(s)}),n=await t.json();t.ok?(c("Session created successfully!"),a({session_name:"",start_date:"",end_date:"",description:""}),p()):c(n.message||"Failed to create session")}catch(t){c("Error creating session: "+t.message)}finally{r(!1)}},style:{marginBottom:"30px"},children:[(0,i.jsx)("h3",{children:"Create New Session"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Session Name:"}),(0,i.jsx)("input",{type:"text",name:"session_name",value:s.session_name,onChange:x,placeholder:"e.g., 2024-25",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Description:"}),(0,i.jsx)("input",{type:"text",name:"description",value:s.description,onChange:x,placeholder:"Academic Year 2024-25",style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Start Date:"}),(0,i.jsx)("input",{type:"date",name:"start_date",value:s.start_date,onChange:x,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"End Date:"}),(0,i.jsx)("input",{type:"date",name:"end_date",value:s.end_date,onChange:x,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),(0,i.jsx)("button",{type:"submit",disabled:d,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:d?"not-allowed":"pointer"},children:d?"Creating...":"Create Session"})]}),(0,i.jsx)("h3",{children:"Existing Sessions"}),(0,i.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:e.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Session Name"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Start Date"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"End Date"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Status"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.session_name}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:new Date(e.start_date).toLocaleDateString()}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:new Date(e.end_date).toLocaleDateString()}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,i.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",backgroundColor:e.isActive?"#d4edda":"#f8d7da",color:e.isActive?"#155724":"#721c24"},children:e.isActive?"Active":"Inactive"})}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:!e.isActive&&(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/erp/session/".concat(e,"/activate"),{method:"PUT",headers:{Authorization:"Bearer ".concat(t)}}),n=await s.json();s.ok?(c("Session activated successfully!"),p()):c(n.message||"Failed to activate session")}catch(t){c("Error activating session: "+t.message)}})(e.session_name),style:{padding:"6px 12px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Activate"})})]},e._id))})]}):(0,i.jsx)("p",{children:"No sessions found."})})]})},F=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),[c,p]=(0,n.useState)("structures"),[x,h]=(0,n.useState)([]),[u,m]=(0,n.useState)(!1);(0,n.useEffect)(()=>{g(),j(),y()},[]);const g=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/fees",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e)}}catch(e){console.error("Error fetching fee structures:",e)}},j=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/payments/all",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();a(e)}}catch(e){console.error("Error fetching payments:",e)}},y=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/audit-logs",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();h(e)}}catch(e){console.error("Error fetching audit logs:",e)}},b=async(e,t)=>{try{const s=localStorage.getItem("token");(await fetch("http://localhost:5000/api/payments/".concat(e,"/status"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({status:t})})).ok?(o("Payment status updated successfully!"),j()):o("Failed to update payment status")}catch(s){o("Error updating payment status: "+s.message)}},f=e=>{switch(e){case"Paid":return"#28a745";case"Pending":return"#ffc107";case"Failed":return"#dc3545";default:return"#6c757d"}};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Manage Fees"}),(0,i.jsx)("p",{children:"Manage fee structures and monitor payments for all courses."}),l&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:l.includes("Error")||l.includes("Failed")?"#ffebee":"#e8f5e8",color:l.includes("Error")||l.includes("Failed")?"#c62828":"#2e7d32"},children:l}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("button",{onClick:()=>p("structures"),style:{padding:"10px 20px",marginRight:"10px",backgroundColor:"structures"===c?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Fee Structures"}),(0,i.jsx)("button",{onClick:()=>p("payments"),style:{padding:"10px 20px",marginRight:"10px",backgroundColor:"payments"===c?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Payment Records"}),(0,i.jsx)("button",{onClick:()=>p("audit"),style:{padding:"10px 20px",backgroundColor:"audit"===c?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Audit Logs"})]}),"structures"===c&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Fee Structures"}),(0,i.jsx)("div",{style:{maxHeight:"600px",overflowY:"auto"},children:e.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Course"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Fee Components"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Total Amount"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.course}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:Object.entries(e.feeComponents).map(e=>{let[t,s]=e;return(0,i.jsxs)("div",{children:[t.charAt(0).toUpperCase()+t.slice(1).replace(/([A-Z])/g," $1"),": \u20b9",s]},t)})}),(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:["\u20b9",e.totalFee]}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,i.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this fee structure?"))try{const t=localStorage.getItem("token");(await fetch("http://localhost:5000/api/fees/structure/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok?(o("Fee structure deleted successfully!"),g()):o("Failed to delete fee structure")}catch(t){o("Error deleting fee structure: "+t.message)}})(e._id),style:{padding:"5px 10px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",marginRight:"5px"},children:"Delete"})})]},e._id))})]}):(0,i.jsx)("p",{children:"No fee structures found."})})]}),"payments"===c&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Payment Records"}),(0,i.jsx)("div",{style:{maxHeight:"600px",overflowY:"auto"},children:s.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Student ID"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Course"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Year"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Semester"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Type"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Amount"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Status"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Date"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:s.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.studentId}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.course}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.year}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.semester}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.paymentType}),(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:["\u20b9",e.amount]}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,i.jsx)("span",{style:{padding:"3px 8px",borderRadius:"12px",backgroundColor:f(e.status),color:"white",fontSize:"12px"},children:e.status})}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:new Date(e.createdAt).toLocaleDateString()}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:"Pending"===e.status&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>b(e._id,"Paid"),style:{padding:"5px 10px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",marginRight:"5px"},children:"Approve"}),(0,i.jsx)("button",{onClick:()=>b(e._id,"Failed"),style:{padding:"5px 10px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Reject"})]})})]},e._id))})]}):(0,i.jsx)("p",{children:"No payment records found."})})]}),"audit"===c&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Audit Logs"}),(0,i.jsx)("div",{style:{maxHeight:"600px",overflowY:"auto"},children:x.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Action"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"User"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Details"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Timestamp"})]})}),(0,i.jsx)("tbody",{children:x.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.action}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.user}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.details}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:new Date(e.timestamp).toLocaleString()})]},e._id))})]}):(0,i.jsx)("p",{children:"No audit logs found."})})]})]})},q=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!1),[d,r]=(0,n.useState)(""),[o,c]=(0,n.useState)("list"),[p,x]=(0,n.useState)({studentId:"",course:"",concessionType:"Scholarship",amount:"",reason:"",academicYear:"",semester:""}),[h,u]=(0,n.useState)(null);(0,n.useEffect)(()=>{m()},[]);const m=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/concessions",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e)}}catch(e){console.error("Error fetching concessions:",e)}},g=e=>{const{name:t,value:s}=e.target;x(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))},j=()=>{x({studentId:"",course:"",concessionType:"Scholarship",amount:"",reason:"",academicYear:"",semester:""}),u(null)};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Manage Concessions"}),(0,i.jsx)("p",{children:"Manage student concessions and scholarships."}),d&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:d.includes("Error")||d.includes("Failed")?"#ffebee":"#e8f5e8",color:d.includes("Error")||d.includes("Failed")?"#c62828":"#2e7d32"},children:d}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("button",{onClick:()=>c("list"),style:{padding:"10px 20px",marginRight:"10px",backgroundColor:"list"===o?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"View Concessions"}),(0,i.jsx)("button",{onClick:()=>{c("create"),j()},style:{padding:"10px 20px",backgroundColor:"create"===o?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:h?"Edit Concession":"Create Concession"})]}),"create"===o&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:h?"Edit Concession":"Create New Concession"}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),a(!0),r("");try{const e=localStorage.getItem("token"),t=h?"http://localhost:5000/api/concessions/".concat(h):"http://localhost:5000/api/concessions",s=h?"PUT":"POST",n=await fetch(t,{method:s,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(p)});if(n.ok)r(h?"Concession updated successfully!":"Concession created successfully!"),m(),j(),c("list");else{const e=await n.json();r(e.message||"Failed to save concession")}}catch(t){r("Error saving concession: "+t.message)}finally{a(!1)}},style:{maxWidth:"600px"},children:[(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Student ID:"}),(0,i.jsx)("input",{type:"text",name:"studentId",value:p.studentId,onChange:g,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Course:"}),(0,i.jsxs)("select",{name:"course",value:p.course,onChange:g,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Course"}),(0,i.jsx)("option",{value:"B.A",children:"B.A"}),(0,i.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,i.jsx)("option",{value:"B.Ed",children:"B.Ed"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Concession Type:"}),(0,i.jsxs)("select",{name:"concessionType",value:p.concessionType,onChange:g,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"Scholarship",children:"Scholarship"}),(0,i.jsx)("option",{value:"Fee Waiver",children:"Fee Waiver"}),(0,i.jsx)("option",{value:"Discount",children:"Discount"}),(0,i.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Amount:"}),(0,i.jsx)("input",{type:"number",name:"amount",value:p.amount,onChange:g,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Reason:"}),(0,i.jsx)("textarea",{name:"reason",value:p.reason,onChange:g,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px",minHeight:"80px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Academic Year:"}),(0,i.jsx)("input",{type:"text",name:"academicYear",value:p.academicYear,onChange:g,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Semester:"}),(0,i.jsx)("input",{type:"number",name:"semester",value:p.semester,onChange:g,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsx)("button",{type:"submit",disabled:s,style:{padding:"10px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:s?"not-allowed":"pointer"},children:s?"Saving...":h?"Update Concession":"Create Concession"})]})]}),"list"===o&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Concessions List"}),(0,i.jsx)("div",{style:{maxHeight:"600px",overflowY:"auto"},children:e.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Student ID"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Course"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Type"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Amount"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Status"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.studentId}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.course}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.concessionType}),(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:["\u20b9",e.amount]}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,i.jsx)("span",{style:{padding:"3px 8px",borderRadius:"12px",backgroundColor:"Approved"===e.status?"#28a745":"Pending"===e.status?"#ffc107":"#dc3545",color:"white",fontSize:"12px"},children:e.status})}),(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:[(0,i.jsx)("button",{onClick:()=>(e=>{x({studentId:e.studentId,course:e.course,concessionType:e.concessionType,amount:e.amount,reason:e.reason,academicYear:e.academicYear,semester:e.semester}),u(e._id),c("create")})(e),style:{padding:"5px 10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",marginRight:"5px"},children:"Edit"}),(0,i.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this concession?"))try{const t=localStorage.getItem("token");(await fetch("http://localhost:5000/api/concessions/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok?(r("Concession deleted successfully!"),m()):r("Failed to delete concession")}catch(t){r("Error deleting concession: "+t.message)}})(e._id),style:{padding:"5px 10px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Delete"})]})]},e._id))})]}):(0,i.jsx)("p",{children:"No concessions found."})})]})]})},L=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!1),[d,r]=(0,n.useState)(""),[o,c]=(0,n.useState)("list"),[p,x]=(0,n.useState)({studentId:"",selectedPayment:null}),[h,u]=(0,n.useState)(null),[m,g]=(0,n.useState)([]),[j,y]=(0,n.useState)(!1);(0,n.useEffect)(()=>{b()},[]);const b=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/receipts",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e)}}catch(e){console.error("Error fetching receipts:",e)}},f=async e=>{if(e.length<9)return u(null),g([]),void x(e=>(0,l.A)((0,l.A)({},e),{},{selectedPayment:null}));y(!0),u(null),g([]),x(e=>(0,l.A)((0,l.A)({},e),{},{selectedPayment:null}));try{const t=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/payments/student-details/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}});if(s.ok){const e=await s.json();u(e)}const n=await fetch("http://localhost:5000/api/payments/student/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=(await n.json()).filter(e=>"Paid"===e.status);g(e)}}catch(t){console.error("Error fetching student data:",t),r("Error fetching student data")}finally{y(!1)}};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Manage Receipts"}),(0,i.jsx)("p",{children:"Generate, view, and manage payment receipts."}),d&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:d.includes("Error")||d.includes("Failed")?"#ffebee":"#e8f5e8",color:d.includes("Error")||d.includes("Failed")?"#c62828":"#2e7d32"},children:d}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("button",{onClick:()=>c("list"),style:{padding:"10px 20px",marginRight:"10px",backgroundColor:"list"===o?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"View Receipts"}),(0,i.jsx)("button",{onClick:()=>c("generate"),style:{padding:"10px 20px",backgroundColor:"generate"===o?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Generate Receipt"})]}),"generate"===o&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Generate New Receipt"}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),a(!0),r(""),!p.selectedPayment)return r("Please select a payment to generate receipt"),void a(!1);try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/receipts/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({paymentId:p.paymentId})});if(t.ok)r("Receipt generated successfully!"),b(),x({studentId:"",selectedPayment:null}),u(null),g([]),c("list");else{const e=await t.json();r(e.message||"Failed to generate receipt")}}catch(t){r("Error generating receipt: "+t.message)}finally{a(!1)}},style:{maxWidth:"800px"},children:[(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Student ID:"}),(0,i.jsx)("input",{type:"text",name:"studentId",value:p.studentId,onChange:e=>{const{name:t,value:s}=e.target;x(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s})),"studentId"===t&&s.trim()&&f(s.trim())},required:!0,placeholder:"Enter student ID to fetch details",style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),j&&(0,i.jsx)("div",{style:{marginBottom:"15px",color:"#007bff"},children:"Fetching student data..."}),h&&(0,i.jsxs)("div",{style:{marginBottom:"15px",padding:"10px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("h4",{children:"Student Details:"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Name:"})," ",h.firstName," ",h.middleName||""," ",h.lastName]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Course:"})," ",h.course]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Year:"})," ",h.year]})]}),m.length>0&&(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Select Payment:"}),(0,i.jsx)("div",{style:{maxHeight:"200px",overflowY:"auto",border:"1px solid #ddd",borderRadius:"4px"},children:m.map(e=>(0,i.jsxs)("div",{onClick:()=>(e=>{x(t=>(0,l.A)((0,l.A)({},t),{},{selectedPayment:e,paymentId:e.paymentId}))})(e),style:{padding:"10px",cursor:"pointer",backgroundColor:p.selectedPayment&&p.selectedPayment._id===e._id?"#e3f2fd":"white",borderBottom:"1px solid #eee"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Payment ID:"})," ",e.paymentId]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Amount:"})," \u20b9",e.amount]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Date:"})," ",new Date(e.paymentDate).toLocaleDateString()]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Method:"})," ",e.paymentMethod]})]},e._id))})]}),0===m.length&&p.studentId&&!j&&(0,i.jsx)("div",{style:{marginBottom:"15px",color:"#dc3545"},children:"No paid payments found for this student."}),(0,i.jsx)("button",{type:"submit",disabled:s||!p.selectedPayment,style:{padding:"10px 20px",backgroundColor:p.selectedPayment?"#28a745":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:s||!p.selectedPayment?"not-allowed":"pointer"},children:s?"Generating...":"Generate Receipt"})]})]}),"list"===o&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Receipts List"}),(0,i.jsx)("div",{style:{maxHeight:"600px",overflowY:"auto"},children:e.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Receipt No"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Student ID"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Amount"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Status"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Date"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.receiptNumber}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.studentId}),(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:["\u20b9",e.amount]}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,i.jsx)("span",{style:{padding:"3px 8px",borderRadius:"12px",backgroundColor:"Active"===e.status?"#28a745":"#dc3545",color:"white",fontSize:"12px"},children:e.status})}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:new Date(e.createdAt).toLocaleDateString()}),(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:[(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/receipts/".concat(e,"/download"),{headers:{Authorization:"Bearer ".concat(t)}});if(s.ok){const t=await s.blob(),n=window.URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download="receipt_".concat(e,".pdf"),document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(n),document.body.removeChild(a)}else r("Failed to download receipt")}catch(t){r("Error downloading receipt: "+t.message)}})(e._id),style:{padding:"5px 10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",marginRight:"5px"},children:"Download"}),"Active"===e.status&&(0,i.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to cancel this receipt?"))try{const t=localStorage.getItem("token");(await fetch("http://localhost:5000/api/receipts/".concat(e,"/cancel"),{method:"PUT",headers:{Authorization:"Bearer ".concat(t)}})).ok?(r("Receipt cancelled successfully!"),b()):r("Failed to cancel receipt")}catch(t){r("Error cancelling receipt: "+t.message)}})(e._id),style:{padding:"5px 10px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Cancel"})]})]},e._id))})]}):(0,i.jsx)("p",{children:"No receipts found."})})]})]})},O=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!1),[d,r]=(0,n.useState)(""),[o,c]=(0,n.useState)("list"),[p,x]=(0,n.useState)({recipientId:"",recipientRole:"student",type:"general",title:"",message:"",priority:"normal",course:"",academicYear:"",semester:""});(0,n.useEffect)(()=>{h()},[]);const h=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/notifications",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e)}}catch(e){console.error("Error fetching notifications:",e)}},u=e=>{const{name:t,value:s}=e.target;x(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))},m=e=>{switch(e){case"high":return"#dc3545";case"normal":return"#ffc107";case"low":return"#28a745";default:return"#6c757d"}};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Manage Notifications"}),(0,i.jsx)("p",{children:"Send and manage notifications for students and staff."}),d&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:d.includes("Error")||d.includes("Failed")?"#ffebee":"#e8f5e8",color:d.includes("Error")||d.includes("Failed")?"#c62828":"#2e7d32"},children:d}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("button",{onClick:()=>c("list"),style:{padding:"10px 20px",marginRight:"10px",backgroundColor:"list"===o?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"View Notifications"}),(0,i.jsx)("button",{onClick:()=>c("send"),style:{padding:"10px 20px",marginRight:"10px",backgroundColor:"send"===o?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Send Individual"}),(0,i.jsx)("button",{onClick:()=>c("bulk"),style:{padding:"10px 20px",backgroundColor:"bulk"===o?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Bulk Send"})]}),("send"===o||"bulk"===o)&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"send"===o?"Send Individual Notification":"Send Bulk Notification"}),(0,i.jsxs)("form",{onSubmit:"send"===o?async e=>{e.preventDefault(),a(!0),r("");try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/notifications/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(p)});if(t.ok)r("Notification sent successfully!"),h(),x({recipientId:"",recipientRole:"student",type:"general",title:"",message:"",priority:"normal",course:"",academicYear:"",semester:""}),c("list");else{const e=await t.json();r(e.message||"Failed to send notification")}}catch(t){r("Error sending notification: "+t.message)}finally{a(!1)}}:async e=>{e.preventDefault(),a(!0),r("");try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/notifications/bulk-send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({recipientRole:p.recipientRole,type:p.type,title:p.title,message:p.message,priority:p.priority,course:p.course,academicYear:p.academicYear,semester:p.semester})});if(t.ok)r("Bulk notification sent successfully!"),h(),x({recipientId:"",recipientRole:"student",type:"general",title:"",message:"",priority:"normal",course:"",academicYear:"",semester:""}),c("list");else{const e=await t.json();r(e.message||"Failed to send bulk notification")}}catch(t){r("Error sending bulk notification: "+t.message)}finally{a(!1)}},style:{maxWidth:"600px"},children:["send"===o&&(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Recipient ID:"}),(0,i.jsx)("input",{type:"text",name:"recipientId",value:p.recipientId,onChange:u,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Recipient Role:"}),(0,i.jsxs)("select",{name:"recipientRole",value:p.recipientRole,onChange:u,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"student",children:"Student"}),(0,i.jsx)("option",{value:"staff",children:"Staff"}),(0,i.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Type:"}),(0,i.jsxs)("select",{name:"type",value:p.type,onChange:u,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"general",children:"General"}),(0,i.jsx)("option",{value:"fee",children:"Fee Related"}),(0,i.jsx)("option",{value:"academic",children:"Academic"}),(0,i.jsx)("option",{value:"exam",children:"Exam"}),(0,i.jsx)("option",{value:"payment",children:"Payment"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Title:"}),(0,i.jsx)("input",{type:"text",name:"title",value:p.title,onChange:u,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Message:"}),(0,i.jsx)("textarea",{name:"message",value:p.message,onChange:u,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px",minHeight:"100px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Priority:"}),(0,i.jsxs)("select",{name:"priority",value:p.priority,onChange:u,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"low",children:"Low"}),(0,i.jsx)("option",{value:"normal",children:"Normal"}),(0,i.jsx)("option",{value:"high",children:"High"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Course (Optional):"}),(0,i.jsxs)("select",{name:"course",value:p.course,onChange:u,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"All Courses"}),(0,i.jsx)("option",{value:"B.A",children:"B.A"}),(0,i.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,i.jsx)("option",{value:"B.Ed",children:"B.Ed"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Academic Year (Optional):"}),(0,i.jsx)("input",{type:"text",name:"academicYear",value:p.academicYear,onChange:u,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Semester (Optional):"}),(0,i.jsx)("input",{type:"number",name:"semester",value:p.semester,onChange:u,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsx)("button",{type:"submit",disabled:s,style:{padding:"10px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:s?"not-allowed":"pointer"},children:s?"Sending...":"send"===o?"Send Notification":"Send Bulk Notification"})]})]}),"list"===o&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Notifications List"}),(0,i.jsx)("div",{style:{maxHeight:"600px",overflowY:"auto"},children:e.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Title"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Type"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Recipient"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Priority"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Status"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Date"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.title}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.type}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.recipientId||"".concat(e.recipientRole,"s")}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,i.jsx)("span",{style:{padding:"3px 8px",borderRadius:"12px",backgroundColor:m(e.priority),color:"white",fontSize:"12px"},children:e.priority})}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,i.jsx)("span",{style:{padding:"3px 8px",borderRadius:"12px",backgroundColor:e.isRead?"#28a745":"#ffc107",color:"white",fontSize:"12px"},children:e.isRead?"Read":"Unread"})}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:new Date(e.createdAt).toLocaleDateString()}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:!e.isRead&&(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("token");(await fetch("http://localhost:5000/api/notifications/".concat(e,"/read"),{method:"PUT",headers:{Authorization:"Bearer ".concat(t)}})).ok?(r("Notification marked as read!"),h()):r("Failed to mark notification as read")}catch(t){r("Error marking notification as read: "+t.message)}})(e._id),style:{padding:"5px 10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Mark Read"})})]},e._id))})]}):(0,i.jsx)("p",{children:"No notifications found."})})]})]})};var M=s(9073),U=s(3204);const z=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)([]),[o,c]=(0,n.useState)([]),[p,x]=(0,n.useState)({session_name:"",route_name:"",stops:[{name:"",distance:0}],base_fare:0}),[h,u]=(0,n.useState)({student_id:"",route_id:"",stop_name:"",fare:0}),[m,g]=(0,n.useState)(!1),[j,y]=(0,n.useState)(""),[b,f]=(0,n.useState)("routes");(0,n.useEffect)(()=>{v(),S(),C(),w()},[]);const v=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/erp/sessions",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e)}}catch(e){console.error("Error fetching sessions:",e)}},S=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/transport/routes",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();a(e)}}catch(e){console.error("Error fetching routes:",e)}},C=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/students",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();r(e)}}catch(e){console.error("Error fetching students:",e)}},w=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/transport/assignments",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();c(e)}}catch(e){console.error("Error fetching assignments:",e)}},A=e=>{const{name:t,value:s}=e.target;x(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))},k=(e,t,s)=>{const n=[...p.stops];n[e][t]="distance"===t?parseFloat(s)||0:s,x(e=>(0,l.A)((0,l.A)({},e),{},{stops:n}))},N=e=>{const{name:t,value:s}=e.target;u(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))},_=(e,t)=>{const n=s.find(t=>t._id===e);if(!n)return 0;const a=n.stops.find(e=>e.name===t);return a?n.base_fare+2*a.distance:n.base_fare};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Transport Routes & Fare Management"}),(0,i.jsx)("p",{children:"Manage bus routes, fares, and student assignments."}),j&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:j.includes("Error")?"#ffebee":"#e8f5e8",color:j.includes("Error")?"#c62828":"#2e7d32"},children:j}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("button",{onClick:()=>f("routes"),style:{padding:"10px 20px",marginRight:"10px",backgroundColor:"routes"===b?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Manage Routes"}),(0,i.jsx)("button",{onClick:()=>f("assignments"),style:{padding:"10px 20px",backgroundColor:"assignments"===b?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Student Assignments"})]}),"routes"===b&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),g(!0),y(""),!p.session_name)return y("Please select a session."),void g(!1);if(!p.route_name.trim())return y("Please enter a route name."),void g(!1);if(p.base_fare<=0)return y("Base fare must be greater than 0."),void g(!1);if(p.stops.some(e=>!e.name.trim()||e.distance<=0))return y("All stops must have a name and distance greater than 0."),void g(!1);try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/transport/route",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(p)}),s=await t.json();t.ok?(y("Transport route created successfully!"),x({session_name:"",route_name:"",stops:[{name:"",distance:0}],base_fare:0}),S()):y(s.message||"Failed to create transport route")}catch(t){y("Error creating transport route: "+t.message)}finally{g(!1)}},style:{marginBottom:"30px"},children:[(0,i.jsx)("h3",{children:"Create Transport Route"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Session:"}),(0,i.jsxs)("select",{name:"session_name",value:p.session_name,onChange:A,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Session"}),e.map(e=>(0,i.jsxs)("option",{value:e.session_name,children:[e.session_name," (",e.description,")"]},e._id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Route Name:"}),(0,i.jsx)("input",{type:"text",name:"route_name",value:p.route_name,onChange:A,placeholder:"e.g., Route A, City Center Route",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Base Fare (\u20b9):"}),(0,i.jsx)("input",{type:"number",name:"base_fare",value:p.base_fare,onChange:A,min:"0",step:"0.01",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsx)("h4",{children:"Route Stops"}),p.stops.map((e,t)=>(0,i.jsx)("div",{style:{border:"1px solid #ddd",borderRadius:"4px",padding:"15px",marginBottom:"10px",backgroundColor:"#f9f9f9"},children:(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 0.5fr",gap:"10px",alignItems:"end"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Stop Name:"}),(0,i.jsx)("input",{type:"text",value:e.name,onChange:e=>k(t,"name",e.target.value),placeholder:"e.g., School Gate, Main Road",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Distance (km):"}),(0,i.jsx)("input",{type:"number",value:e.distance,onChange:e=>k(t,"distance",e.target.value),min:"0",step:"0.1",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsx)("div",{children:p.stops.length>1&&(0,i.jsx)("button",{type:"button",onClick:()=>(e=>{if(p.stops.length>1){const t=p.stops.filter((t,s)=>s!==e);x(e=>(0,l.A)((0,l.A)({},e),{},{stops:t}))}})(t),style:{padding:"8px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Remove"})})]})},t)),(0,i.jsx)("div",{style:{marginBottom:"15px"},children:(0,i.jsx)("button",{type:"button",onClick:()=>{x(e=>(0,l.A)((0,l.A)({},e),{},{stops:[...e.stops,{name:"",distance:0}]}))},style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",marginRight:"10px"},children:"Add Stop"})}),(0,i.jsx)("button",{type:"submit",disabled:m,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:m?"not-allowed":"pointer"},children:m?"Creating...":"Create Route"})]}),(0,i.jsx)("h3",{children:"Existing Routes"}),(0,i.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:s.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Session"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Route Name"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Stops"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Base Fare"})]})}),(0,i.jsx)("tbody",{children:s.map(e=>{var t;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.session_name}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.route_name}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.stops.map((e,t)=>(0,i.jsxs)("div",{children:[e.name," (",e.distance," km)"]},t))}),(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:["\u20b9",(null===(t=e.base_fare)||void 0===t?void 0:t.toFixed(2))||"0.00"]})]},e._id)})})]}):(0,i.jsx)("p",{children:"No routes found."})})]}),"assignments"===b&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),g(!0),y(""),!h.student_id)return y("Please select a student."),void g(!1);if(!h.route_id)return y("Please select a route."),void g(!1);if(!h.stop_name.trim())return y("Please enter a stop name."),void g(!1);if(h.fare<0)return y("Fare cannot be negative."),void g(!1);try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/transport/assignment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(h)}),s=await t.json();t.ok?(y("Student assigned to transport route successfully!"),u({student_id:"",route_id:"",stop_name:"",fare:0}),w()):y(s.message||"Failed to assign student")}catch(t){y("Error assigning student: "+t.message)}finally{g(!1)}},style:{marginBottom:"30px"},children:[(0,i.jsx)("h3",{children:"Assign Student to Transport Route"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Student:"}),(0,i.jsxs)("select",{name:"student_id",value:h.student_id,onChange:N,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Student"}),d.map(e=>(0,i.jsxs)("option",{value:e._id,children:[e.first_name," ",e.last_name," (",e.student_id,")"]},e._id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Route:"}),(0,i.jsxs)("select",{name:"route_id",value:h.route_id,onChange:e=>{const t=e.target.value;u(e=>(0,l.A)((0,l.A)({},e),{},{route_id:t,fare:_(t,e.stop_name)}))},required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Route"}),s.map(e=>(0,i.jsxs)("option",{value:e._id,children:[e.route_name," (",e.session_name,")"]},e._id))]})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Stop Name:"}),(0,i.jsx)("input",{type:"text",name:"stop_name",value:h.stop_name,onChange:e=>{const t=e.target.value;u(e=>(0,l.A)((0,l.A)({},e),{},{stop_name:t,fare:_(e.route_id,t)}))},placeholder:"e.g., School Gate",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Fare (\u20b9):"}),(0,i.jsx)("input",{type:"number",name:"fare",value:h.fare,onChange:N,min:"0",step:"0.01",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),(0,i.jsx)("button",{type:"submit",disabled:m,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:m?"not-allowed":"pointer"},children:m?"Assigning...":"Assign Student"})]}),(0,i.jsx)("h3",{children:"Student Assignments"}),(0,i.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:o.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Student"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Route"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Stop"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Fare"})]})}),(0,i.jsx)("tbody",{children:o.map(e=>{var t,s,n,a;return(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:[null===(t=e.student_id)||void 0===t?void 0:t.first_name," ",null===(s=e.student_id)||void 0===s?void 0:s.last_name]}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:null===(n=e.route_id)||void 0===n?void 0:n.route_name}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.stop_name}),(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:["\u20b9",(null===(a=e.fare)||void 0===a?void 0:a.toFixed(2))||"0.00"]})]},e._id)})})]}):(0,i.jsx)("p",{children:"No assignments found."})})]})]})},W=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)([]),[o,c]=(0,n.useState)([]),[p,x]=(0,n.useState)([]),[h,u]=(0,n.useState)({session_name:"",hostel_id:"",fee_amount:0,cycle:"monthly"}),[m,g]=(0,n.useState)({student_id:"",hostel_id:"",room_number:"",bed_number:"",start_date:""}),[j,y]=(0,n.useState)(!1),[b,f]=(0,n.useState)(""),[v,S]=(0,n.useState)("fees");(0,n.useEffect)(()=>{C(),w(),A(),k(),N()},[]);const C=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/erp/sessions",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e)}}catch(e){console.error("Error fetching sessions:",e)}},w=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/hostels",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();a(e)}}catch(e){console.error("Error fetching hostels:",e)}},A=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/students",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();r(e)}}catch(e){console.error("Error fetching students:",e)}},k=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/hostel/fees",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();c(e)}}catch(e){console.error("Error fetching fees:",e)}},N=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/hostel/assignments",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();x(e)}}catch(e){console.error("Error fetching assignments:",e)}},_=e=>{const{name:t,value:s}=e.target;u(e=>(0,l.A)((0,l.A)({},e),{},{[t]:"fee_amount"===t?parseFloat(s)||0:s}))},R=e=>{const{name:t,value:s}=e.target;g(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Hostel Fees Management"}),(0,i.jsx)("p",{children:"Manage hostel fees and student assignments."}),b&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:b.includes("Error")?"#ffebee":"#e8f5e8",color:b.includes("Error")?"#c62828":"#2e7d32"},children:b}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("button",{onClick:()=>S("fees"),style:{padding:"10px 20px",marginRight:"10px",backgroundColor:"fees"===v?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Set Fees"}),(0,i.jsx)("button",{onClick:()=>S("assignments"),style:{padding:"10px 20px",backgroundColor:"assignments"===v?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Student Assignments"})]}),"fees"===v&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),y(!0),f(""),!h.session_name)return f("Please select a session."),void y(!1);if(!h.hostel_id)return f("Please select a hostel."),void y(!1);if(h.fee_amount<=0)return f("Fee amount must be greater than 0."),void y(!1);if(!["monthly","yearly","term"].includes(h.cycle))return f("Please select a valid fee cycle."),void y(!1);try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/hostel/fee",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(h)}),s=await t.json();t.ok?(f("Hostel fee set successfully!"),u({session_name:"",hostel_id:"",fee_amount:0,cycle:"monthly"}),k()):f(s.message||"Failed to set hostel fee")}catch(t){f("Error setting hostel fee: "+t.message)}finally{y(!1)}},style:{marginBottom:"30px"},children:[(0,i.jsx)("h3",{children:"Set Hostel Fee"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Session:"}),(0,i.jsxs)("select",{name:"session_name",value:h.session_name,onChange:_,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Session"}),e.map(e=>(0,i.jsxs)("option",{value:e.session_name,children:[e.session_name," (",e.description,")"]},e._id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Hostel:"}),(0,i.jsxs)("select",{name:"hostel_id",value:h.hostel_id,onChange:_,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Hostel"}),s.map(e=>(0,i.jsxs)("option",{value:e._id,children:[e.hostel_name," (",e.hostel_type,")"]},e._id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Fee Cycle:"}),(0,i.jsxs)("select",{name:"cycle",value:h.cycle,onChange:_,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"monthly",children:"Monthly"}),(0,i.jsx)("option",{value:"yearly",children:"Yearly"}),(0,i.jsx)("option",{value:"term",children:"Term"})]})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Fee Amount (\u20b9):"}),(0,i.jsx)("input",{type:"number",name:"fee_amount",value:h.fee_amount,onChange:_,min:"0",step:"0.01",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsx)("button",{type:"submit",disabled:j,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:j?"not-allowed":"pointer"},children:j?"Setting...":"Set Fee"})]}),(0,i.jsx)("h3",{children:"Hostel Fees"}),(0,i.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:o.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Session"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Hostel"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Fee Amount"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Cycle"})]})}),(0,i.jsx)("tbody",{children:o.map(e=>{var t,s,n;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.session_name}),(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:[null===(t=e.hostel_id)||void 0===t?void 0:t.hostel_name," (",null===(s=e.hostel_id)||void 0===s?void 0:s.hostel_type,")"]}),(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:["\u20b9",(null===(n=e.fee_amount)||void 0===n?void 0:n.toFixed(2))||"0.00"]}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.cycle?e.cycle.charAt(0).toUpperCase()+e.cycle.slice(1):"N/A"})]},e._id)})})]}):(0,i.jsx)("p",{children:"No hostel fees found."})})]}),"assignments"===v&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),y(!0),f(""),!m.student_id)return f("Please select a student."),void y(!1);if(!m.hostel_id)return f("Please select a hostel."),void y(!1);if(!m.start_date)return f("Please select a start date."),void y(!1);try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/hostel/assignment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(m)}),s=await t.json();t.ok?(f("Student assigned to hostel successfully!"),g({student_id:"",hostel_id:"",room_number:"",bed_number:"",start_date:""}),N()):f(s.message||"Failed to assign student")}catch(t){f("Error assigning student: "+t.message)}finally{y(!1)}},style:{marginBottom:"30px"},children:[(0,i.jsx)("h3",{children:"Assign Student to Hostel"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Student:"}),(0,i.jsxs)("select",{name:"student_id",value:m.student_id,onChange:R,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Student"}),d.map(e=>(0,i.jsxs)("option",{value:e._id,children:[e.first_name," ",e.last_name," (",e.student_id,")"]},e._id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Hostel:"}),(0,i.jsxs)("select",{name:"hostel_id",value:m.hostel_id,onChange:R,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Hostel"}),s.map(e=>(0,i.jsxs)("option",{value:e._id,children:[e.hostel_name," (",e.hostel_type,")"]},e._id))]})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Room Number:"}),(0,i.jsx)("input",{type:"text",name:"room_number",value:m.room_number,onChange:R,placeholder:"e.g., 101",style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Bed Number:"}),(0,i.jsx)("input",{type:"text",name:"bed_number",value:m.bed_number,onChange:R,placeholder:"e.g., A1",style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Start Date:"}),(0,i.jsx)("input",{type:"date",name:"start_date",value:m.start_date,onChange:R,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),(0,i.jsx)("button",{type:"submit",disabled:j,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:j?"not-allowed":"pointer"},children:j?"Assigning...":"Assign Student"})]}),(0,i.jsx)("h3",{children:"Student Assignments"}),(0,i.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:p.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Student"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Hostel"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Room"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Bed"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Start Date"})]})}),(0,i.jsx)("tbody",{children:p.map(e=>{var t,s,n;return(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:[null===(t=e.student_id)||void 0===t?void 0:t.first_name," ",null===(s=e.student_id)||void 0===s?void 0:s.last_name]}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:null===(n=e.hostel_id)||void 0===n?void 0:n.hostel_name}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.room_number||"N/A"}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.bed_number||"N/A"}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:new Date(e.start_date).toLocaleDateString()})]},e._id)})})]}):(0,i.jsx)("p",{children:"No assignments found."})})]})]})},H=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)([]),[o,c]=(0,n.useState)([]),[p,x]=(0,n.useState)([]),[h,u]=(0,n.useState)([]),[m,g]=(0,n.useState)({student_id:"",session_name:"",discount_type:"percent",value:0,reason:"",applied_on:"overall",target_id:"",cap_amount:0,start_date:"",end_date:""}),[j,y]=(0,n.useState)(!1),[b,f]=(0,n.useState)("");(0,n.useEffect)(()=>{v(),S(),C(),w(),A(),k()},[]);const v=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/erp/sessions",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e)}}catch(e){console.error("Error fetching sessions:",e)}},S=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/students",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();a(e)}}catch(e){console.error("Error fetching students:",e)}},C=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/fee/heads",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();r(e)}}catch(e){console.error("Error fetching fee heads:",e)}},w=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/transport/routes",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();c(e)}}catch(e){console.error("Error fetching transport routes:",e)}},A=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/hostels",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();x(e)}}catch(e){console.error("Error fetching hostels:",e)}},k=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/discounts",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();u(e)}}catch(e){console.error("Error fetching discounts:",e)}},N=e=>{const{name:t,value:s}=e.target;g(e=>(0,l.A)((0,l.A)({},e),{},{[t]:["value","cap_amount"].includes(t)?parseFloat(s)||0:s}))},_=e=>{switch(m.applied_on){case"head":return e.name;case"transport":return e.route_name;case"hostel":return e.hostel_name;default:return""}};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Fee Discount Management"}),(0,i.jsx)("p",{children:"Create and manage student fee discounts."}),b&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:b.includes("Error")?"#ffebee":"#e8f5e8",color:b.includes("Error")?"#c62828":"#2e7d32"},children:b}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),y(!0),f(""),!m.student_id)return f("Please select a student."),void y(!1);if(!m.session_name)return f("Please select a session."),void y(!1);if(!m.reason.trim())return f("Please provide a reason for the discount."),void y(!1);if("percent"===m.discount_type&&(m.value<=0||m.value>100))return f("Percent discount must be between 1 and 100."),void y(!1);if("fixed"===m.discount_type&&m.value<=0)return f("Fixed discount amount must be greater than 0."),void y(!1);if(!m.start_date||!m.end_date)return f("Please select both start and end dates."),void y(!1);if(new Date(m.start_date)>=new Date(m.end_date))return f("End date must be after start date."),void y(!1);if("fixed"===m.discount_type&&m.cap_amount<0)return f("Cap amount cannot be negative."),void y(!1);try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/discount",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(m)}),s=await t.json();t.ok?(f("Discount created successfully!"),g({student_id:"",session_name:"",discount_type:"percent",value:0,reason:"",applied_on:"overall",target_id:"",cap_amount:0,start_date:"",end_date:""}),k()):f(s.message||"Failed to create discount")}catch(t){f("Error creating discount: "+t.message)}finally{y(!1)}},style:{marginBottom:"30px"},children:[(0,i.jsx)("h3",{children:"Create Discount"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Student:"}),(0,i.jsxs)("select",{name:"student_id",value:m.student_id,onChange:N,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Student"}),s.map(e=>(0,i.jsxs)("option",{value:e._id,children:[e.first_name," ",e.last_name," (",e.student_id,")"]},e._id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Session:"}),(0,i.jsxs)("select",{name:"session_name",value:m.session_name,onChange:N,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Session"}),e.map(e=>(0,i.jsxs)("option",{value:e.session_name,children:[e.session_name," (",e.description,")"]},e._id))]})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Discount Type:"}),(0,i.jsxs)("select",{name:"discount_type",value:m.discount_type,onChange:N,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"percent",children:"Percentage (%)"}),(0,i.jsx)("option",{value:"fixed",children:"Fixed Amount (\u20b9)"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{children:["Value ","percent"===m.discount_type?"(%)":"(\u20b9)",":"]}),(0,i.jsx)("input",{type:"number",name:"value",value:m.value,onChange:N,min:"0",max:"percent"===m.discount_type?100:void 0,step:"percent"===m.discount_type?1:.01,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),"fixed"===m.discount_type&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Cap Amount (\u20b9):"}),(0,i.jsx)("input",{type:"number",name:"cap_amount",value:m.cap_amount,onChange:N,min:"0",step:"0.01",style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Applied On:"}),(0,i.jsxs)("select",{name:"applied_on",value:m.applied_on,onChange:e=>{const t=e.target.value;g(e=>(0,l.A)((0,l.A)({},e),{},{applied_on:t,target_id:""}))},required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"overall",children:"Overall Fees"}),(0,i.jsx)("option",{value:"head",children:"Specific Fee Head"}),(0,i.jsx)("option",{value:"transport",children:"Transport"}),(0,i.jsx)("option",{value:"hostel",children:"Hostel"})]})]}),["head","transport","hostel"].includes(m.applied_on)&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{children:["Target ",m.applied_on.charAt(0).toUpperCase()+m.applied_on.slice(1),":"]}),(0,i.jsxs)("select",{name:"target_id",value:m.target_id,onChange:N,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Target"}),(()=>{switch(m.applied_on){case"head":return d;case"transport":return o;case"hostel":return p;default:return[]}})().map(e=>(0,i.jsx)("option",{value:e._id,children:_(e)},e._id))]})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("label",{children:"Reason:"}),(0,i.jsx)("textarea",{name:"reason",value:m.reason,onChange:N,placeholder:"e.g., Merit scholarship, Sibling discount, Financial aid",required:!0,rows:"3",style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Start Date:"}),(0,i.jsx)("input",{type:"date",name:"start_date",value:m.start_date,onChange:N,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"End Date:"}),(0,i.jsx)("input",{type:"date",name:"end_date",value:m.end_date,onChange:N,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),(0,i.jsx)("button",{type:"submit",disabled:j,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:j?"not-allowed":"pointer"},children:j?"Creating...":"Create Discount"})]}),(0,i.jsx)("h3",{children:"Existing Discounts"}),(0,i.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:h.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Student"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Session"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Type"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Value"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Applied On"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Reason"}),(0,i.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Status"})]})}),(0,i.jsx)("tbody",{children:h.map(e=>{var t,s;return(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:[null===(t=e.student_id)||void 0===t?void 0:t.first_name," ",null===(s=e.student_id)||void 0===s?void 0:s.last_name]}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.session_name}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:"percent"===e.discount_type?"Percent":"Fixed"}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:"percent"===e.discount_type?"".concat(e.value,"%"):"\u20b9".concat(e.value.toFixed(2))}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.applied_on.charAt(0).toUpperCase()+e.applied_on.slice(1)}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.reason}),(0,i.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,i.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",backgroundColor:"active"===e.status?"#d4edda":"#f8d7da",color:"active"===e.status?"#155724":"#721c24"},children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})})]},e._id)})})]}):(0,i.jsx)("p",{children:"No discounts found."})})]})},G=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)({subjectId:"",subjectName:"",subjectCode:"",classId:"",sessionId:"",department:"B.A",credits:1,is_elective:!1,description:""}),[d,r]=(0,n.useState)(!1),[o,c]=(0,n.useState)("");(0,n.useEffect)(()=>{p()},[]);const p=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/erp/sessions",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e)}}catch(e){console.error("Error fetching sessions:",e)}},x=e=>{const{name:t,value:s}=e.target;a(e=>(0,l.A)((0,l.A)({},e),{},{[t]:"credits"===t?parseInt(s)||1:s}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Add Subject"}),(0,i.jsx)("p",{children:"Add new subjects for different classes and departments."}),o&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:o.includes("Error")?"#ffebee":"#e8f5e8",color:o.includes("Error")?"#c62828":"#2e7d32"},children:o}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),r(!0),c("");try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/erp/subject",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(s)}),n=await t.json();t.ok?(c("Subject created successfully!"),a({subjectId:"",subjectName:"",subjectCode:"",classId:"",sessionId:"",department:"B.A",credits:1,is_elective:!1,description:""})):c(n.message||"Failed to create subject")}catch(t){c("Error creating subject: "+t.message)}finally{r(!1)}},style:{marginBottom:"30px"},children:[(0,i.jsx)("h3",{children:"Add New Subject"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Subject ID:"}),(0,i.jsx)("input",{type:"text",name:"subjectId",value:s.subjectId,onChange:x,placeholder:"e.g., SUB001",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Subject Name:"}),(0,i.jsx)("input",{type:"text",name:"subjectName",value:s.subjectName,onChange:x,placeholder:"e.g., Mathematics",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Subject Code:"}),(0,i.jsx)("input",{type:"text",name:"subjectCode",value:s.subjectCode,onChange:x,placeholder:"e.g., MATH101",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Class ID:"}),(0,i.jsx)("input",{type:"text",name:"classId",value:s.classId,onChange:x,placeholder:"e.g., Class-10, B.A-1st-Year",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Session:"}),(0,i.jsxs)("select",{name:"sessionId",value:s.sessionId,onChange:x,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"",children:"Select Session"}),e.map(e=>(0,i.jsxs)("option",{value:e.session_name,children:[e.session_name," (",e.description,")"]},e._id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Department:"}),(0,i.jsxs)("select",{name:"department",value:s.department,onChange:x,required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:"B.A",children:"B.A"}),(0,i.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,i.jsx)("option",{value:"B.Ed",children:"B.Ed"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Credits:"}),(0,i.jsx)("input",{type:"number",name:"credits",value:s.credits,onChange:x,min:"0",max:"10",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Is Elective:"}),(0,i.jsxs)("select",{name:"is_elective",value:s.is_elective,onChange:e=>a(t=>(0,l.A)((0,l.A)({},t),{},{is_elective:"true"===e.target.value})),required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"},children:[(0,i.jsx)("option",{value:!1,children:"No"}),(0,i.jsx)("option",{value:!0,children:"Yes"})]})]}),(0,i.jsxs)("div",{style:{gridColumn:"span 2"},children:[(0,i.jsx)("label",{children:"Description:"}),(0,i.jsx)("textarea",{name:"description",value:s.description,onChange:x,placeholder:"Optional description",rows:"3",style:{width:"100%",padding:"8px",marginTop:"5px"}})]})]}),(0,i.jsx)("button",{type:"submit",disabled:d,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:d?"not-allowed":"pointer"},children:d?"Creating...":"Create Subject"})]})]})},J=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)(null),[o,c]=(0,n.useState)(!1),[p,x]=(0,n.useState)(""),[h,u]=(0,n.useState)({newSemester:"",newYear:"",feeStatus:"Pending",feeAmount:"",documents:[],remarks:""}),m=e=>{const{name:t,value:s}=e.target;u(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Student Registration"}),(0,i.jsx)("p",{children:"Register existing students for new semester/year"}),p&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:p.includes("Error")?"#ffebee":"#e8f5e8",color:p.includes("Error")?"#c62828":"#2e7d32"},children:p}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("h3",{children:"Search Student"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[(0,i.jsx)("input",{type:"text",placeholder:"Search by name, email, or student ID...",value:e,onChange:e=>t(e.target.value),style:{flex:1,padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}}),(0,i.jsx)("button",{onClick:async()=>{if(e.trim()){c(!0);try{const t=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/registration/search?query=".concat(encodeURIComponent(e)),{headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok)throw new Error("Failed to search students");const n=await s.json();a(n)}catch(t){x("Error searching students: "+t.message)}finally{c(!1)}}},disabled:o,style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:o?"not-allowed":"pointer"},children:o?"Searching...":"Search"})]}),s.length>0&&(0,i.jsx)("div",{style:{maxHeight:"200px",overflowY:"auto",border:"1px solid #ddd",borderRadius:"4px"},children:s.map(e=>(0,i.jsxs)("div",{onClick:()=>r(e),style:{padding:"10px",cursor:"pointer",backgroundColor:(null===d||void 0===d?void 0:d._id)===e._id?"#e3f2fd":"white",borderBottom:"1px solid #eee"},children:[(0,i.jsxs)("strong",{children:[e.firstName," ",e.lastName]})," - ",e.email,(0,i.jsx)("br",{}),(0,i.jsxs)("small",{children:["Student ID: ",e.studentId," | Roll No: ",e.rollNo," | ",e.department," - Year ",e.year,", Sem ",e.semester]})]},e._id))})]}),d&&(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),d){c(!0);try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/registration/register",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify((0,l.A)({studentId:d._id},h))});if(!t.ok)throw new Error("Failed to register student");await t.json();x("Student registered successfully!"),r(null),u({newSemester:"",newYear:"",feeStatus:"Pending",feeAmount:"",documents:[],remarks:""})}catch(t){x("Error registering student: "+t.message)}finally{c(!1)}}},style:{border:"1px solid #ddd",padding:"20px",borderRadius:"8px"},children:[(0,i.jsx)("h3",{children:"Register Student"}),(0,i.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,i.jsx)("strong",{children:"Selected Student:"})," ",d.firstName," ",d.lastName," (",d.studentId,")"]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"New Semester:"}),(0,i.jsxs)("select",{name:"newSemester",value:h.newSemester,onChange:m,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,i.jsx)("option",{value:"",children:"Select Semester"}),(0,i.jsx)("option",{value:"1",children:"1"}),(0,i.jsx)("option",{value:"2",children:"2"}),(0,i.jsx)("option",{value:"3",children:"3"}),(0,i.jsx)("option",{value:"4",children:"4"}),(0,i.jsx)("option",{value:"5",children:"5"}),(0,i.jsx)("option",{value:"6",children:"6"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"New Year:"}),(0,i.jsxs)("select",{name:"newYear",value:h.newYear,onChange:m,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,i.jsx)("option",{value:"",children:"Select Year"}),(0,i.jsx)("option",{value:"1",children:"1"}),(0,i.jsx)("option",{value:"2",children:"2"}),(0,i.jsx)("option",{value:"3",children:"3"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Fee Status:"}),(0,i.jsxs)("select",{name:"feeStatus",value:h.feeStatus,onChange:m,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,i.jsx)("option",{value:"Paid",children:"Paid"}),(0,i.jsx)("option",{value:"Pending",children:"Pending"}),(0,i.jsx)("option",{value:"Partial",children:"Partial"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Fee Amount:"}),(0,i.jsx)("input",{type:"number",name:"feeAmount",value:h.feeAmount,onChange:m,placeholder:"Enter fee amount",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),(0,i.jsxs)("div",{style:{marginTop:"15px"},children:[(0,i.jsx)("label",{children:"Remarks:"}),(0,i.jsx)("textarea",{name:"remarks",value:h.remarks,onChange:m,placeholder:"Additional remarks...",rows:"3",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,i.jsx)("button",{type:"submit",disabled:o,style:{marginTop:"20px",padding:"10px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:o?"not-allowed":"pointer"},children:o?"Registering...":"Register Student"})]})]})},V=()=>{const[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)({firstName:"",middleName:"",lastName:"",email:"",mobileNumber:"",tempPassword:"",dateOfBirth:"",gender:"",bloodGroup:"",address:{street:"",city:"",state:"",pincode:""},guardianName:"",guardianContact:"",previousQualification:"",courseApplied:"",admissionCategory:"",documents:{marksheet:"",idProof:"",photo:""},admissionFee:"",feeStatus:"Pending",remarks:""}),o=e=>{const{name:t,value:s}=e.target;if(t.includes(".")){const[e,n]=t.split(".");r(t=>(0,l.A)((0,l.A)({},t),{},{[e]:(0,l.A)((0,l.A)({},t[e]),{},{[n]:s})}))}else if(t.startsWith("documents.")){const e=t.split(".")[1];r(t=>(0,l.A)((0,l.A)({},t),{},{documents:(0,l.A)((0,l.A)({},t.documents),{},{[e]:s})}))}else r(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"New Admission"}),(0,i.jsx)("p",{children:"Admit new students to the institution"}),s&&(0,i.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:s.includes("Error")?"#ffebee":"#e8f5e8",color:s.includes("Error")?"#c62828":"#2e7d32",whiteSpace:"pre-line"},children:s}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),t(!0),a("");try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/new-admission/admit",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(d)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to admit student")}const s=await t.json();a("Student admitted successfully! Student ID: ".concat(s.admission.studentId,", Temp Password: ").concat(s.admission.tempPassword)),r({firstName:"",middleName:"",lastName:"",email:"",mobileNumber:"",tempPassword:"",dateOfBirth:"",gender:"",bloodGroup:"",address:{street:"",city:"",state:"",pincode:""},guardianName:"",guardianContact:"",previousQualification:"",courseApplied:"",admissionCategory:"",documents:{marksheet:"",idProof:"",photo:""},admissionFee:"",feeStatus:"Pending",remarks:""})}catch(s){a("Error admitting student: "+s.message)}finally{t(!1)}},style:{maxWidth:"800px"},children:[(0,i.jsxs)("fieldset",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd"},children:[(0,i.jsx)("legend",{children:(0,i.jsx)("strong",{children:"Basic Information"})}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"First Name:"}),(0,i.jsx)("input",{type:"text",name:"firstName",value:d.firstName,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Middle Name:"}),(0,i.jsx)("input",{type:"text",name:"middleName",value:d.middleName,onChange:o,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Last Name:"}),(0,i.jsx)("input",{type:"text",name:"lastName",value:d.lastName,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginTop:"10px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Email:"}),(0,i.jsx)("input",{type:"email",name:"email",value:d.email,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Mobile Number:"}),(0,i.jsx)("input",{type:"tel",name:"mobileNumber",value:d.mobileNumber,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),(0,i.jsxs)("div",{style:{marginTop:"10px"},children:[(0,i.jsx)("label",{children:"Temporary Password:"}),(0,i.jsx)("input",{type:"password",name:"tempPassword",value:d.tempPassword,onChange:o,required:!0,placeholder:"Set temporary password for student",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),(0,i.jsxs)("fieldset",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd"},children:[(0,i.jsx)("legend",{children:(0,i.jsx)("strong",{children:"Personal Details"})}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Date of Birth:"}),(0,i.jsx)("input",{type:"date",name:"dateOfBirth",value:d.dateOfBirth,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Gender:"}),(0,i.jsxs)("select",{name:"gender",value:d.gender,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,i.jsx)("option",{value:"",children:"Select Gender"}),(0,i.jsx)("option",{value:"Male",children:"Male"}),(0,i.jsx)("option",{value:"Female",children:"Female"}),(0,i.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Blood Group:"}),(0,i.jsxs)("select",{name:"bloodGroup",value:d.bloodGroup,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,i.jsx)("option",{value:"",children:"Select Blood Group"}),(0,i.jsx)("option",{value:"A+",children:"A+"}),(0,i.jsx)("option",{value:"A-",children:"A-"}),(0,i.jsx)("option",{value:"B+",children:"B+"}),(0,i.jsx)("option",{value:"B-",children:"B-"}),(0,i.jsx)("option",{value:"AB+",children:"AB+"}),(0,i.jsx)("option",{value:"AB-",children:"AB-"}),(0,i.jsx)("option",{value:"O+",children:"O+"}),(0,i.jsx)("option",{value:"O-",children:"O-"})]})]})]}),(0,i.jsxs)("div",{style:{marginTop:"15px"},children:[(0,i.jsx)("h4",{children:"Address"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"10px"},children:[(0,i.jsx)("input",{type:"text",name:"address.street",value:d.address.street,onChange:o,placeholder:"Street Address",required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[(0,i.jsx)("input",{type:"text",name:"address.city",value:d.address.city,onChange:o,placeholder:"City",required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}}),(0,i.jsx)("input",{type:"text",name:"address.state",value:d.address.state,onChange:o,placeholder:"State",required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}}),(0,i.jsx)("input",{type:"text",name:"address.pincode",value:d.address.pincode,onChange:o,placeholder:"Pincode",required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]})]}),(0,i.jsxs)("div",{style:{marginTop:"15px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Guardian Name:"}),(0,i.jsx)("input",{type:"text",name:"guardianName",value:d.guardianName,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Guardian Contact:"}),(0,i.jsx)("input",{type:"tel",name:"guardianContact",value:d.guardianContact,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]})]}),(0,i.jsxs)("fieldset",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd"},children:[(0,i.jsx)("legend",{children:(0,i.jsx)("strong",{children:"Academic Details"})}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Previous Qualification:"}),(0,i.jsx)("input",{type:"text",name:"previousQualification",value:d.previousQualification,onChange:o,required:!0,placeholder:"e.g., 12th Standard",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Course Applied:"}),(0,i.jsxs)("select",{name:"courseApplied",value:d.courseApplied,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,i.jsx)("option",{value:"",children:"Select Course"}),(0,i.jsx)("option",{value:"B.A",children:"B.A"}),(0,i.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,i.jsx)("option",{value:"B.Ed",children:"B.Ed"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Admission Category:"}),(0,i.jsxs)("select",{name:"admissionCategory",value:d.admissionCategory,onChange:o,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,i.jsx)("option",{value:"",children:"Select Category"}),(0,i.jsx)("option",{value:"General",children:"General"}),(0,i.jsx)("option",{value:"SC",children:"SC"}),(0,i.jsx)("option",{value:"ST",children:"ST"}),(0,i.jsx)("option",{value:"OBC",children:"OBC"}),(0,i.jsx)("option",{value:"Management",children:"Management"})]})]})]})]}),(0,i.jsxs)("fieldset",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd"},children:[(0,i.jsx)("legend",{children:(0,i.jsx)("strong",{children:"Documents"})}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Marksheet Path:"}),(0,i.jsx)("input",{type:"text",name:"documents.marksheet",value:d.documents.marksheet,onChange:o,placeholder:"Upload path or URL",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"ID Proof Path:"}),(0,i.jsx)("input",{type:"text",name:"documents.idProof",value:d.documents.idProof,onChange:o,placeholder:"Upload path or URL",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Photo Path:"}),(0,i.jsx)("input",{type:"text",name:"documents.photo",value:d.documents.photo,onChange:o,placeholder:"Upload path or URL",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]})]}),(0,i.jsxs)("fieldset",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd"},children:[(0,i.jsx)("legend",{children:(0,i.jsx)("strong",{children:"Fee Details"})}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Admission Fee:"}),(0,i.jsx)("input",{type:"number",name:"admissionFee",value:d.admissionFee,onChange:o,required:!0,placeholder:"Enter admission fee",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Fee Status:"}),(0,i.jsxs)("select",{name:"feeStatus",value:d.feeStatus,onChange:o,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,i.jsx)("option",{value:"Paid",children:"Paid"}),(0,i.jsx)("option",{value:"Pending",children:"Pending"}),(0,i.jsx)("option",{value:"Partial",children:"Partial"})]})]})]}),(0,i.jsxs)("div",{style:{marginTop:"10px"},children:[(0,i.jsx)("label",{children:"Remarks:"}),(0,i.jsx)("textarea",{name:"remarks",value:d.remarks,onChange:o,placeholder:"Additional remarks...",rows:"3",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),(0,i.jsx)("button",{type:"submit",disabled:e,style:{padding:"12px 24px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:e?"not-allowed":"pointer",fontSize:"16px"},children:e?"Admitting Student...":"Admit Student"})]})]})};var Y=s(1741),Q=s(4403);const Z=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(null),[r,o]=(0,n.useState)(!1),[c,p]=(0,n.useState)(null),[x,h]=(0,n.useState)(!1),u=[{receiptNumber:"RCP1703123456789",date:"2023-12-20T10:30:00.000Z",studentId:"STU001",studentName:"John Doe",amount:2500,paymentMode:"Cash",remarks:"Partial payment for tuition fees",breakdown:[{head:"Tuition Fee",amount:2e3},{head:"Sports Fee",amount:500}],printCount:2,pdfUrl:"#"},{receiptNumber:"RCP1704123456789",date:"2023-12-21T14:15:00.000Z",studentId:"STU002",studentName:"Jane Smith",amount:1500,paymentMode:"UPI",remarks:"Exam fee payment",breakdown:[{head:"Exam Fee",amount:1500}],printCount:1,pdfUrl:"#"}],m="admin"===localStorage.getItem("role");return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Duplicate Receipt"}),(0,i.jsx)("p",{children:"Generate duplicate copies of fee receipts."}),c&&(0,i.jsx)(d.A,{message:c.message,type:c.type,onClose:()=>p(null)}),(0,i.jsxs)("div",{className:"duplicate-receipt-container",children:[(0,i.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),!e.trim())return void p({message:"Please enter a receipt number",type:"error"});h(!0);const s=u.find(t=>t.receiptNumber.includes(e)||t.studentId===e);setTimeout(()=>{h(!1),s?(a(s),o(!1),p({message:"Receipt found!",type:"success"})):p({message:"Receipt not found. Try RCP1703123456789 or STU001",type:"error"})},1e3)},className:"search-form",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Receipt Number or Student ID:"}),(0,i.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter receipt number or student ID (try RCP1703123456789 or STU001)",required:!0})]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:x,children:x?"Searching...":"Search Receipt"})]}),s&&!r&&(0,i.jsxs)("div",{className:"receipt-preview",children:[(0,i.jsx)("h3",{children:"Receipt Details"}),(0,i.jsxs)("div",{className:"receipt-info",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Receipt No:"})," ",s.receiptNumber]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Student:"})," ",s.studentName," (",s.studentId,")"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Amount:"})," \u20b9",s.amount.toLocaleString()]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Date:"})," ",new Date(s.date).toLocaleDateString()]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Print Count:"})," ",s.printCount||1]})]}),m?(0,i.jsx)("button",{className:"btn btn-secondary",onClick:async()=>{h(!0),setTimeout(()=>{h(!1);const e=(0,l.A)((0,l.A)({},s),{},{receiptNumber:"".concat(s.receiptNumber,"_DUP"),printCount:(s.printCount||1)+1});a(e),o(!0),p({message:"Duplicate receipt generated successfully!",type:"success"})},1e3)},disabled:x,children:x?"Generating...":"Generate Duplicate"}):(0,i.jsx)("p",{className:"access-denied",children:"Only admins can reprint receipts."})]})]}),r&&(0,i.jsx)(Q.A,{receipt:s,onClose:()=>o(!1),onPrint:()=>p({message:"Duplicate receipt printed!",type:"success"}),isDuplicate:!0})]})},$=e=>{let{isOpen:t,title:s,message:n,onConfirm:a,onCancel:d}=e;return t?(0,i.jsx)("div",{className:"modal-overlay",children:(0,i.jsxs)("div",{className:"confirmation-modal",children:[(0,i.jsx)("div",{className:"modal-header",children:(0,i.jsx)("h3",{children:s})}),(0,i.jsx)("div",{className:"modal-body",children:(0,i.jsx)("p",{children:n})}),(0,i.jsxs)("div",{className:"modal-footer",children:[(0,i.jsx)("button",{className:"btn btn-secondary",onClick:d,children:"Cancel"}),(0,i.jsx)("button",{className:"btn btn-danger",onClick:a,children:"Confirm"})]})]})}):null},X=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(null),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(null),[p,x]=(0,n.useState)(!1),[h,u]=(0,n.useState)(!1),m=[{receiptNumber:"RCP1703123456789",date:"2023-12-20T10:30:00.000Z",studentId:"STU001",studentName:"John Doe",amount:2500,paymentMode:"Cash",remarks:"Partial payment for tuition fees",breakdown:[{head:"Tuition Fee",amount:2e3},{head:"Sports Fee",amount:500}],printCount:2,pdfUrl:"#"},{receiptNumber:"RCP1704123456789",date:"2023-12-21T14:15:00.000Z",studentId:"STU002",studentName:"Jane Smith",amount:1500,paymentMode:"UPI",remarks:"Exam fee payment",breakdown:[{head:"Exam Fee",amount:1500}],printCount:1,pdfUrl:"#"}],g="admin"===localStorage.getItem("role");return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Cancel Receipt"}),(0,i.jsx)("p",{children:"Cancel issued fee receipts. This action cannot be undone."}),o&&(0,i.jsx)(d.A,{message:o.message,type:o.type,onClose:()=>c(null)}),!g&&(0,i.jsx)("div",{className:"warning-message",children:(0,i.jsx)("p",{children:"\u26a0\ufe0f Only administrators can cancel receipts."})}),g&&(0,i.jsxs)("div",{className:"cancel-receipt-container",children:[(0,i.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),!e.trim())return void c({message:"Please enter a receipt number",type:"error"});u(!0);const s=m.find(t=>t.receiptNumber===e);setTimeout(()=>{u(!1),s?(a(s),c({message:"Receipt found!",type:"success"})):c({message:"Receipt not found. Try RCP1703123456789",type:"error"})},1e3)},className:"search-form",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Receipt Number:"}),(0,i.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter receipt number (try RCP1703123456789)",required:!0})]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:h,children:h?"Searching...":"Search Receipt"})]}),s&&(0,i.jsxs)("div",{className:"receipt-details",children:[(0,i.jsx)("h3",{children:"Receipt Information"}),(0,i.jsxs)("div",{className:"receipt-info",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Receipt No:"})," ",s.receiptNumber]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Student:"})," ",s.studentName," (",s.studentId,")"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Amount:"})," \u20b9",s.amount.toLocaleString()]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Payment Mode:"})," ",s.paymentMode]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Date:"})," ",new Date(s.date).toLocaleDateString()]}),s.remarks&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Remarks:"})," ",s.remarks]})]}),(0,i.jsxs)("div",{className:"cancellation-form",children:[(0,i.jsx)("h3",{children:"Cancellation Details"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Reason for Cancellation (Required):"}),(0,i.jsx)("textarea",{value:r,onChange:e=>l(e.target.value),rows:"4",placeholder:"Please provide a detailed reason for cancelling this receipt...",required:!0})]}),(0,i.jsx)("div",{className:"warning-box",children:(0,i.jsxs)("p",{children:["\u26a0\ufe0f ",(0,i.jsx)("strong",{children:"Warning:"})," This action cannot be undone. The receipt will be marked as void and cannot be reprinted."]})}),(0,i.jsx)("button",{type:"button",className:"btn btn-danger",onClick:()=>{r.trim()?x(!0):c({message:"Please provide a reason for cancellation",type:"error"})},disabled:h||!r.trim(),children:h?"Cancelling...":"Cancel Receipt"})]})]})]}),(0,i.jsx)($,{isOpen:p,title:"Confirm Cancellation",message:"Are you sure you want to cancel receipt ".concat(null===s||void 0===s?void 0:s.receiptNumber,"? This action cannot be undone."),onConfirm:async()=>{x(!1),u(!0),setTimeout(()=>{u(!1),c({message:"Receipt cancelled successfully!",type:"success"}),a(null),t(""),l("")},1e3)},onCancel:()=>x(!1)})]})};var K=s(7265);const ee=()=>{const[e,t]=(0,n.useState)(null),[s,a]=(0,n.useState)(null),[r,o]=(0,n.useState)([]),[c,p]=(0,n.useState)({newHostel:"",newRoute:"",effectiveDate:""}),[x,h]=(0,n.useState)(null),[u,m]=(0,n.useState)(!1),[g,j]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t({id:"STU001",name:"John Doe",class:"10th Grade",session:"2023-2024"}),a({hostel:"Hostel A",route:"Route 1"}),o([{head:"Tuition Fee",amount:5e3,paid:3e3,balance:2e3},{head:"Library Fee",amount:500,paid:500,balance:0},{head:"Sports Fee",amount:1e3,paid:500,balance:500},{head:"Hostel Fee",amount:3e3,paid:0,balance:3e3},{head:"Transport Fee",amount:1500,paid:0,balance:1500}])},[]);const y=e=>{const{name:t,value:s}=e.target;p(e=>(0,l.A)((0,l.A)({},e),{},{[t]:s}))},b=localStorage.getItem("role"),f=["admin","transport","hostel"].includes(b);return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Change Hostel/Transport"}),(0,i.jsx)("p",{children:"Update hostel and transport assignments for students and recalculate fees."}),x&&(0,i.jsx)(d.A,{message:x.message,type:x.type,onClose:()=>h(null)}),!f&&(0,i.jsx)("div",{className:"warning-message",children:(0,i.jsx)("p",{children:"\u26a0\ufe0f You don't have permission to update hostel/transport assignments."})}),f&&(0,i.jsx)("div",{className:"change-mapping-container",children:e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"student-info",children:[(0,i.jsxs)("h3",{children:["Student: ",e.name," (",e.id,")"]}),(0,i.jsxs)("p",{children:["Class: ",e.class," | Session: ",e.session]})]}),u?(0,i.jsx)("div",{className:"loading",children:"Loading current mapping..."}):s&&(0,i.jsxs)("div",{className:"current-mapping",children:[(0,i.jsx)("h3",{children:"Current Mapping"}),(0,i.jsxs)("div",{className:"mapping-info",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Hostel:"})," ",s.hostel]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Transport Route:"})," ",s.route]})]})]}),(0,i.jsxs)("div",{className:"update-form",children:[(0,i.jsx)("h3",{children:"Update Assignment"}),(0,i.jsxs)("div",{className:"form-row",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"New Hostel:"}),(0,i.jsxs)("select",{name:"newHostel",value:c.newHostel,onChange:y,children:[(0,i.jsx)("option",{value:"",children:"Select hostel (leave unchanged)"}),["Hostel A","Hostel B","Hostel C","Hostel D"].map(e=>(0,i.jsx)("option",{value:e,children:e},e))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"New Transport Route:"}),(0,i.jsxs)("select",{name:"newRoute",value:c.newRoute,onChange:y,children:[(0,i.jsx)("option",{value:"",children:"Select route (leave unchanged)"}),["Route 1","Route 2","Route 3","Route 4","Route 5"].map(e=>(0,i.jsx)("option",{value:e,children:e},e))]})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Effective Date (Optional):"}),(0,i.jsx)("input",{type:"date",name:"effectiveDate",value:c.effectiveDate,onChange:y}),(0,i.jsx)("small",{children:"If not specified, changes take effect immediately"})]}),(0,i.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:async()=>{c.newHostel||c.newRoute?(m(!0),setTimeout(()=>{m(!1),j(!0),h({message:"Fee calculation preview ready!",type:"success"})},1e3)):h({message:"Please select at least one change (hostel or transport)",type:"error"})},disabled:u||!c.newHostel&&!c.newRoute,children:u?"Calculating...":"Preview Changes"})]}),g&&(0,i.jsxs)("div",{className:"updated-fees-preview",children:[(0,i.jsx)("h3",{children:"Updated Fee Summary"}),(0,i.jsx)(K.A,{fees:r}),(c.newHostel!==(null===s||void 0===s?void 0:s.hostel)||c.newRoute!==(null===s||void 0===s?void 0:s.route))&&(0,i.jsxs)("div",{className:"proration-info",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Proration Applied:"})," Fees have been recalculated based on the effective date."]}),c.effectiveDate&&(0,i.jsxs)("p",{children:["Changes effective from: ",new Date(c.effectiveDate).toLocaleDateString()]})]}),(0,i.jsxs)("div",{className:"action-buttons",children:[(0,i.jsx)("button",{className:"btn btn-primary",onClick:async()=>{m(!0),setTimeout(()=>{m(!1),h({message:"Hostel/Transport updated successfully!",type:"success"}),j(!1),p({newHostel:"",newRoute:"",effectiveDate:""})},1e3)},disabled:u,children:u?"Updating...":"Confirm Update"}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>j(!1),children:"Cancel"})]})]})]})})]})},te=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),[c,x]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{const e=await p.$I.getDesignations();e.success&&a(e.data)})()},[]),(0,n.useEffect)(()=>{const t=e.trim(),n=!s.some(e=>e.name.toLowerCase()===t.toLowerCase());r(t.length>0&&t.length<=50&&n)},[e,s]);return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Add Designation"}),(0,i.jsx)("p",{children:"Create new staff designations."}),(0,i.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),!d)return;x(!0);const n=await p.$I.addDesignation(e.trim());n.success?(a(e=>[...e,n.data]),o("Designation added successfully"),t("")):o(n.error||"Failed to add designation"),x(!1),setTimeout(()=>o(""),3e3)},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Designation Name:"}),(0,i.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),maxLength:50,required:!0}),e.trim()&&!d&&(0,i.jsx)("span",{style:{color:"red"},children:0===e.trim().length?"Required":e.length>50?"Max 50 chars":"Already exists"})]}),(0,i.jsx)("button",{type:"submit",disabled:!d||c,children:c?"Adding...":"Add Designation"})]}),l&&(0,i.jsx)("div",{style:{marginTop:"10px",color:l.includes("success")?"green":"red"},children:l})]})},se=()=>{const[e,t]=(0,n.useState)({fullName:"",email:"",password:"",phoneNumber:"",gender:"",dateOfBirth:"",designationId:"",department:"",subject:"",joiningDate:(new Date).toISOString().split("T")[0],address:"",staffId:"",role:"faculty"}),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)(!1),[o,c]=(0,n.useState)(""),[x,h]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{const e=await p.$I.getDesignations();e.success&&a(e.data)})()},[]),(0,n.useEffect)(()=>{const{fullName:t,email:s,password:n,phoneNumber:a,gender:d,designationId:i,department:l,subject:o,joiningDate:c,staffId:p}=e,x=!e.dateOfBirth||new Date(e.dateOfBirth)<=new Date;r(t.trim().length>0&&t.length<=100&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)&&n.trim().length>=6&&/^\d{10}$/.test(a)&&d&&i&&l.trim().length>0&&o.trim().length>0&&c&&p.trim().length>0&&x)},[e]);const u=e=>{const{name:s,value:n}=e.target;t(e=>(0,l.A)((0,l.A)({},e),{},{[s]:n}))};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Register Staff (Deprecated)"}),(0,i.jsx)("p",{children:"This component is deprecated. Use AddUser.js for staff registration."}),(0,i.jsxs)("form",{onSubmit:async n=>{var a;if(n.preventDefault(),!d)return;const i={name:e.fullName,email:e.email,password:e.password,role:e.role,designation:(null===(a=s.find(t=>t._id===e.designationId))||void 0===a?void 0:a.name)||"",department:e.department,subject:e.subject,staffId:e.staffId,phone:e.phoneNumber,address:e.address,joiningDate:e.joiningDate,qualifications:"",subjectsTaught:[]};h(!0);const r=await p.$I.registerStaff(i);h(!1),r.success?(c("Staff registered successfully"),t({fullName:"",email:"",password:"",phoneNumber:"",gender:"",dateOfBirth:"",designationId:"",department:"",subject:"",joiningDate:(new Date).toISOString().split("T")[0],address:"",staffId:"",role:"faculty"})):c(r.error||"Failed to register staff"),setTimeout(()=>c(""),3e3)},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Full Name:"}),(0,i.jsx)("input",{type:"text",name:"fullName",value:e.fullName,onChange:u,maxLength:100,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Email:"}),(0,i.jsx)("input",{type:"email",name:"email",value:e.email,onChange:u,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Phone Number:"}),(0,i.jsx)("input",{type:"text",name:"phoneNumber",value:e.phoneNumber,onChange:u,pattern:"\\d{10}",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Gender:"}),(0,i.jsxs)("select",{name:"gender",value:e.gender,onChange:u,required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select Gender"}),(0,i.jsx)("option",{value:"Male",children:"Male"}),(0,i.jsx)("option",{value:"Female",children:"Female"}),(0,i.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Date of Birth:"}),(0,i.jsx)("input",{type:"date",name:"dateOfBirth",value:e.dateOfBirth,onChange:u,max:(new Date).toISOString().split("T")[0]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Designation:"}),(0,i.jsxs)("select",{name:"designationId",value:e.designationId,onChange:u,required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select Designation"}),s.map(e=>(0,i.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Department:"}),(0,i.jsx)("input",{type:"text",name:"department",value:e.department,onChange:u,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Subject:"}),(0,i.jsx)("input",{type:"text",name:"subject",value:e.subject,onChange:u,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Password:"}),(0,i.jsx)("input",{type:"password",name:"password",value:e.password,onChange:u,minLength:6,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Joining Date:"}),(0,i.jsx)("input",{type:"date",name:"joiningDate",value:e.joiningDate,onChange:u,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Staff ID:"}),(0,i.jsx)("input",{type:"text",name:"staffId",value:e.staffId,onChange:u,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Address:"}),(0,i.jsx)("textarea",{name:"address",value:e.address,onChange:u,maxLength:250})]}),(0,i.jsx)("button",{type:"submit",disabled:!d||x,children:x?"Registering...":"Register Staff"})]}),o&&(0,i.jsx)("div",{style:{marginTop:"10px",color:o.includes("success")?"green":"red"},children:o})]})},ne=()=>{const[e,t]=(0,n.useState)((new Date).toISOString().split("T")[0]),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)({}),[o,c]=(0,n.useState)({}),[x,h]=(0,n.useState)((new Date).toISOString().split("T")[0]),[u,m]=(0,n.useState)({}),[g,j]=(0,n.useState)([]),[y,b]=(0,n.useState)(""),[f,v]=(0,n.useState)(!1),[S,C]=(0,n.useState)({}),[w,A]=(0,n.useState)(!1),[k,N]=(0,n.useState)(!1),[_,R]=(0,n.useState)([]),[D,T]=(0,n.useState)((new Date).getMonth()+1),[E,B]=(0,n.useState)((new Date).getFullYear()),[P,I]=(0,n.useState)(null),[F,q]=(0,n.useState)(!1),[L,O]=(0,n.useState)(!1),[M,U]=(0,n.useState)(!1),[z,W]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{const e=await p.EC.getStaffList();if(e.success){const t=e.data.map(e=>({id:e._id,full_name:e.name,designation_name:e.designation,department:e.department,staffId:e.staffId}));a(t)}const t=await p.EC.getLeaveRequests();t.success&&j(t.data)})()},[]);const H=(0,n.useCallback)(async()=>{if(!F){q(!0);try{const t=await p.EC.getAttendance(e);if(t.success){const n={};t.data.forEach(e=>{n[e.staffId._id]=e.status}),s.forEach(t=>{if(!n[t.id]){const s=g.find(s=>s.staffId&&s.staffId._id===t.id&&"approved"===s.status&&new Date(s.startDate)<=new Date(e)&&new Date(s.endDate)>=new Date(e));n[t.id]=s?"LEAVE":"PRESENT"}}),r(n),c((0,l.A)({},n))}}finally{q(!1)}}},[s,e,g]);(0,n.useEffect)(()=>{s.length>0&&H()},[e,s,H]);const G=(0,n.useCallback)(async()=>{if(!L){O(!0);try{const e=await p.EC.getAttendance(x);if(e.success){const t={};e.data.forEach(e=>{t[e.staffId._id]=e.status}),m(t)}}finally{O(!1)}}},[x]);(0,n.useEffect)(()=>{w&&s.length>0&&G()},[x,w,s,G]);const J=(0,n.useCallback)(async()=>{if(!M){U(!0),W("");try{const e=await p.EC.getMonthlyAttendance(D,E);e.success?R(e.data):W(e.error||"Failed to fetch monthly attendance")}catch(e){W("Network error occurred while fetching monthly attendance"),console.error("Monthly attendance fetch error:",e)}finally{U(!1)}}},[D,E]);(0,n.useEffect)(()=>{k&&s.length>0&&J()},[D,E,k,s,J]);const V=async(e,t)=>{C(t=>(0,l.A)((0,l.A)({},t),{},{[e]:!0}));(await p.EC.updateLeaveStatus(e,t)).success?(j(s=>s.map(s=>s._id===e?(0,l.A)((0,l.A)({},s),{},{status:t}):s)),b("Leave ".concat(t," successfully")),setTimeout(()=>b(""),3e3),H()):(b("Failed to update leave status"),setTimeout(()=>b(""),3e3)),C(t=>(0,l.A)((0,l.A)({},t),{},{[e]:!1}))},Y=()=>JSON.stringify(d)!==JSON.stringify(o);return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Staff Attendance"}),(0,i.jsx)("p",{children:"Manage staff attendance records."}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("button",{onClick:()=>{A(!1),N(!1)},style:{backgroundColor:w||k?"#6c757d":"#007bff",color:"white",border:"none",padding:"8px 16px",borderRadius:"5px",marginRight:"10px",cursor:"pointer"},children:"Mark Attendance"}),(0,i.jsx)("button",{onClick:()=>{A(!0),N(!1)},style:{backgroundColor:w&&!k?"#007bff":"#6c757d",color:"white",border:"none",padding:"8px 16px",borderRadius:"5px",marginRight:"10px",cursor:"pointer"},children:"View Saved Attendance"}),(0,i.jsx)("button",{onClick:()=>{A(!1),N(!0)},style:{backgroundColor:k?"#007bff":"#6c757d",color:"white",border:"none",padding:"8px 16px",borderRadius:"5px",cursor:"pointer"},children:"Monthly Attendance View"})]}),k?(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Monthly Attendance View"}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("label",{children:"Month:"}),(0,i.jsx)("select",{value:D,onChange:e=>T(parseInt(e.target.value)),style:{marginLeft:"10px",marginRight:"20px"},children:Array.from({length:12},(e,t)=>(0,i.jsx)("option",{value:t+1,children:new Date(0,t).toLocaleString("default",{month:"long"})},t+1))}),(0,i.jsx)("label",{children:"Year:"}),(0,i.jsx)("input",{type:"number",value:E,onChange:e=>B(parseInt(e.target.value)),style:{marginLeft:"10px",width:"80px"}})]}),M?(0,i.jsx)("p",{children:"Loading monthly attendance data..."}):z?(0,i.jsxs)("div",{style:{color:"red",padding:"10px",border:"1px solid red",borderRadius:"5px",backgroundColor:"#ffe6e6"},children:[(0,i.jsx)("strong",{children:"Error:"})," ",z]}):_.length>0?(0,i.jsx)("div",{style:{overflowX:"auto"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"20px"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px",position:"sticky",left:0,backgroundColor:"#f8f9fa"},children:"Staff Name"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Designation"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Department"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Staff ID"}),Array.from({length:new Date(E,D,0).getDate()},(e,t)=>(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px",minWidth:"50px"},children:t+1},t+1)),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Present"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Absent"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Leave"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:_.map(e=>{const t=e.attendance,s=Object.values(t).filter(e=>"PRESENT"===e).length,n=Object.values(t).filter(e=>"ABSENT"===e).length,a=Object.values(t).filter(e=>"LEAVE"===e).length;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",position:"sticky",left:0,backgroundColor:"#f8f9fa",fontWeight:"bold"},children:e.staff.name}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.staff.designation}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.staff.department}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.staff.staffId}),Array.from({length:new Date(E,D,0).getDate()},(e,s)=>{const n=s+1,a=t[n];return(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",textAlign:"center"},children:(0,i.jsx)("span",{style:{backgroundColor:"PRESENT"===a?"green":"LEAVE"===a?"blue":"ABSENT"===a?"red":"#f0f0f0",color:a?"white":"black",padding:"5px",borderRadius:"3px",display:"inline-block",minWidth:"40px"},children:a?a.charAt(0):"-"})},n)}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",textAlign:"center",fontWeight:"bold",color:"green"},children:s}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",textAlign:"center",fontWeight:"bold",color:"red"},children:n}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",textAlign:"center",fontWeight:"bold",color:"blue"},children:a}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",textAlign:"center"},children:(0,i.jsx)("button",{onClick:()=>I(P===e.staff._id?null:e.staff._id),style:{backgroundColor:"#007bff",color:"white",border:"none",padding:"5px 10px",borderRadius:"3px",cursor:"pointer"},children:P===e.staff._id?"Hide Report":"View Report"})})]},e.staff._id)})})]})}):(0,i.jsxs)("p",{children:["No attendance records found for ",new Date(E,D-1).toLocaleString("default",{month:"long"})," ",E]}),P&&(0,i.jsx)("div",{style:{marginTop:"30px",padding:"20px",border:"1px solid #ddd",borderRadius:"5px",backgroundColor:"#f9f9f9"},children:(()=>{const e=_.find(e=>e.staff._id===P);if(!e)return null;const t=e.attendance,s=Object.values(t).filter(e=>"PRESENT"===e).length,n=Object.values(t).filter(e=>"ABSENT"===e).length,a=Object.values(t).filter(e=>"LEAVE"===e).length;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("h4",{children:["Monthly Attendance Report for ",e.staff.name]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Staff ID:"})," ",e.staff.staffId]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Name:"})," ",e.staff.name]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Designation:"})," ",e.staff.designation]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Department:"})," ",e.staff.department]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Month:"})," ",new Date(E,D-1).toLocaleString("default",{month:"long"})," ",E]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Summary:"})," Present: ",s,", Absent: ",n,", Leave: ",a]})]}),(0,i.jsx)("div",{style:{overflowX:"auto"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Day"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Status"})]})}),(0,i.jsx)("tbody",{children:Array.from({length:new Date(E,D,0).getDate()},(e,s)=>{const n=s+1,a=t[n];return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",textAlign:"center"},children:n}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",textAlign:"center"},children:(0,i.jsx)("span",{style:{backgroundColor:"PRESENT"===a?"green":"LEAVE"===a?"blue":"ABSENT"===a?"red":"#f0f0f0",color:a?"white":"black",padding:"5px 10px",borderRadius:"3px",display:"inline-block"},children:a||"Not Marked"})})]},n)})})]})})]})})()})]}):w?(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Saved Attendance Records"}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("label",{children:"Select Date to View:"}),(0,i.jsx)("input",{type:"date",value:x,onChange:e=>h(e.target.value),style:{marginLeft:"10px"}})]}),Object.keys(u).length>0?(0,i.jsx)("div",{children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"20px"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Staff Name"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Designation"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Attendance Status"})]})}),(0,i.jsx)("tbody",{children:s.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.full_name}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.designation_name}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:(0,i.jsx)("span",{style:{backgroundColor:"PRESENT"===u[e.id]?"green":"LEAVE"===u[e.id]?"blue":"red",color:"white",padding:"5px 10px",borderRadius:"3px"},children:u[e.id]||"Not Marked"})})]},e.id))})]})}):(0,i.jsxs)("p",{children:["No attendance records found for ",x]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Date:"}),(0,i.jsx)("input",{type:"date",value:e,onChange:e=>t(e.target.value)})]}),(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"20px"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Staff Name"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Designation"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Leave Status"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Attendance Status"})]})}),(0,i.jsx)("tbody",{children:s.map(t=>{const s=g.find(s=>s.staffId&&s.staffId._id===t.id&&new Date(s.startDate)<=new Date(e)&&new Date(s.endDate)>=new Date(e));return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:t.full_name}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:t.designation_name}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:s?(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"approved"===s.status?"green":"rejected"===s.status?"red":"orange"},children:s.status}),"pending"===s.status&&(0,i.jsxs)("div",{style:{marginTop:"5px"},children:[(0,i.jsx)("button",{onClick:()=>V(s._id,"approved"),disabled:S[s._id],style:{backgroundColor:"green",color:"white",border:"none",padding:"2px 5px",marginRight:"5px",cursor:"pointer"},children:S[s._id]?"...":"Approve"}),(0,i.jsx)("button",{onClick:()=>V(s._id,"rejected"),disabled:S[s._id],style:{backgroundColor:"red",color:"white",border:"none",padding:"2px 5px",cursor:"pointer"},children:S[s._id]?"...":"Reject"})]})]}):"No leave"}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:(0,i.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,i.jsx)("button",{onClick:()=>r(e=>(0,l.A)((0,l.A)({},e),{},{[t.id]:"PRESENT"})),style:{backgroundColor:"PRESENT"===d[t.id]?"green":"#f0f0f0",color:"PRESENT"===d[t.id]?"white":"black",border:"1px solid #ccc",padding:"5px 10px",cursor:"pointer",borderRadius:"3px"},children:"PRESENT"}),(0,i.jsx)("button",{onClick:()=>r(e=>(0,l.A)((0,l.A)({},e),{},{[t.id]:"ABSENT"})),style:{backgroundColor:"ABSENT"===d[t.id]?"red":"#f0f0f0",color:"ABSENT"===d[t.id]?"white":"black",border:"1px solid #ccc",padding:"5px 10px",cursor:"pointer",borderRadius:"3px"},children:"ABSENT"}),(0,i.jsx)("button",{onClick:()=>r(e=>(0,l.A)((0,l.A)({},e),{},{[t.id]:"LEAVE"})),style:{backgroundColor:"LEAVE"===d[t.id]?"blue":"#f0f0f0",color:"LEAVE"===d[t.id]?"white":"black",border:"1px solid #ccc",padding:"5px 10px",cursor:"pointer",borderRadius:"3px"},children:"LEAVE"})]})})]},t.id)})})]}),(0,i.jsx)("button",{onClick:async()=>{v(!0);const t=Object.keys(d).map(e=>({staffId:e,status:d[e]}));(await p.EC.markAttendance(e,t)).success?(c((0,l.A)({},d)),b("Attendance saved successfully"),setTimeout(()=>b(""),3e3)):(b("Failed to save attendance"),setTimeout(()=>b(""),3e3)),v(!1)},disabled:!Y()||f,style:{marginTop:"20px",backgroundColor:Y()?"#007bff":"#6c757d",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",cursor:Y()?"pointer":"not-allowed",fontSize:"16px"},children:f?"Saving...":"Save Attendance"}),y&&(0,i.jsx)("div",{style:{marginTop:"10px",color:y.includes("success")?"green":"red"},children:y})]})]})},ae=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)(""),[l,o]=(0,n.useState)([]),[c,p]=(0,n.useState)([]),[x,h]=(0,n.useState)([]),[u,m]=(0,n.useState)([]),[g,j]=(0,n.useState)(!1),[y,b]=(0,n.useState)(""),[f,v]=(0,n.useState)(!1);(0,n.useEffect)(()=>{o([{id:1,full_name:"John Doe",designation_name:"Teacher"},{id:2,full_name:"Jane Smith",designation_name:"Professor"},{id:3,full_name:"Bob Johnson",designation_name:"Lecturer"},{id:4,full_name:"Alice Brown",designation_name:"Assistant Professor"},{id:5,full_name:"Charlie Wilson",designation_name:"Instructor"}]);p([{id:1,name:"BA"},{id:2,name:"BSC"},{id:3,name:"BED"}]);m([{id:1,staff:"John Doe",class:"BA",subject:"History"},{id:2,staff:"Jane Smith",class:"BSC",subject:"Physics"},{id:3,staff:"Bob Johnson",class:"BED",subject:"Education"}])},[]),(0,n.useEffect)(()=>{if(s){let e=[];1===s?e=[{id:1,name:"History"},{id:2,name:"Political Science"},{id:3,name:"English Literature"}]:2===s?e=[{id:1,name:"Physics"},{id:2,name:"Chemistry"},{id:3,name:"Mathematics"}]:3===s&&(e=[{id:1,name:"Education"},{id:2,name:"Psychology"},{id:3,name:"Teaching Methods"}]),h(e)}else h([]),r("")},[s]),(0,n.useEffect)(()=>{j(e&&s&&d)},[e,s,d]);return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Assign Course"}),(0,i.jsx)("p",{children:"Assign courses to staff members."}),(0,i.jsxs)("form",{onSubmit:async n=>{n.preventDefault(),g&&(v(!0),setTimeout(()=>{const n=l.find(t=>t.id===e),i=c.find(e=>e.id===s),o=x.find(e=>e.id===d),p={id:Date.now(),staff:n.full_name,class:i.name,subject:o.name};m(e=>[...e,p]),v(!1),b("Course assigned successfully"),t(""),a(""),r(""),setTimeout(()=>b(""),3e3)},1e3))},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Staff Name:"}),(0,i.jsxs)("select",{value:e,onChange:e=>t(e.target.value),required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select Staff"}),l.map(e=>(0,i.jsxs)("option",{value:e.id,children:[e.full_name," (",e.designation_name,")"]},e.id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Course:"}),(0,i.jsxs)("select",{value:s,onChange:e=>a(e.target.value),required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select Course"}),c.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Subject:"}),(0,i.jsxs)("select",{value:d,onChange:e=>r(e.target.value),required:!0,disabled:!s,children:[(0,i.jsx)("option",{value:"",children:"Select Subject"}),x.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,i.jsx)("button",{type:"submit",disabled:!g||f,children:f?"Assigning...":"Assign Course"})]}),y&&(0,i.jsx)("div",{style:{marginTop:"10px",color:y.includes("success")?"green":"red"},children:y}),(0,i.jsx)("h2",{children:"Assigned Courses"}),u.length>0?(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"20px"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Staff"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Course"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Subject"})]})}),(0,i.jsx)("tbody",{children:u.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.staff}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.class}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.subject})]},e.id))})]}):(0,i.jsx)("p",{children:"No assignments yet."})]})},de=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[d,r]=(0,n.useState)(!1),[o,c]=(0,n.useState)(""),[x,h]=(0,n.useState)("all"),[u,m]=(0,n.useState)({});(0,n.useEffect)(()=>{g()},[]),(0,n.useEffect)(()=>{j()},[e,x]);const g=async()=>{r(!0);const e=await p.EC.getLeaveRequests();e.success?t(e.data):c("Failed to fetch leave requests"),r(!1)},j=()=>{a("all"===x?e:e.filter(e=>e.status===x))},y=async(e,s)=>{m(t=>(0,l.A)((0,l.A)({},t),{},{[e]:!0}));(await p.EC.updateLeaveStatus(e,s)).success?(t(t=>t.map(t=>t._id===e?(0,l.A)((0,l.A)({},t),{},{status:s}):t)),c("Leave ".concat(s," successfully")),setTimeout(()=>c(""),3e3)):(c("Failed to update leave status"),setTimeout(()=>c(""),3e3)),m(t=>(0,l.A)((0,l.A)({},t),{},{[e]:!1}))},b=e=>{switch(e){case"approved":return"green";case"rejected":return"red";case"pending":return"orange";default:return"black"}},f={total:e.length,pending:e.filter(e=>"pending"===e.status).length,approved:e.filter(e=>"approved"===e.status).length,rejected:e.filter(e=>"rejected"===e.status).length};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Leave Management"}),(0,i.jsx)("p",{children:"Manage staff leave requests and view leave history."}),(0,i.jsxs)("div",{style:{display:"flex",gap:"20px",marginBottom:"20px"},children:[(0,i.jsxs)("div",{style:{padding:"10px",border:"1px solid #ddd",borderRadius:"5px"},children:[(0,i.jsx)("strong",{children:"Total Requests:"})," ",f.total]}),(0,i.jsxs)("div",{style:{padding:"10px",border:"1px solid #ddd",borderRadius:"5px"},children:[(0,i.jsx)("strong",{children:"Pending:"})," ",f.pending]}),(0,i.jsxs)("div",{style:{padding:"10px",border:"1px solid #ddd",borderRadius:"5px"},children:[(0,i.jsx)("strong",{children:"Approved:"})," ",f.approved]}),(0,i.jsxs)("div",{style:{padding:"10px",border:"1px solid #ddd",borderRadius:"5px"},children:[(0,i.jsx)("strong",{children:"Rejected:"})," ",f.rejected]})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("label",{children:"Filter by Status:"}),(0,i.jsxs)("select",{value:x,onChange:e=>h(e.target.value),style:{marginLeft:"10px"},children:[(0,i.jsx)("option",{value:"all",children:"All"}),(0,i.jsx)("option",{value:"pending",children:"Pending"}),(0,i.jsx)("option",{value:"approved",children:"Approved"}),(0,i.jsx)("option",{value:"rejected",children:"Rejected"})]}),(0,i.jsx)("button",{onClick:g,style:{marginLeft:"20px",padding:"5px 10px"},children:"Refresh"})]}),o&&(0,i.jsx)("div",{style:{marginBottom:"20px",color:o.includes("success")?"green":"red"},children:o}),d?(0,i.jsx)("p",{children:"Loading leave requests..."}):(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Staff Name"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Designation"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Leave Type"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Start Date"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"End Date"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Days"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Reason"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Status"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:s.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.staffId&&"object"===typeof e.staffId?e.staffId.name:"N/A"}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.staffId&&"object"===typeof e.staffId?e.staffId.designation:"N/A"}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.type}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:new Date(e.startDate).toLocaleDateString()}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:new Date(e.endDate).toLocaleDateString()}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.days}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.reason}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:(0,i.jsx)("span",{style:{color:b(e.status)},children:e.status})}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:"pending"===e.status&&(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{onClick:()=>y(e._id,"approved"),disabled:u[e._id],style:{backgroundColor:"green",color:"white",border:"none",padding:"5px 10px",marginRight:"5px",cursor:"pointer",borderRadius:"3px"},children:u[e._id]?"...":"Approve"}),(0,i.jsx)("button",{onClick:()=>y(e._id,"rejected"),disabled:u[e._id],style:{backgroundColor:"red",color:"white",border:"none",padding:"5px 10px",cursor:"pointer",borderRadius:"3px"},children:u[e._id]?"...":"Reject"})]})})]},e._id))})]}),0===s.length&&!d&&(0,i.jsx)("p",{children:"No leave requests found for the selected filter."})]})},ie=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(0),[d,r]=(0,n.useState)(""),[l,o]=(0,n.useState)(null),[c,p]=(0,n.useState)(!1),[x,h]=(0,n.useState)(null),[u,m]=(0,n.useState)([]);(0,n.useEffect)(()=>{"admin"!==localStorage.getItem("role")&&(window.location.href="/login")},[]);const g=""!==e&&s>0;return(0,i.jsx)("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:(0,i.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",backgroundColor:"white",borderRadius:"10px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",padding:"30px"},children:[(0,i.jsx)("h1",{style:{color:"#333",textAlign:"center",marginBottom:"30px",fontSize:"28px",fontWeight:"bold"},children:"Expense Entry"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"30px",flexWrap:"wrap"},children:[(0,i.jsxs)("div",{style:{flex:"1",minWidth:"300px"},children:[(0,i.jsx)("h2",{style:{color:"#555",marginBottom:"20px",fontSize:"20px",borderBottom:"2px solid #007bff",paddingBottom:"10px"},children:"Add New Expense"}),(0,i.jsxs)("form",{onSubmit:async n=>{n.preventDefault(),""===e||s<=0?j.oR.error("Please fill in all required fields."):(p(!0),setTimeout(()=>{const n={id:Date.now(),category:e,amount:s,notes:d,date:(new Date).toISOString().split("T")[0],attachment:l?l.name:null};m(e=>[...e,n]),j.oR.success("Expense recorded successfully!"),t(""),a(0),r(""),o(null),h(null),p(!1)},1e3))},style:{display:"flex",flexDirection:"column",gap:"20px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px",color:"#555"},children:"Category:"}),(0,i.jsxs)("select",{value:e,onChange:e=>t(e.target.value),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"16px"},children:[(0,i.jsx)("option",{value:"",children:"Select Category"}),(0,i.jsx)("option",{value:"Office Supplies",children:"Office Supplies"}),(0,i.jsx)("option",{value:"Travel",children:"Travel"}),(0,i.jsx)("option",{value:"Utilities",children:"Utilities"}),(0,i.jsx)("option",{value:"Maintenance",children:"Maintenance"}),(0,i.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px",color:"#555"},children:"Amount:"}),(0,i.jsx)("input",{type:"number",value:s,onChange:e=>a(parseFloat(e.target.value)||0),min:"0.01",step:"0.01",required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px",color:"#555"},children:"Notes:"}),(0,i.jsx)("textarea",{value:d,onChange:e=>r(e.target.value),placeholder:"Optional notes",style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"16px",minHeight:"80px",resize:"vertical"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px",color:"#555"},children:"Attachment:"}),(0,i.jsx)("input",{type:"file",accept:".jpg,.png,.pdf",onChange:e=>{const t=e.target.files[0];if(t&&t.type.match(/jpg|png|pdf/))if(o(t),t.type.startsWith("image/")){const e=new FileReader;e.onload=()=>h(e.result),e.readAsDataURL(t)}else h(null);else j.oR.error("Invalid file type. Only JPG, PNG, PDF allowed.")},style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"16px"}}),x&&(0,i.jsx)("img",{src:x,alt:"Preview",style:{maxWidth:"200px",marginTop:"10px",border:"1px solid #ddd",borderRadius:"5px"}})]}),(0,i.jsx)("button",{type:"submit",disabled:!g||c,style:{padding:"12px 24px",backgroundColor:g&&!c?"#28a745":"#ccc",color:"white",border:"none",borderRadius:"5px",fontSize:"16px",fontWeight:"bold",cursor:g&&!c?"pointer":"not-allowed",alignSelf:"flex-start"},children:c?"Saving...":"Save Expense"})]})]}),(0,i.jsxs)("div",{style:{flex:"1",minWidth:"300px"},children:[(0,i.jsx)("h2",{style:{color:"#555",marginBottom:"20px",fontSize:"20px",borderBottom:"2px solid #007bff",paddingBottom:"10px"},children:"Recent Expenses"}),0===u.length?(0,i.jsx)("p",{style:{textAlign:"center",color:"#666",fontSize:"16px",marginTop:"50px"},children:"No expenses recorded yet."}):(0,i.jsx)("div",{style:{maxHeight:"600px",overflowY:"auto",border:"1px solid #ddd",borderRadius:"5px"},children:u.map(e=>(0,i.jsxs)("div",{style:{padding:"15px",borderBottom:"1px solid #eee",backgroundColor:"#f8f9fa",marginBottom:"10px",borderRadius:"5px"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[(0,i.jsx)("strong",{style:{color:"#333",fontSize:"16px"},children:e.category}),(0,i.jsx)("span",{style:{fontSize:"16px",fontWeight:"bold",color:"#007bff"},children:e.amount})]}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:["Date: ",e.date]}),e.notes&&(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#555",marginBottom:"5px"},children:["Notes: ",e.notes]}),e.attachment&&(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#007bff"},children:["Attachment: ",e.attachment]})]},e.id))})]})]})]})})},re=()=>{const[e,t]=(0,n.useState)(null),[s,a]=(0,n.useState)(null),[d,r]=(0,n.useState)([]),[l,o]=(0,n.useState)(0),[c,p]=(0,n.useState)(!1);(0,n.useEffect)(()=>{"admin"!==localStorage.getItem("role")&&(window.location.href="/login")},[]);const x=e&&s&&e<=s;return(0,i.jsx)("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:(0,i.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",backgroundColor:"white",borderRadius:"10px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",padding:"30px"},children:[(0,i.jsx)("h1",{style:{color:"#333",textAlign:"center",marginBottom:"30px",fontSize:"28px",fontWeight:"bold"},children:"Expense Reports"}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"20px",marginBottom:"30px",flexWrap:"wrap"},children:[(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,i.jsx)("label",{style:{fontWeight:"bold",marginBottom:"5px",color:"#555"},children:"Start Date:"}),(0,i.jsx)("input",{type:"date",value:e||"",onChange:e=>t(e.target.value),style:{padding:"10px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"16px",width:"200px"}})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,i.jsx)("label",{style:{fontWeight:"bold",marginBottom:"5px",color:"#555"},children:"End Date:"}),(0,i.jsx)("input",{type:"date",value:s||"",onChange:e=>a(e.target.value),style:{padding:"10px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"16px",width:"200px"}})]}),(0,i.jsx)("button",{onClick:async()=>{if(!e||!s||e>s)return void j.oR.error("Please select valid start and end dates.");p(!0);const t=[{category:"Office Supplies",total:2500},{category:"Travel",total:15e3},{category:"Utilities",total:8e3},{category:"Maintenance",total:12e3},{category:"Other",total:3e3}],n=40500;setTimeout(()=>{r(t),o(n),p(!1),j.oR.success("Report generated successfully!")},1e3)},disabled:!x||c,style:{padding:"12px 24px",backgroundColor:x&&!c?"#007bff":"#ccc",color:"white",border:"none",borderRadius:"5px",fontSize:"16px",fontWeight:"bold",cursor:x&&!c?"pointer":"not-allowed",alignSelf:"flex-end"},children:c?"Generating...":"Generate Report"})]}),d.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"30px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#007bff",color:"white"},children:[(0,i.jsx)("th",{style:{padding:"15px",textAlign:"left",fontSize:"18px",fontWeight:"bold"},children:"Category"}),(0,i.jsx)("th",{style:{padding:"15px",textAlign:"right",fontSize:"18px",fontWeight:"bold"},children:"Total Amount"})]})}),(0,i.jsx)("tbody",{children:d.map((e,t)=>(0,i.jsxs)("tr",{style:{backgroundColor:t%2===0?"#f8f9fa":"white",borderBottom:"1px solid #ddd"},children:[(0,i.jsx)("td",{style:{padding:"15px",fontSize:"16px",color:"#333"},children:e.category}),(0,i.jsx)("td",{style:{padding:"15px",textAlign:"right",fontSize:"16px",fontWeight:"bold",color:"#007bff"},children:e.total})]},t))})]}),(0,i.jsx)("div",{style:{backgroundColor:"#e9ecef",padding:"20px",borderRadius:"10px",textAlign:"center",border:"2px solid #28a745"},children:(0,i.jsxs)("strong",{style:{fontSize:"24px",color:"#28a745",fontWeight:"bold"},children:["Grand Total: ",l]})})]}):!c&&(0,i.jsx)("p",{style:{textAlign:"center",fontSize:"18px",color:"#666",marginTop:"50px"},children:"No data found for the selected period."})]})})},le=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)({name:"",basePay:"",allowances:[{name:"",amount:""}],deductions:[{name:"",amount:""}],effectiveDate:""}),[d,r]=(0,n.useState)(""),[o,c]=(0,n.useState)("");(0,n.useEffect)(()=>{t([{id:1,name:"Teacher Template",basePay:3e4,allowances:[{name:"HRA",amount:5e3},{name:"Conveyance",amount:2e3}],deductions:[{name:"PF",amount:1800},{name:"Tax",amount:1500}],effectiveDate:"2024-01-01"},{id:2,name:"Clerk Template",basePay:25e3,allowances:[{name:"HRA",amount:4e3}],deductions:[{name:"PF",amount:1500}],effectiveDate:"2024-01-01"}])},[]);const p=(e,t)=>{a(s=>(0,l.A)((0,l.A)({},s),{},{[e]:t}))},x=(e,t,n)=>{const d=[...s.allowances];d[e][t]=n,a(e=>(0,l.A)((0,l.A)({},e),{},{allowances:d}))},h=(e,t,n)=>{const d=[...s.deductions];d[e][t]=n,a(e=>(0,l.A)((0,l.A)({},e),{},{deductions:d}))},u=()=>{if(!(s.name.trim()?!s.basePay||s.basePay<=0?(c("Base pay must be greater than 0"),0):!(s.deductions.reduce((e,t)=>e+(parseFloat(t.amount)||0),0)>s.basePay)||(c("Total deductions cannot exceed base pay"),0):(c("Template name is required"),0)))return;const e=(0,l.A)((0,l.A)({id:Date.now()},s),{},{basePay:parseFloat(s.basePay),allowances:s.allowances.map(e=>(0,l.A)((0,l.A)({},e),{},{amount:parseFloat(e.amount)||0})),deductions:s.deductions.map(e=>(0,l.A)((0,l.A)({},e),{},{amount:parseFloat(e.amount)||0}))});t(t=>[...t,e]),c("Template saved successfully"),setTimeout(()=>c(""),3e3),m()},m=()=>{a({name:"",basePay:"",allowances:[{name:"",amount:""}],deductions:[{name:"",amount:""}],effectiveDate:""})},g=e=>{alert("Exporting template as ".concat(e.toUpperCase()))},j=e.filter(e=>e.name.toLowerCase().includes(d.toLowerCase()));return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Salary Settings"}),(0,i.jsx)("p",{children:"Define reusable salary templates with base pay, allowances, and deductions."}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("input",{type:"text",placeholder:"Search templates...",value:d,onChange:e=>r(e.target.value),style:{padding:"8px",width:"200px",marginRight:"10px"}}),(0,i.jsx)("button",{onClick:()=>r(""),style:{padding:"8px 16px"},children:"Clear"})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h2",{children:"Create/Edit Template"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),u()},children:[(0,i.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,i.jsx)("label",{title:"Unique identifier for salary structure",children:"Template Name:"}),(0,i.jsx)("input",{type:"text",value:s.name,onChange:e=>p("name",e.target.value),required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,i.jsx)("label",{title:"Required, must be > 0",children:"Base Pay:"}),(0,i.jsx)("input",{type:"number",value:s.basePay,onChange:e=>p("basePay",e.target.value),min:"0",step:"0.01",required:!0,style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,i.jsx)("label",{children:"Allowances:"}),s.allowances.map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px"},children:[(0,i.jsx)("input",{type:"text",placeholder:"Allowance name",value:e.name,onChange:e=>x(t,"name",e.target.value),style:{flex:1,padding:"8px",marginRight:"5px"}}),(0,i.jsx)("input",{type:"number",placeholder:"Amount",value:e.amount,onChange:e=>x(t,"amount",e.target.value),min:"0",step:"0.01",style:{width:"100px",padding:"8px",marginRight:"5px"}}),(0,i.jsx)("button",{type:"button",onClick:()=>(e=>{a(t=>(0,l.A)((0,l.A)({},t),{},{allowances:t.allowances.filter((t,s)=>s!==e)}))})(t),style:{padding:"8px"},children:"Remove"})]},t)),(0,i.jsx)("button",{type:"button",onClick:()=>{a(e=>(0,l.A)((0,l.A)({},e),{},{allowances:[...e.allowances,{name:"",amount:""}]}))},style:{padding:"8px",marginTop:"5px"},children:"Add Allowance"})]}),(0,i.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,i.jsx)("label",{children:"Deductions:"}),s.deductions.map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px"},children:[(0,i.jsx)("input",{type:"text",placeholder:"Deduction name",value:e.name,onChange:e=>h(t,"name",e.target.value),style:{flex:1,padding:"8px",marginRight:"5px"}}),(0,i.jsx)("input",{type:"number",placeholder:"Amount",value:e.amount,onChange:e=>h(t,"amount",e.target.value),min:"0",step:"0.01",style:{width:"100px",padding:"8px",marginRight:"5px"}}),(0,i.jsx)("button",{type:"button",onClick:()=>(e=>{a(t=>(0,l.A)((0,l.A)({},t),{},{deductions:t.deductions.filter((t,s)=>s!==e)}))})(t),style:{padding:"8px"},children:"Remove"})]},t)),(0,i.jsx)("button",{type:"button",onClick:()=>{a(e=>(0,l.A)((0,l.A)({},e),{},{deductions:[...e.deductions,{name:"",amount:""}]}))},style:{padding:"8px",marginTop:"5px"},children:"Add Deduction"})]}),(0,i.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,i.jsx)("label",{title:"Optional, for future activation",children:"Effective Date:"}),(0,i.jsx)("input",{type:"date",value:s.effectiveDate,onChange:e=>p("effectiveDate",e.target.value),style:{width:"100%",padding:"8px",marginTop:"5px"}})]}),(0,i.jsxs)("div",{style:{marginTop:"20px"},children:[(0,i.jsx)("button",{type:"submit",style:{padding:"10px 20px",marginRight:"10px"},children:"Save Template"}),(0,i.jsx)("button",{type:"button",onClick:m,style:{padding:"10px 20px",marginRight:"10px"},children:"Reset"}),(0,i.jsx)("button",{type:"button",onClick:()=>g("excel"),style:{padding:"10px 20px",marginRight:"10px"},children:"Export as Excel"}),(0,i.jsx)("button",{type:"button",onClick:()=>g("pdf"),style:{padding:"10px 20px"},children:"Export as PDF"})]})]}),o&&(0,i.jsx)("div",{style:{marginTop:"10px",color:o.includes("success")?"green":"red"},children:o})]}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h2",{children:"Existing Templates"}),0===j.length?(0,i.jsx)("p",{children:"No templates found."}):(0,i.jsx)("ul",{style:{listStyle:"none",padding:0},children:j.map(e=>(0,i.jsxs)("li",{style:{border:"1px solid #ddd",padding:"10px",marginBottom:"10px"},children:[(0,i.jsx)("h3",{children:e.name}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Base Pay:"})," \u20b9",e.basePay]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Allowances:"})," ",e.allowances.map(e=>"".concat(e.name,": \u20b9").concat(e.amount)).join(", ")]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Deductions:"})," ",e.deductions.map(e=>"".concat(e.name,": \u20b9").concat(e.amount)).join(", ")]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Effective Date:"})," ",e.effectiveDate||"N/A"]})]},e.id))})]})]})]})},oe=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)([]),[l,o]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[x,h]=(0,n.useState)(null),[u,m]=(0,n.useState)(""),[g,j]=(0,n.useState)(!1),[y,b]=(0,n.useState)("");(0,n.useEffect)(()=>{r([{id:1,full_name:"John Doe",designation_name:"Teacher"},{id:2,full_name:"Jane Smith",designation_name:"Principal"},{id:3,full_name:"Bob Johnson",designation_name:"Clerk"},{id:4,full_name:"Alice Brown",designation_name:"Librarian"},{id:5,full_name:"Charlie Wilson",designation_name:"Peon"}])},[]);const f={basePay:3e4,allowances:[{name:"HRA",amount:5e3},{name:"Conveyance",amount:2e3}],deductions:[{name:"PF",amount:1800},{name:"Tax",amount:1500}]},v=(e,t)=>{o([{date:"2024-10-01",status:"Present"},{date:"2024-10-02",status:"Present"},{date:"2024-10-03",status:"Absent"},{date:"2024-10-04",status:"Present"}]);const s=f.allowances.reduce((e,t)=>e+t.amount,0),n=f.deductions.reduce((e,t)=>e+t.amount,0),a=f.basePay+s-n;p("Base: \u20b9".concat(f.basePay," + Allowances: \u20b9").concat(s," - Deductions: \u20b9").concat(n," = Net: \u20b9").concat(a))},S=()=>{e&&s?(j(!0),setTimeout(()=>{const e=(()=>{const e=l.filter(e=>"Present"===e.status).length,t=l.length,s=e/t*100,n=f.allowances.reduce((e,t)=>e+t.amount,0),a=f.deductions.reduce((e,t)=>e+t.amount,0),d=f.basePay+n,i=d-a;return{basePay:f.basePay,allowances:n,deductions:a,grossSalary:d,netSalary:i,presentDays:e,totalDays:t,attendancePercentage:s.toFixed(2)}})();h(e),m("Salary generated successfully"),setTimeout(()=>m(""),3e3),j(!1)},1e3)):m("Please select both month and staff")},C=()=>{if(!l.length)return"";const e=l.filter(e=>"Absent"===e.status).length;return e>0?"Attendance missing for ".concat(e," days"):"All attendance data available"};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Generate Salary"}),(0,i.jsx)("p",{children:"Calculate monthly salary for staff using attendance and salary template."}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("label",{title:"Required",children:"Select Month:"}),(0,i.jsx)("input",{type:"month",value:e,onChange:e=>{return n=e.target.value,t(n),void(s&&v());var n},style:{marginLeft:"10px",padding:"8px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("label",{title:"Searchable, shows staff list",children:"Select Staff:"}),(0,i.jsxs)("select",{value:s,onChange:t=>{return s=t.target.value,a(s),void(e&&v());var s},style:{marginLeft:"10px",padding:"8px",width:"200px"},children:[(0,i.jsx)("option",{value:"",children:"Select Staff"}),d.map(e=>(0,i.jsxs)("option",{value:e.id,children:[e.full_name," - ",e.designation_name]},e.id))]})]}),l.length>0&&(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("h3",{children:"Attendance Summary"}),(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Date"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Status"})]})}),(0,i.jsx)("tbody",{children:l.map((e,t)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.date}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.status})]},t))})]})]}),c&&(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("h3",{children:"Salary Formula"}),(0,i.jsx)("p",{title:"Shows applied formula",children:c})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("label",{title:"Optional, for future activation",children:"Effective Date:"}),(0,i.jsx)("input",{type:"date",value:y,onChange:e=>b(e.target.value),style:{marginLeft:"10px",padding:"8px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("button",{onClick:S,disabled:g,style:{padding:"10px 20px",marginRight:"10px"},children:g?"Generating...":"Generate Salary"}),x&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>{S()},style:{padding:"10px 20px",marginRight:"10px"},children:"Recalculate"}),(0,i.jsx)("button",{onClick:()=>{alert("Exporting salary record as ".concat("excel".toUpperCase()))},style:{padding:"10px 20px",marginRight:"10px"},children:"Export as Excel"})]})]}),C()&&(0,i.jsxs)("div",{style:{marginBottom:"20px",color:C().includes("missing")?"red":"green"},children:[(0,i.jsx)("strong",{children:"Validation Summary:"})," ",C()]}),x&&(0,i.jsxs)("div",{style:{marginTop:"20px",border:"1px solid #ddd",padding:"20px"},children:[(0,i.jsx)("h3",{children:"Generated Salary Details"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Base Pay:"})," \u20b9",x.basePay]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Allowances:"})," \u20b9",x.allowances]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Deductions:"})," \u20b9",x.deductions]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Gross Salary:"})," \u20b9",x.grossSalary]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Net Salary:"})," \u20b9",x.netSalary]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Attendance:"})," ",x.presentDays,"/",x.totalDays," days (",x.attendancePercentage,"%)"]})]}),u&&(0,i.jsx)("div",{style:{marginTop:"10px",color:u.includes("success")?"green":"red"},children:u})]})},ce=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)([]),[l,o]=(0,n.useState)(null),[c,p]=(0,n.useState)(""),[x,h]=(0,n.useState)(!1),[u,m]=(0,n.useState)(""),[g,j]=(0,n.useState)(!1),[y,b]=(0,n.useState)("");(0,n.useEffect)(()=>{r([{id:1,full_name:"John Doe",designation_name:"Teacher"},{id:2,full_name:"Jane Smith",designation_name:"Principal"},{id:3,full_name:"Bob Johnson",designation_name:"Clerk"},{id:4,full_name:"Alice Brown",designation_name:"Librarian"},{id:5,full_name:"Charlie Wilson",designation_name:"Peon"}])},[]);const f={staffName:"John Doe",designation:"Teacher",month:"October 2024",basePay:3e4,allowances:[{name:"HRA",amount:5e3},{name:"Conveyance",amount:2e3}],deductions:[{name:"PF",amount:1800},{name:"Tax",amount:1500}],grossSalary:37e3,totalDeductions:3300,netSalary:33700,attendance:{present:28,total:30}},v=d.filter(e=>e.full_name.toLowerCase().includes(u.toLowerCase())||e.designation_name.toLowerCase().includes(u.toLowerCase())),S=()=>(0,i.jsxs)("div",{style:{border:"1px solid #ddd",padding:"20px",backgroundColor:"#f9f9f9"},children:[(0,i.jsx)("h3",{style:{textAlign:"center"},children:"College Name"}),(0,i.jsxs)("h4",{style:{textAlign:"center"},children:["Payslip for ",l.month]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"20px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Employee Name:"})," ",l.staffName]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Designation:"})," ",l.designation]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Month:"})," ",l.month]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Attendance:"})," ",l.attendance.present,"/",l.attendance.total," days"]})]})]}),(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"20px"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px",backgroundColor:"#e9ecef"},children:"Earnings"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px",backgroundColor:"#e9ecef"},children:"Amount (\u20b9)"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px",backgroundColor:"#e9ecef"},children:"Deductions"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px",backgroundColor:"#e9ecef"},children:"Amount (\u20b9)"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:"Basic Pay"}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:l.basePay}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:l.deductions[0].name}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:l.deductions[0].amount})]}),l.allowances.map((e,t)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.name}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.amount}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:l.deductions[t+1]?l.deductions[t+1].name:""}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:l.deductions[t+1]?l.deductions[t+1].amount:""})]},t)),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",fontWeight:"bold"},children:"Gross Salary"}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",fontWeight:"bold"},children:l.grossSalary}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",fontWeight:"bold"},children:"Total Deductions"}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",fontWeight:"bold"},children:l.totalDeductions})]})]})]}),(0,i.jsx)("div",{style:{textAlign:"center",marginBottom:"20px"},children:(0,i.jsxs)("h3",{children:["Net Salary: \u20b9",l.netSalary]})}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)("div",{children:(0,i.jsx)("p",{children:"Employee Signature: ____________________"})}),(0,i.jsx)("div",{children:(0,i.jsx)("p",{children:"Principal/Accountant Signature: ____________________"})})]})]});return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Generate Payslip"}),(0,i.jsx)("p",{children:"Create downloadable payslip PDF for selected staff and month."}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("button",{onClick:()=>j(!1),style:{padding:"8px 16px",marginRight:"10px",backgroundColor:g?"#6c757d":"#007bff",color:"white",border:"none"},children:"Single Payslip"}),(0,i.jsx)("button",{onClick:()=>j(!0),style:{padding:"8px 16px",backgroundColor:g?"#007bff":"#6c757d",color:"white",border:"none"},children:"Bulk Export"})]}),g?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("label",{title:"Required for bulk export",children:"Select Month for Bulk Export:"}),(0,i.jsx)("input",{type:"month",value:y,onChange:e=>b(e.target.value),style:{marginLeft:"10px",padding:"8px"}})]}),(0,i.jsx)("div",{style:{marginBottom:"20px"},children:(0,i.jsx)("button",{onClick:()=>{y?alert("Bulk exporting payslips for ".concat(y)):p("Please select a month for bulk export")},style:{padding:"10px 20px"},children:"Bulk Export Payslips"})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("label",{title:"Searchable",children:"Select Staff:"}),(0,i.jsx)("input",{type:"text",placeholder:"Search staff...",value:u,onChange:e=>m(e.target.value),style:{marginLeft:"10px",padding:"8px",width:"200px"}}),(0,i.jsxs)("select",{value:e,onChange:e=>t(e.target.value),style:{marginLeft:"10px",padding:"8px",width:"200px"},children:[(0,i.jsx)("option",{value:"",children:"Select Staff"}),v.map(e=>(0,i.jsxs)("option",{value:e.id,children:[e.full_name," - ",e.designation_name]},e.id))]})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("label",{title:"Required",children:"Select Month:"}),(0,i.jsx)("input",{type:"month",value:s,onChange:e=>a(e.target.value),style:{marginLeft:"10px",padding:"8px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("button",{onClick:()=>{e&&s?(h(!0),setTimeout(()=>{o(f),p("Payslip generated successfully"),setTimeout(()=>p(""),3e3),h(!1)},1e3)):p("Please select both staff and month")},disabled:x,style:{padding:"10px 20px",marginRight:"10px"},children:x?"Generating...":"Generate Payslip"}),l&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>{alert("Downloading payslip as PDF")},style:{padding:"10px 20px",marginRight:"10px"},children:"Download PDF"}),(0,i.jsx)("button",{onClick:()=>{alert("Printing payslip")},style:{padding:"10px 20px"},children:"Print"})]})]})]}),l&&!g&&(0,i.jsxs)("div",{style:{marginTop:"20px"},children:[(0,i.jsx)("h3",{children:"Preview Payslip"}),(0,i.jsx)(S,{})]}),c&&(0,i.jsx)("div",{style:{marginTop:"10px",color:c.includes("success")?"green":"red"},children:c})]})},pe=()=>{const[e,t]=(0,n.useState)("Student"),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)(""),[l,o]=(0,n.useState)(""),[c,p]=(0,n.useState)(null),[x,h]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),g={S001:{name:"John Doe",department:"Computer Science",photo:"https://via.placeholder.com/150"},T001:{name:"Jane Smith",department:"Mathematics",photo:"https://via.placeholder.com/150"}};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Print ID Card"}),(0,i.jsxs)("form",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"idcard-user-type",children:"User Type"}),(0,i.jsxs)("select",{id:"idcard-user-type",value:e,onChange:e=>t(e.target.value),children:[(0,i.jsx)("option",{value:"Student",children:"Student"}),(0,i.jsx)("option",{value:"Staff",children:"Staff"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"idcard-user-id",children:"User ID"}),(0,i.jsx)("input",{id:"idcard-user-id",type:"text",value:s,onChange:e=>{const t=e.target.value;a(t),g[t]?(r(g[t].name),o(g[t].department),p(g[t].photo)):(r(""),o(""),p(null))},placeholder:"Enter ID",title:"Enter User ID to auto-fetch details"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"idcard-name",children:"Name"}),(0,i.jsx)("input",{id:"idcard-name",type:"text",value:d,readOnly:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"idcard-department",children:"Department"}),(0,i.jsx)("input",{id:"idcard-department",type:"text",value:l,readOnly:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"idcard-photo",children:"Photo Upload"}),(0,i.jsx)("input",{id:"idcard-photo",type:"file",accept:"image/*",onChange:e=>p(URL.createObjectURL(e.target.files[0])),title:"Upload passport-size photo"})]}),(0,i.jsx)("div",{children:(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:x,onChange:e=>h(e.target.checked)}),"Include Signature Block"]})}),(0,i.jsx)("button",{type:"button",onClick:()=>{m(!0)},children:"Generate"}),u&&(0,i.jsxs)("div",{className:"id-card-preview",children:[(0,i.jsx)("h2",{children:"ID Card Preview"}),c&&(0,i.jsx)("img",{src:c,alt:"Photo",width:"100"}),(0,i.jsxs)("p",{children:["Name: ",d]}),(0,i.jsxs)("p",{children:["Department: ",l]}),(0,i.jsxs)("p",{children:["QR Code: [Mock QR - ",s,"-",d,"]"]}),x&&(0,i.jsx)("p",{children:"Signature: ____________________"}),(0,i.jsx)("button",{onClick:()=>{alert("PDF download simulated")},children:"Download"}),(0,i.jsx)("button",{onClick:()=>{window.print()},children:"Print"})]})]})]})},xe=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)(""),[l,o]=(0,n.useState)([]),[c,p]=(0,n.useState)([]),[x,h]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),g=[{name:"Midterm Exam",date:"2023-10-15"},{name:"Final Exam",date:"2023-12-20"}],j=[{id:"S001",name:"John Doe",course:"CS"},{id:"S002",name:"Jane Smith",course:"Math"}];return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Generate Admit Card"}),(0,i.jsxs)("form",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"admitcard-exam-select",children:"Exam Name"}),(0,i.jsxs)("select",{id:"admitcard-exam-select",value:e,onChange:e=>{const s=e.target.value;t(s);const n=g.find(e=>e.name===s);n&&(a(n.date),o(j.filter(e=>!d||e.course===d)))},children:[(0,i.jsx)("option",{value:"",children:"Select Exam"}),g.map(e=>(0,i.jsx)("option",{value:e.name,children:e.name},e.name))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"admitcard-exam-date",children:"Exam Date"}),(0,i.jsx)("input",{id:"admitcard-exam-date",type:"date",value:s,readOnly:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"admitcard-course-branch",children:"Course/Branch"}),(0,i.jsxs)("select",{id:"admitcard-course-branch",value:d,onChange:e=>r(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"All"}),(0,i.jsx)("option",{value:"CS",children:"Computer Science"}),(0,i.jsx)("option",{value:"Math",children:"Mathematics"})]})]}),(0,i.jsx)("div",{children:(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",onChange:e=>{e.target.checked?p(l.map(e=>e.id)):p([])}}),"Select All"]})}),(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Select"}),(0,i.jsx)("th",{children:"ID"}),(0,i.jsx)("th",{children:"Name"}),(0,i.jsx)("th",{children:"Course"})]})}),(0,i.jsx)("tbody",{children:l.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("input",{type:"checkbox",checked:c.includes(e.id),onChange:()=>{return t=e.id,void p(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t}})}),(0,i.jsx)("td",{children:e.id}),(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{children:e.course})]},e.id))})]}),(0,i.jsx)("div",{children:(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:x,onChange:e=>h(e.target.checked)}),"Include Signature Block"]})}),(0,i.jsx)("button",{type:"button",onClick:()=>{m(!0)},children:"Generate"}),(0,i.jsx)("button",{type:"button",onClick:()=>{alert("Bulk PDF download simulated")},children:"Download All"}),u&&(0,i.jsxs)("div",{className:"admit-card-preview",children:[(0,i.jsx)("h2",{children:"Admit Card Preview"}),c.map(t=>{const n=l.find(e=>e.id===t);return(0,i.jsxs)("div",{className:"admit-card",children:[(0,i.jsxs)("p",{children:["Student ID: ",n.id]}),(0,i.jsxs)("p",{children:["Name: ",n.name]}),(0,i.jsxs)("p",{children:["Exam: ",e]}),(0,i.jsxs)("p",{children:["Date: ",s]}),(0,i.jsxs)("p",{children:["QR Code: [Mock QR - ",n.id,"-",e,"]"]}),x&&(0,i.jsx)("p",{children:"Signature: ____________________"})]},t)})]})]})]})},he=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)(""),[l,o]=(0,n.useState)(!1),[c,p]=(0,n.useState)(!1),x={S001:{name:"John Doe",exam:"Midterm Exam"},S002:{name:"Jane Smith",exam:"Final Exam"}};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Print Admit Card"}),(0,i.jsxs)("form",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"print-admit-student-id",children:"Student ID"}),(0,i.jsx)("input",{id:"print-admit-student-id",type:"text",value:e,onChange:e=>{const s=e.target.value;t(s),x[s]?(a(x[s].name),r(x[s].exam),p(!0)):(a(""),r(""),p(!1))},placeholder:"Enter Student ID"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"print-admit-name",children:"Name"}),(0,i.jsx)("input",{id:"print-admit-name",type:"text",value:s,readOnly:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"print-admit-exam",children:"Exam Name"}),(0,i.jsx)("input",{id:"print-admit-exam",type:"text",value:d,readOnly:!0})]}),(0,i.jsx)("div",{children:(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:l,onChange:e=>o(e.target.checked)}),"Include Signature Block"]})}),c&&(0,i.jsxs)("div",{className:"admit-card-preview",children:[(0,i.jsx)("h2",{children:"Admit Card Preview"}),(0,i.jsxs)("p",{children:["Student ID: ",e]}),(0,i.jsxs)("p",{children:["Name: ",s]}),(0,i.jsxs)("p",{children:["Exam: ",d]}),(0,i.jsxs)("p",{children:["QR Code: [Mock QR - ",e,"-",d,"]"]}),l&&(0,i.jsx)("p",{children:"Signature: ____________________"}),(0,i.jsx)("button",{onClick:()=>{alert("PDF download simulated")},children:"Download"}),(0,i.jsx)("button",{onClick:()=>{window.print()},children:"Print"})]})]})]})},ue=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(""),[d,r]=(0,n.useState)(""),[l,o]=(0,n.useState)(""),[c,p]=(0,n.useState)(""),[x,h]=(0,n.useState)(""),u={"Center A":"123 Main St, City","Center B":"456 Elm St, City"};return(0,i.jsxs)("div",{className:"menu-content",children:[(0,i.jsx)("h1",{children:"Assign Examination Center"}),(0,i.jsxs)("form",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"center-assign-student-id",children:"Student ID"}),(0,i.jsx)("input",{id:"center-assign-student-id",type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter Student ID"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"center-assign-exam",children:"Exam Name"}),(0,i.jsxs)("select",{id:"center-assign-exam",value:s,onChange:e=>a(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"Select Exam"}),["Midterm Exam","Final Exam"].map(e=>(0,i.jsx)("option",{value:e,children:e},e))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"center-assign-center",children:"Center Name"}),(0,i.jsxs)("select",{id:"center-assign-center",value:d,onChange:e=>{const t=e.target.value;r(t),o(u[t]||"")},children:[(0,i.jsx)("option",{value:"",children:"Select Center"}),Object.keys(u).map(e=>(0,i.jsx)("option",{value:e,children:e},e))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"center-assign-address",children:"Center Address"}),(0,i.jsx)("input",{id:"center-assign-address",type:"text",value:l,readOnly:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"center-assign-room",children:"Room No"}),(0,i.jsx)("input",{id:"center-assign-room",type:"text",value:c,onChange:e=>p(e.target.value),placeholder:"Optional"})]}),(0,i.jsx)("button",{type:"button",onClick:()=>{h("Mapping saved for Student ".concat(e," to ").concat(d))},children:"Save"}),x&&(0,i.jsx)("p",{children:x})]})]})},me=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[d,r]=(0,n.useState)(null),[l,o]=(0,n.useState)(1);(0,n.useEffect)(()=>{(async()=>{try{const e=await fetch("http://localhost:5000/api/admission-query");if(!e.ok)throw new Error("Failed to fetch queries");const s=await e.json();t(s)}catch(e){r(e.message)}finally{a(!1)}})()},[]);const c=Math.ceil(e.length/10),p=e.slice(10*(l-1),10*l);return s?(0,i.jsx)("div",{children:"Loading..."}):d?(0,i.jsxs)("div",{children:["Error: ",d]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{children:"Admission Queries"}),(0,i.jsx)("button",{onClick:()=>{const t=[["Name","Email","Phone","Location","Pincode","Course","Message","Status","Date"].join(","),...e.map(e=>{const t=new Date(e.createdAt).toLocaleDateString("en-GB"),s=e=>'"'.concat(e.replace(/"/g,'""'),'"'),n=e.phone.replace(/"/g,'""');return[s(e.name),s(e.email),"\"'".concat(n,"'\""),s(e.location),s(e.pincode),s(e.course),s(e.message),s(e.status),'"'.concat(t,'"')].join(",")})].join("\n"),s=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),n=window.URL.createObjectURL(s),a=document.createElement("a");a.href=n,a.download="admission_queries.csv",a.click(),window.URL.revokeObjectURL(n)},style:{marginBottom:"10px"},children:"Export to CSV"}),0===e.length?(0,i.jsx)("p",{children:"No admission queries found."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Name"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Email"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Phone"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Location"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Pincode"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Course"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Message"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Status"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Date"})]})}),(0,i.jsx)("tbody",{children:p.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.name}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.email}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.phone}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.location}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.pincode}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.course}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.message}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.status}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:new Date(e.createdAt).toLocaleDateString()})]},e._id))})]}),(0,i.jsxs)("div",{style:{marginTop:"10px"},children:[(0,i.jsx)("button",{onClick:()=>o(Math.max(1,l-1)),disabled:1===l,children:"Previous"}),(0,i.jsxs)("span",{children:[" Page ",l," of ",c," "]}),(0,i.jsx)("button",{onClick:()=>o(Math.min(c,l+1)),disabled:l===c,children:"Next"})]})]})]})},ge=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[d,r]=(0,n.useState)(null),[l,o]=(0,n.useState)(1);(0,n.useEffect)(()=>{(async()=>{try{const e=await fetch("http://localhost:5000/api/contact");if(!e.ok)throw new Error("Failed to fetch contacts");const s=await e.json();t(s)}catch(e){r(e.message)}finally{a(!1)}})()},[]);const c=Math.ceil(e.length/10),p=e.slice(10*(l-1),10*l);return s?(0,i.jsx)("div",{children:"Loading..."}):d?(0,i.jsxs)("div",{children:["Error: ",d]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{children:"Contact Us Queries"}),(0,i.jsx)("button",{onClick:()=>{const t=[["Name","Email","Phone","Location","Subject","Message","Status","Date"].join(","),...e.map(e=>{const t=new Date(e.createdAt).toLocaleDateString("en-GB"),s=e=>'"'.concat(e.replace(/"/g,'""'),'"'),n=e.phone.replace(/"/g,'""');return[s(e.name),s(e.email),"\"'".concat(n,"'\""),s(e.location),s(e.subject),s(e.message),s(e.status),'"'.concat(t,'"')].join(",")})].join("\n"),s=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),n=window.URL.createObjectURL(s),a=document.createElement("a");a.href=n,a.download="contact_queries.csv",a.click(),window.URL.revokeObjectURL(n)},style:{marginBottom:"10px"},children:"Export to CSV"}),0===e.length?(0,i.jsx)("p",{children:"No contact queries found."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Name"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Email"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Phone"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Location"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Subject"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Message"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Status"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Date"})]})}),(0,i.jsx)("tbody",{children:p.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.name}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.email}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.phone}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.location}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.subject}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.message}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.status}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:new Date(e.createdAt).toLocaleDateString()})]},e._id))})]}),(0,i.jsxs)("div",{style:{marginTop:"10px"},children:[(0,i.jsx)("button",{onClick:()=>o(Math.max(1,l-1)),disabled:1===l,children:"Previous"}),(0,i.jsxs)("span",{children:[" Page ",l," of ",c," "]}),(0,i.jsx)("button",{onClick:()=>o(Math.min(c,l+1)),disabled:l===c,children:"Next"})]})]})]})},je=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[d,r]=(0,n.useState)(null),[l,o]=(0,n.useState)(1);(0,n.useEffect)(()=>{(async()=>{try{const e=await fetch("http://localhost:5000/api/ncc-query");if(!e.ok)throw new Error("Failed to fetch queries");const s=await e.json();t(s)}catch(e){r(e.message)}finally{a(!1)}})()},[]);const c=Math.ceil(e.length/10),p=e.slice(10*(l-1),10*l);return s?(0,i.jsx)("div",{children:"Loading..."}):d?(0,i.jsxs)("div",{children:["Error: ",d]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{children:"NCC Queries"}),(0,i.jsx)("button",{onClick:()=>{const t=[["Student Name","Email","Phone","Course","Reason","Status","Date"].join(","),...e.map(e=>{const t=new Date(e.createdAt).toLocaleDateString("en-GB"),s=e=>'"'.concat(e.replace(/"/g,'""'),'"'),n=e.phone.replace(/"/g,'""');return[s(e.studentName),s(e.email),"\"'".concat(n,"'\""),s(e.course),s(e.reason),s(e.status),'"'.concat(t,'"')].join(",")})].join("\n"),s=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),n=window.URL.createObjectURL(s),a=document.createElement("a");a.href=n,a.download="ncc_queries.csv",a.click(),window.URL.revokeObjectURL(n)},style:{marginBottom:"10px"},children:"Export to CSV"}),0===e.length?(0,i.jsx)("p",{children:"No NCC queries found."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Student Name"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Email"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Phone"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Course"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Reason"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Status"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px"},children:"Date"})]})}),(0,i.jsx)("tbody",{children:p.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.studentName}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.email}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.phone}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.course}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.reason}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.status}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:new Date(e.createdAt).toLocaleDateString()})]},e._id))})]}),(0,i.jsxs)("div",{style:{marginTop:"10px"},children:[(0,i.jsx)("button",{onClick:()=>o(Math.max(1,l-1)),disabled:1===l,children:"Previous"}),(0,i.jsxs)("span",{children:[" Page ",l," of ",c," "]}),(0,i.jsx)("button",{onClick:()=>o(Math.min(c,l+1)),disabled:l===c,children:"Next"})]})]})]})};s(1627);const ye=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[d,r]=(0,n.useState)("");(0,n.useEffect)(()=>{l()},[d]);const l=async()=>{try{const e=localStorage.getItem("token"),s=d?"/api/users/documents?course=".concat(encodeURIComponent(d)):"/api/users/documents",n=await fetch(s,{headers:{Authorization:"Bearer ".concat(e)}});if(n.ok){const e=await n.json();t(e.students)}else alert("Failed to fetch documents")}catch(e){console.error("Fetch error:",e),alert("Failed to fetch documents")}finally{a(!1)}};return s?(0,i.jsx)("div",{children:"Loading documents..."}):(0,i.jsxs)("div",{className:"view-documents",children:[(0,i.jsx)("h2",{children:"View All Student Documents"}),(0,i.jsxs)("div",{className:"course-filter",children:[(0,i.jsx)("label",{htmlFor:"course-select",children:"Select Course: "}),(0,i.jsxs)("select",{id:"course-select",value:d,onChange:e=>r(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"All Courses"}),["B.A","B.Sc","B.Ed"].map(e=>(0,i.jsx)("option",{value:e,children:e},e))]})]}),e.map(e=>(0,i.jsxs)("div",{className:"student-documents",children:[(0,i.jsxs)("h3",{children:[e.studentName," (ID: ",e.studentId,") - Course: ",e.course]}),(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Document Type"}),(0,i.jsx)("th",{children:"Status"}),(0,i.jsx)("th",{children:"Action"})]})}),(0,i.jsx)("tbody",{children:e.documents.map((t,s)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:t.type}),(0,i.jsx)("td",{children:t.status}),(0,i.jsx)("td",{children:t.fileName?(0,i.jsx)("button",{onClick:()=>(async(e,t)=>{try{const s=localStorage.getItem("token"),n=await fetch("/api/users/documents/download/".concat(e,"/").concat(encodeURIComponent(t)),{headers:{Authorization:"Bearer ".concat(s)}});if(n.ok){const e=await n.blob(),s=window.URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=t,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s),document.body.removeChild(a)}else alert("Download failed")}catch(s){console.error("Download error:",s),alert("Download failed")}})(e.studentId,t.type),children:"Download"}):(0,i.jsx)("span",{children:"Not Uploaded"})})]},s))})]})]},e.studentId))]})},be=()=>{const[e,t]=(0,n.useState)([{studentId:"STU001",studentName:"John Doe",documents:[{type:"12th (Intermediate) Marksheet",status:"Pending",fileName:"12th_marksheet.pdf"},{type:"Character Certificate",status:"Pending",fileName:"character_certificate.pdf"},{type:"Domicile Certificate",status:"Pending",fileName:"domicile_certificate.pdf"},{type:"Recent passport size photographs",status:"Pending",fileName:"passport_photo.jpg"},{type:"Aadhaar Card or any valid Identity Proof",status:"Pending",fileName:"aadhaar.pdf"}]},{studentId:"STU003",studentName:"Alice Johnson",documents:[{type:"10th (High School) Marksheet",status:"Pending",fileName:"10th_marksheet.pdf"},{type:"Caste Certificate",status:"Pending",fileName:"caste_certificate.pdf"}]}]);return(0,i.jsxs)("div",{className:"verify-documents",children:[(0,i.jsx)("h2",{children:"Verify Student Documents"}),0===e.length?(0,i.jsx)("p",{children:"No documents pending verification."}):e.map(e=>(0,i.jsxs)("div",{className:"student-documents",children:[(0,i.jsxs)("h3",{children:[e.studentName," (ID: ",e.studentId,")"]}),(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Document Type"}),(0,i.jsx)("th",{children:"Status"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsx)("tbody",{children:e.documents.map((s,n)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:s.type}),(0,i.jsx)("td",{children:s.status}),(0,i.jsxs)("td",{children:[(0,i.jsx)("button",{onClick:()=>{return e=s.fileName,void alert("Downloading ".concat(e));var e},children:"View"}),"Pending"===s.status&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>{return n=e.studentId,a=s.type,t(e=>e.map(e=>e.studentId===n?(0,l.A)((0,l.A)({},e),{},{documents:e.documents.map(e=>e.type===a?(0,l.A)((0,l.A)({},e),{},{status:"Verified"}):e)}):e)),void alert('Document "'.concat(a,'" for student ').concat(n," has been verified."));var n,a},children:"Verify"}),(0,i.jsx)("button",{onClick:()=>{return n=e.studentId,a=s.type,t(e=>e.map(e=>e.studentId===n?(0,l.A)((0,l.A)({},e),{},{documents:e.documents.map(e=>e.type===a?(0,l.A)((0,l.A)({},e),{},{status:"Rejected"}):e)}):e)),void alert('Document "'.concat(a,'" for student ').concat(n," has been rejected."));var n,a},children:"Reject"})]})]})]},n))})]})]},e.studentId))]})};s(7091);const fe=()=>{const[e,t]=(0,n.useState)("Dashboard"),[s,d]=(0,n.useState)(null),l={Dashboard:r,"Add User":B,"Manage Users":P,"Session Management":I,"Manage Fees":F,"Manage Concessions":q,"Transport Routes & Fare":z,"Hostel Fees":W,"Generate Discount":H,"Add Subject":G,Registration:J,"New Admission":V,"Collect Fees":Y.A,"Manage Receipts":L,"Duplicate Receipt":Z,"Cancel Receipt":X,"Change Hostel/Transport":ee,"Fee Collection Summary":M.A,"Fee Status Overview":U.A,Notifications:O,"Circulars / Notice":c,"Add Designation":te,"Register Staff":se,"Staff Attendance":ne,"Assign Class":ae,"Leave Days":de,"Add Work":x,"Add Work Report":u,"Assign Work":h,"Staff Work Details":m,"Staff Work Updates":g,"Expense Entry":ie,"Expense Reports":re,"Add Enquiry":y,"Enquiry Detail":b,"Enquiry Follow-up":f,"Add Visitor":v,"Visited List":S,"Transfer Certificate":A,"Character Certificate":N,"Admission Query":me,"Contact Us":ge,"NCC Query":je,"View Documents":ye,"Verify Documents":be,Reports:T,Permissions:E,"Salary Settings":le,"Generate Salary":oe,"Generate Payslip":ce,"Print ID Card":pe,"Generate Admit Card":xe,"Print Admit Card":he,"Examination Center":ue};return(0,i.jsxs)("div",{className:"admin-panel",children:[(0,i.jsxs)("nav",{className:"side-nav",children:[(0,i.jsx)("h2",{children:"Admin Panel"}),(0,i.jsx)("ul",{className:"nav-menu",children:[{name:"Dashboard",sub:[]},{name:"User Management",sub:["Add User","Manage Users"]},{name:"Academic Management",sub:["Session Management","Manage Fees","Manage Concessions","Transport Routes & Fare","Hostel Fees","Generate Discount","Add Subject"]},{name:"Registration & Admission",sub:["Registration","New Admission"]},{name:"Fees & Receipts",sub:["Collect Fees","Manage Receipts","Duplicate Receipt","Cancel Receipt","Change Hostel/Transport","Fee Collection Summary","Fee Status Overview"]},{name:"Notifications",sub:[]},{name:"Circulars / Notice",sub:[]},{name:"Staff Management",sub:["Add Designation","Register Staff","Staff Attendance","Assign Class","Leave Days"]},{name:"Work Management",sub:["Add Work","Add Work Report","Assign Work","Staff Work Details","Staff Work Updates"]},{name:"Expense Management",sub:["Expense Entry","Expense Reports"]},{name:"Enquiry Management",sub:["Add Enquiry","Enquiry Detail","Enquiry Follow-up","Add Visitor","Visited List"]},{name:"Certificates",sub:["Transfer Certificate","Character Certificate"]},{name:"Forms",sub:["Admission Query","Contact Us","NCC Query"]},{name:"Student Documents",sub:["View Documents","Verify Documents"]},{name:"Reports",sub:[]},{name:"Permissions",sub:[]},{name:"Payroll",sub:["Salary Settings","Generate Salary","Generate Payslip"]},{name:"ID & Admit Cards",sub:["Print ID Card","Generate Admit Card","Print Admit Card","Examination Center"]}].map(n=>(0,i.jsxs)("li",{className:n.sub.length>0&&s===n.name?"open":"",children:[(0,i.jsxs)("button",{className:0===n.sub.length&&e===n.name?"active":"",onClick:()=>(e=>{0===e.sub.length?(t(e.name),d(null)):d(t=>t===e.name?null:e.name)})(n),children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[0===n.sub.length?(0,i.jsx)(a.NfF,{}):(0,i.jsx)(a.M1W,{})," ",n.name]}),n.sub.length>0&&(0,i.jsx)("span",{className:"arrow ".concat(s===n.name?"rotated":""),children:"\u25bc"})]}),n.sub.length>0&&(0,i.jsx)("ul",{className:"sub-menu ".concat(s===n.name?"open":""),children:n.sub.map(s=>(0,i.jsx)("li",{children:(0,i.jsx)("button",{className:e===s?"active":"",onClick:()=>{t(s)},children:s})},s))})]},n.name))})]}),(0,i.jsx)("main",{className:"content",children:(()=>{const t=l[e];return t?(0,i.jsx)(t,{}):(0,i.jsx)(r,{})})()})]})}}}]);
//# sourceMappingURL=383.5a6b0702.chunk.js.map