"use strict";(self.webpackChunkclg_web_frontend=self.webpackChunkclg_web_frontend||[]).push([[257,810],{2810:(e,t,s)=>{s.r(t),s.d(t,{default:()=>U});var n=s(5043),a=s(184),r=s(579);var l=s(9722);const o=e=>{let{message:t,type:s="info",onClose:a,duration:l=5e3}=e;(0,n.useEffect)(()=>{if(l>0){const e=setTimeout(a,l);return()=>clearTimeout(e)}},[a,l]);return(0,r.jsxs)("div",{className:"alert ".concat((()=>{switch(s){case"success":return"alert-success";case"error":return"alert-error";case"warning":return"alert-warning";default:return"alert-info"}})()),children:[(0,r.jsx)("span",{children:t}),(0,r.jsx)("button",{className:"alert-close",onClick:a,children:"\xd7"})]})},i=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!1),[i,c]=(0,n.useState)(0),[d,h]=(0,n.useState)([]),[u,m]=(0,n.useState)(0),[x,p]=(0,n.useState)(0),[j,g]=(0,n.useState)({present:0,total:0}),[f,b]=(0,n.useState)(!0);(0,n.useEffect)(()=>{y();(async()=>{try{const e=localStorage.getItem("token"),t={headers:{Authorization:"Bearer ".concat(e)}},s=await l.A.get("/api/staff/assigned-classes",t);c(s.data.length||0);const n=(new Date).toLocaleDateString("en-US",{weekday:"long"}),a=await l.A.get("/api/staff/timetable?day=".concat(n),t);h(a.data);const r=(await l.A.get("/api/staff/work/assignments",t)).data.filter(e=>new Date(e.dueDate)<new Date(Date.now()+6048e5)).length;m(r);const o=(await l.A.get("/api/staff/messages/inbox",t)).data.filter(e=>!e.isRead).length;p(o);const i=(new Date).toISOString().slice(0,7),d=await l.A.get("/api/staff/attendance/monthly?month=".concat(i),t);if(d.data.summary&&d.data.summary.length>0){const e=d.data.summary.reduce((e,t)=>e+t.present,0),t=d.data.summary[0].total;g({present:e,total:t*d.data.summary.length})}b(!1)}catch(e){console.error("Error fetching dashboard data:",e),b(!1)}})()},[]);const y=async()=>{t([{_id:"1",message:"Staff meeting scheduled for tomorrow",type:"info"},{_id:"2",message:"New student enrollment deadline approaching",type:"warning"}])};return f?(0,r.jsx)("div",{className:"loading",children:"Loading dashboard..."}):(0,r.jsxs)("div",{className:"staff-dashboard",children:[(0,r.jsxs)("div",{className:"dashboard-header",children:[(0,r.jsx)("h1",{children:"Staff Dashboard"}),(0,r.jsxs)("div",{className:"alert-icon",onClick:()=>a(!s),children:["\ud83d\udd14",e.length>0&&(0,r.jsx)("span",{className:"alert-count",children:e.length})]})]}),s&&(0,r.jsx)("div",{className:"alerts-panel",children:0===e.length?(0,r.jsx)("p",{children:"No new alerts."}):e.map(s=>(0,r.jsx)(o,{message:s.message,type:s.type,onClose:()=>{return n=s._id,void t(e.filter(e=>e._id!==n));var n},duration:5e3},s._id))}),(0,r.jsxs)("div",{className:"dashboard-cards",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h3",{children:"Assigned Classes"}),(0,r.jsx)("p",{children:i})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h3",{children:"Today's Timetable"}),(0,r.jsxs)("ul",{children:[d.map((e,t)=>(0,r.jsxs)("li",{children:[e.period,": ",e.class," - ",e.subject," (",e.time,")"]},t)),0===d.length&&(0,r.jsx)("li",{children:"No classes today"})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h3",{children:"Pending Assignments"}),(0,r.jsx)("p",{children:u})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h3",{children:"Unread Messages"}),(0,r.jsx)("p",{children:x})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h3",{children:"Attendance Summary (This Month)"}),(0,r.jsxs)("p",{children:["Present: ",j.present," / Total: ",j.total]}),(0,r.jsxs)("p",{children:["Percentage: ",j.total>0?Math.round(j.present/j.total*100):0,"%"]})]})]}),(0,r.jsxs)("div",{className:"recent-notices",children:[(0,r.jsx)("h3",{children:"Recent Notices"}),(0,r.jsx)("p",{children:"No recent notices available."})]})]})};var c=s(9379);const d=()=>{const[e,t]=(0,n.useState)({_id:"",name:"",designation:"",department:"",qualifications:"",joiningDate:"",email:"",phone:"",address:"",profilePicture:null}),[s,a]=(0,n.useState)(!0),[o,i]=(0,n.useState)(!1),[d,h]=(0,n.useState)(""),[u,m]=(0,n.useState)(!1);(0,n.useEffect)(()=>{x()},[]);const x=async()=>{try{const e=localStorage.getItem("token"),s={headers:{Authorization:"Bearer ".concat(e)}},n=await l.A.get("http://localhost:5000/api/staff/profile",s);console.log("Profile data received:",n.data),console.log("Profile picture field:",n.data.profilePicture),t(n.data),a(!1)}catch(d){console.error("Error fetching profile:",d),h("Failed to fetch profile"),a(!1)}},p=s=>{t((0,c.A)((0,c.A)({},e),{},{[s.target.name]:s.target.value}))};return s?(0,r.jsx)("div",{children:"Loading profile..."}):(0,r.jsxs)("div",{className:"staff-profile",children:[(0,r.jsx)("h1",{children:"Staff Profile"}),d&&(0,r.jsx)("div",{className:"error",style:{color:"red",marginBottom:"10px"},children:d}),(0,r.jsxs)("div",{className:"profile-picture-section",style:{marginBottom:"20px",textAlign:"center"},children:[e.profilePicture?(0,r.jsx)("img",{src:"http://localhost:5000/uploads/profile-pictures/".concat(e.profilePicture),alt:"Profile",style:{width:"150px",height:"150px",borderRadius:"50%",objectFit:"cover",border:"3px solid #007bff"},onError:e=>{console.error("Image failed to load:",e.target.src),e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,(0,r.jsx)("div",{style:{width:"150px",height:"150px",borderRadius:"50%",backgroundColor:"#f0f0f0",display:e.profilePicture?"none":"flex",alignItems:"center",justifyContent:"center",border:"3px solid #ccc",margin:"0 auto"},children:(0,r.jsx)("span",{style:{fontSize:"48px",color:"#666"},children:"\ud83d\udc64"})}),(0,r.jsx)("div",{style:{marginTop:"10px"},children:(0,r.jsx)("a",{href:"/staff/upload-photo",style:{color:"#007bff",textDecoration:"none"},children:e.profilePicture?"Change Photo":"Upload Photo"})})]}),(0,r.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),m(!0),h("");try{const t=localStorage.getItem("token"),s={headers:{Authorization:"Bearer ".concat(t)}};await l.A.put("http://localhost:5000/api/staff/profile",e,s),i(!1),await x()}catch(d){h("Failed to update profile")}finally{m(!1)}},children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Staff ID:"}),(0,r.jsx)("input",{type:"text",name:"staffId",value:e.staffId||e._id,disabled:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Name:"}),(0,r.jsx)("input",{type:"text",name:"name",value:e.name,onChange:p,disabled:!o,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Designation:"}),(0,r.jsx)("input",{type:"text",name:"designation",value:e.designation,onChange:p,disabled:!o,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Department:"}),(0,r.jsx)("input",{type:"text",name:"department",value:e.department,onChange:p,disabled:!o,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Qualifications:"}),(0,r.jsx)("textarea",{name:"qualifications",value:e.qualifications,onChange:p,disabled:!o})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Joining Date:"}),(0,r.jsx)("input",{type:"date",name:"joiningDate",value:(e=>{if(!e)return"";return new Date(e).toISOString().split("T")[0]})(e.joiningDate),onChange:p,disabled:!o,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Email:"}),(0,r.jsx)("input",{type:"email",name:"email",value:e.email,onChange:p,disabled:!o,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Phone:"}),(0,r.jsx)("input",{type:"tel",name:"phone",value:e.phone,onChange:p,disabled:!o})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Address:"}),(0,r.jsx)("textarea",{name:"address",value:e.address,onChange:p,disabled:!o})]}),(0,r.jsx)("button",{type:"button",onClick:()=>i(!o),children:o?"Cancel":"Edit Profile"}),o&&(0,r.jsx)("button",{type:"submit",children:"Save Changes"})]}),(0,r.jsx)("div",{className:"profile-actions",children:(0,r.jsx)("a",{href:"/staff/upload-photo",children:"Upload Photo"})})]})};var h=s(5257);const u=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)({class:"",subject:"",title:"",description:"",dueDate:""}),[o,i]=(0,n.useState)(!1),[d,h]=(0,n.useState)("");(0,n.useEffect)(()=>{u()},[]);const u=async()=>{try{const e=localStorage.getItem("token"),s={headers:{Authorization:"Bearer ".concat(e)}},n=await l.A.get("/api/staff/assigned-classes",s);t(n.data.map(e=>e.class))}catch(e){console.error("Error fetching classes:",e)}},m=e=>{a((0,c.A)((0,c.A)({},s),{},{[e.target.name]:e.target.value}))};return(0,r.jsxs)("div",{className:"create-assignment",children:[(0,r.jsx)("h1",{children:"Create Assignment"}),(0,r.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0);try{const e=localStorage.getItem("token"),t={headers:{Authorization:"Bearer ".concat(e)}};await l.A.post("/api/staff/work/assign",s,t),h("Assignment created successfully"),a({class:"",subject:"",title:"",description:"",dueDate:""})}catch(t){h("Failed to create assignment")}i(!1)},children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Class:"}),(0,r.jsxs)("select",{name:"class",value:s.class,onChange:m,required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select Class"}),e.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Subject:"}),(0,r.jsxs)("select",{name:"subject",value:s.subject,onChange:m,required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select Subject"}),(0,r.jsx)("option",{value:"Math",children:"Math"}),(0,r.jsx)("option",{value:"Science",children:"Science"}),(0,r.jsx)("option",{value:"English",children:"English"})]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Title:"}),(0,r.jsx)("input",{type:"text",name:"title",value:s.title,onChange:m,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Description:"}),(0,r.jsx)("textarea",{name:"description",value:s.description,onChange:m,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Due Date:"}),(0,r.jsx)("input",{type:"date",name:"dueDate",value:s.dueDate,onChange:m,required:!0})]}),(0,r.jsx)("button",{type:"submit",disabled:o,children:"Create Assignment"})]}),d&&(0,r.jsx)("div",{className:"message",children:d})]})},m=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(null),[o,i]=(0,n.useState)([]),[c,d]=(0,n.useState)(!1);(0,n.useEffect)(()=>{h()},[]);const h=async()=>{try{const e=localStorage.getItem("token"),s={headers:{Authorization:"Bearer ".concat(e)}},n=await l.A.get("/api/staff/assignments",s);t(n.data)}catch(e){console.error("Error fetching assignments:",e)}},u=async e=>{d(!0);try{const t=localStorage.getItem("token"),s={headers:{Authorization:"Bearer ".concat(t)}},n=await l.A.get("/api/staff/assignments/".concat(e,"/submissions"),s);i(n.data),a(e)}catch(t){console.error("Error fetching submissions:",t)}d(!1)};return(0,r.jsxs)("div",{className:"view-assignments",children:[(0,r.jsx)("h1",{children:"View Assignments"}),(0,r.jsxs)("div",{className:"assignments-list",children:[(0,r.jsx)("h2",{children:"Your Assignments"}),e.map(e=>(0,r.jsxs)("div",{className:"assignment-item",children:[(0,r.jsxs)("h3",{children:[e.title," - ",e.class," (",e.subject,")"]}),(0,r.jsxs)("p",{children:["Due: ",new Date(e.dueDate).toLocaleDateString()]}),(0,r.jsx)("button",{onClick:()=>u(e._id),children:"View Submissions"})]},e._id))]}),s&&(0,r.jsxs)("div",{className:"submissions",children:[(0,r.jsx)("h2",{children:"Submissions"}),c?(0,r.jsx)("div",{children:"Loading..."}):(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Student"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Submitted At"}),(0,r.jsx)("th",{children:"Grade"})]})}),(0,r.jsx)("tbody",{children:o.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.studentName}),(0,r.jsx)("td",{children:e.status}),(0,r.jsx)("td",{children:e.submittedAt?new Date(e.submittedAt).toLocaleDateString():"N/A"}),(0,r.jsx)("td",{children:(0,r.jsx)("input",{type:"text",value:e.grade,onChange:t=>(async(e,t)=>{try{const n=localStorage.getItem("token"),a={headers:{Authorization:"Bearer ".concat(n)}};await l.A.put("/api/staff/submissions/".concat(e,"/grade"),{grade:t},a),u(s)}catch(n){console.error("Error updating grade:",n)}})(e._id,t.target.value),placeholder:"Enter grade"})})]},e._id))})]})]})]})},x=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!1);(0,n.useEffect)(()=>{o()},[]);const o=async()=>{try{const e=localStorage.getItem("token"),s={headers:{Authorization:"Bearer ".concat(e)}},n=await l.A.get("/api/staff/circulars",s);t(n.data)}catch(e){console.error("Error fetching circulars:",e)}};return(0,r.jsxs)("div",{className:"circulars",children:[(0,r.jsx)("h1",{children:"Circulars / Notices"}),s?(0,r.jsx)("div",{children:"Loading..."}):(0,r.jsx)("ul",{children:e.map(e=>(0,r.jsxs)("li",{children:[(0,r.jsx)("h3",{children:e.title}),(0,r.jsx)("p",{children:e.description}),(0,r.jsx)("p",{children:(0,r.jsx)("small",{children:new Date(e.date).toLocaleDateString()})}),e.fileUrl&&(0,r.jsx)("button",{onClick:()=>((e,t)=>{const s=document.createElement("a");s.href=e,s.download=t,s.click()})(e.fileUrl,e.title),children:"Download"})]},e._id))})]})},p=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[o,i]=(0,n.useState)([]),[d,h]=(0,n.useState)([]),[u,m]=(0,n.useState)({}),[x,p]=(0,n.useState)({course:"",semester:"",subject:"",date:(new Date).toISOString().split("T")[0]}),[j,g]=(0,n.useState)(""),[f,b]=(0,n.useState)(!1),[y,v]=(0,n.useState)(!1),[S,w]=(0,n.useState)(""),[N,A]=(0,n.useState)("");(0,n.useEffect)(()=>{C()},[]),(0,n.useEffect)(()=>{x.course?k(x.course):(a([]),i([]),h([]))},[x.course]),(0,n.useEffect)(()=>{x.semester?D(x.course,x.semester):(i([]),h([]))},[x.course,x.semester]),(0,n.useEffect)(()=>{x.subject?F(x.course,x.semester,x.subject):h([])},[x.course,x.semester,x.subject]),(0,n.useEffect)(()=>{if(d.length>0){const e={};d.forEach(t=>{e[t.rollNo]={status:f?"Present":"Absent",remarks:""}}),m(e)}},[d,f]);const C=async()=>{try{console.log("Fetching courses...");const e=await l.A.get("/api/courses");console.log("Courses response:",e.data),t(e.data)}catch(e){console.error("Error fetching courses:",e),t([{id:1,name:"BA"},{id:2,name:"BSc"},{id:3,name:"B.Ed"}]),w("")}},k=async e=>{try{console.log("Fetching semesters for course:",e);const t=await l.A.get("/api/semesters?course=".concat(e));console.log("Semesters response:",t.data),a(t.data)}catch(t){console.error("Error fetching semesters:",t),a([{id:1,name:"Semester 1"},{id:2,name:"Semester 2"},{id:3,name:"Semester 3"}]),w("")}},D=async(e,t)=>{try{console.log("Fetching subjects for course:",e,"semester:",t);const s=await l.A.get("/api/subjects?course=".concat(e,"&semester=").concat(t));console.log("Subjects response:",s.data),i(s.data)}catch(s){console.error("Error fetching subjects:",s),i([{id:1,name:"Subject 1"},{id:2,name:"Subject 2"},{id:3,name:"Subject 3"}]),w("")}},F=async(e,t,s)=>{try{console.log("Fetching students for course:",e,"semester:",t,"subject:",s);const n=await l.A.get("/api/students?course=".concat(e,"&semester=").concat(t,"&subject=").concat(s));console.log("Students response:",n.data),h(n.data)}catch(n){console.error("Error fetching students:",n),h([{rollNo:"101",name:"Student A"},{rollNo:"102",name:"Student B"},{rollNo:"103",name:"Student C"}]),w("")}},P=e=>{const{name:t,value:s}=e.target;p(e=>(0,c.A)((0,c.A)({},e),{},{[t]:s}))},E=(e,t,s)=>{m(n=>(0,c.A)((0,c.A)({},n),{},{[e]:(0,c.A)((0,c.A)({},n[e]),{},{[t]:s})}))},R=d.filter(e=>e.name.toLowerCase().includes(j.toLowerCase())||e.rollNo.toLowerCase().includes(j.toLowerCase()));return(0,r.jsxs)("div",{className:"mark-attendance",children:[(0,r.jsx)("h1",{children:"Mark Student Attendance"}),S&&(0,r.jsx)("div",{className:"error",children:S}),N&&(0,r.jsx)("div",{className:"success",children:N}),(0,r.jsxs)("div",{className:"filter-panel",children:[(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{htmlFor:"attendance-course-select",children:"Course"}),(0,r.jsxs)("select",{id:"attendance-course-select",name:"course",value:x.course,onChange:P,children:[(0,r.jsx)("option",{value:"",children:"Select Course"}),e.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{htmlFor:"attendance-semester-select",children:"Semester"}),(0,r.jsxs)("select",{id:"attendance-semester-select",name:"semester",value:x.semester,onChange:P,disabled:!x.course,children:[(0,r.jsx)("option",{value:"",children:"Select Semester"}),s.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{htmlFor:"attendance-subject-select",children:"Subject"}),(0,r.jsxs)("select",{id:"attendance-subject-select",name:"subject",value:x.subject,onChange:P,disabled:!x.semester,children:[(0,r.jsx)("option",{value:"",children:"Select Subject"}),o.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{htmlFor:"attendance-date-select",children:"Date"}),(0,r.jsx)("input",{id:"attendance-date-select",type:"date",name:"date",value:x.date,onChange:P})]})]}),d.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"table-controls",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by name or roll no",value:j,onChange:e=>g(e.target.value)}),(0,r.jsxs)("label",{children:[(0,r.jsx)("input",{type:"checkbox",checked:f,onChange:e=>b(e.target.checked)}),"Mark All Present"]})]}),(0,r.jsxs)("table",{className:"attendance-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Roll No"}),(0,r.jsx)("th",{children:"Student Name"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Remarks"})]})}),(0,r.jsx)("tbody",{children:R.map(e=>{var t,s;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.rollNo}),(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{children:(0,r.jsxs)("select",{value:(null===(t=u[e.rollNo])||void 0===t?void 0:t.status)||"Absent",onChange:t=>E(e.rollNo,"status",t.target.value),children:[(0,r.jsx)("option",{value:"Present",children:"Present"}),(0,r.jsx)("option",{value:"Absent",children:"Absent"}),(0,r.jsx)("option",{value:"Leave",children:"Leave"})]})}),(0,r.jsx)("td",{children:(0,r.jsx)("input",{type:"text",value:(null===(s=u[e.rollNo])||void 0===s?void 0:s.remarks)||"",onChange:t=>E(e.rollNo,"remarks",t.target.value),placeholder:"Optional remarks"})})]},e.rollNo)})})]}),(0,r.jsx)("button",{onClick:async()=>{if(!x.course||!x.semester||!x.subject||!x.date)return void w("Please select all filters");if(0!==Object.keys(u).filter(e=>"Absent"!==u[e].status).length){v(!0),w(""),A("");try{const e={course:x.course,semester:x.semester,subject:x.subject,date:x.date,attendance:u};await l.A.post("/api/attendance",e),A("Attendance marked successfully")}catch(e){w("Failed to save attendance")}finally{v(!1)}}else w("Please mark attendance for at least one student")},disabled:y,children:y?"Submitting...":"Submit Attendance"})]})]})};var j=s(6396);s(4857);const g=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[o,i]=(0,n.useState)([]),[d,h]=(0,n.useState)({totalDays:0,present:0,absent:0,leave:0,percentage:0}),[u,m]=(0,n.useState)({course:"",semester:"",dateFrom:"",dateTo:"",student:""}),[x,p]=(0,n.useState)(!1),[g,f]=(0,n.useState)(""),[b,y]=(0,n.useState)("table");(0,n.useEffect)(()=>{v()},[]),(0,n.useEffect)(()=>{u.course?S(u.course):a([])},[u.course]),(0,n.useEffect)(()=>{u.course&&u.semester&&u.dateFrom&&u.dateTo?(async()=>{p(!0),f("");try{const e=new URLSearchParams({course:u.course,semester:u.semester,dateFrom:u.dateFrom,dateTo:u.dateTo,student:u.student}),t=await l.A.get("/api/attendance?".concat(e));i(t.data.records),h(t.data.summary)}catch(e){f("Failed to fetch attendance data")}finally{p(!1)}})():(i([]),h({totalDays:0,present:0,absent:0,leave:0,percentage:0}))},[u]);const v=async()=>{try{const e=await l.A.get("/api/courses");t(e.data)}catch(e){f("Failed to fetch courses")}},S=async e=>{try{const t=await l.A.get("/api/semesters?course=".concat(e));a(t.data)}catch(t){f("Failed to fetch semesters")}},w=e=>{const{name:t,value:s}=e.target;m(e=>(0,c.A)((0,c.A)({},e),{},{[t]:s}))};return(0,r.jsxs)("div",{className:"attendance-report",children:[(0,r.jsx)("h1",{children:"View Attendance Summary"}),g&&(0,r.jsx)("div",{className:"error",children:g}),(0,r.jsxs)("div",{className:"filter-panel",children:[(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{htmlFor:"summary-course-select",children:"Course"}),(0,r.jsxs)("select",{id:"summary-course-select",name:"course",value:u.course,onChange:w,children:[(0,r.jsx)("option",{value:"",children:"Select Course"}),e.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{htmlFor:"summary-semester-select",children:"Semester"}),(0,r.jsxs)("select",{id:"summary-semester-select",name:"semester",value:u.semester,onChange:w,disabled:!u.course,children:[(0,r.jsx)("option",{value:"",children:"Select Semester"}),s.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{htmlFor:"summary-date-from",children:"Date From"}),(0,r.jsx)("input",{id:"summary-date-from",type:"date",name:"dateFrom",value:u.dateFrom,onChange:w})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{htmlFor:"summary-date-to",children:"Date To"}),(0,r.jsx)("input",{id:"summary-date-to",type:"date",name:"dateTo",value:u.dateTo,onChange:w})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{htmlFor:"summary-student-search",children:"Student Name/ID"}),(0,r.jsx)("input",{id:"summary-student-search",type:"text",name:"student",value:u.student,onChange:w,placeholder:"Optional"})]})]}),o.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"summary-section",children:[(0,r.jsx)("h2",{children:"Attendance Summary"}),(0,r.jsxs)("div",{className:"summary-stats",children:[(0,r.jsxs)("div",{children:["Total Working Days: ",d.totalDays]}),(0,r.jsxs)("div",{children:["Days Present: ",d.present]}),(0,r.jsxs)("div",{children:["Days Absent: ",d.absent]}),(0,r.jsxs)("div",{children:["Days on Leave: ",d.leave]}),(0,r.jsxs)("div",{style:{color:(N=d.percentage,N>=90?"green":N>=75?"orange":"red")},children:["Attendance %: ",d.percentage.toFixed(2),"%"]})]})]}),(0,r.jsxs)("div",{className:"view-toggle",children:[(0,r.jsx)("button",{onClick:()=>y("table"),className:"table"===b?"active":"",children:"Table View"}),(0,r.jsx)("button",{onClick:()=>y("chart"),className:"chart"===b?"active":"",children:"Chart View"})]}),"table"===b&&(0,r.jsxs)("table",{className:"attendance-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Date"}),(0,r.jsx)("th",{children:"Subject"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Remarks"})]})}),(0,r.jsx)("tbody",{children:o.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.date}),(0,r.jsx)("td",{children:e.subject||""}),(0,r.jsx)("td",{className:"status-".concat(e.status.toLowerCase()),children:e.status}),(0,r.jsx)("td",{children:e.remarks||""})]},t))})]}),"chart"===b&&(0,r.jsx)("div",{className:"chart-placeholder",children:(0,r.jsx)("p",{children:"Chart view not implemented yet. Placeholder for Chart.js integration."})}),(0,r.jsxs)("div",{className:"export-buttons",children:[(0,r.jsx)("button",{onClick:()=>{const e=new j.Ay;e.text("Attendance Report",20,10),e.autoTable({head:[["Date","Subject","Status","Remarks"]],body:o.map(e=>[e.date,e.subject||"",e.status,e.remarks||""])}),e.save("attendance-report.pdf")},children:"Export to PDF"}),(0,r.jsx)("button",{onClick:()=>{const e="data:text/csv;charset=utf-8,Date,Subject,Status,Remarks\n"+o.map(e=>"".concat(e.date,",").concat(e.subject||"",",").concat(e.status,",").concat(e.remarks||"")).join("\n"),t=encodeURI(e),s=document.createElement("a");s.setAttribute("href",t),s.setAttribute("download","attendance-report.csv"),document.body.appendChild(s),s.click()},children:"Export to CSV"})]})]}),x&&(0,r.jsx)("div",{className:"loading",children:"Loading..."})]});var N};var f=s(2823),b=s.n(f),y=(s(5884),s(9711)),v=s(7488),S=s(5496);const w=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(""),[l,o]=(0,n.useState)([]),[i,c]=(0,n.useState)([]),[d,h]=(0,n.useState)([]),[u,m]=(0,n.useState)([]),[x,p]=(0,n.useState)(null),[j,g]=(0,n.useState)(null),[f,w]=(0,n.useState)(null),[N,A]=(0,n.useState)([]),[C,k]=(0,n.useState)(!1);(0,n.useEffect)(()=>{D()},[]);const D=async()=>{try{const e=await S.FH.get("/courses");o(e.data.map(e=>({value:e._id,label:e.name})))}catch(e){console.error("Error fetching courses:",e),v.oR.error("Failed to fetch courses.")}},F=()=>{t(""),a(""),p(null),g(null),w(null),A([]),c([]),h([]),m([])};return(0,r.jsxs)("div",{className:"messaging",children:[(0,r.jsx)("h1",{children:"Messaging"}),(0,r.jsxs)("div",{className:"send-message",children:[(0,r.jsx)("input",{type:"text",placeholder:"Subject (max 100 chars)",value:e,onChange:e=>t(e.target.value.slice(0,100)),maxLength:"100",required:!0}),(0,r.jsx)(b(),{value:s,onChange:a,placeholder:"Message Body (max 5000 chars)",modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image"],["clean"]]},formats:["header","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image"]}),(0,r.jsxs)("div",{className:"filters",children:[(0,r.jsx)(y.Ay,{value:x,onChange:e=>{p(e),g(null),w(null),A([]),c([]),h([]),m([]),e&&(async e=>{try{const t=await S.FH.get("/courses/".concat(e,"/semesters"));c(t.data.map(e=>({value:e._id,label:e.name})))}catch(t){console.error("Error fetching semesters:",t),v.oR.error("Failed to fetch semesters.")}})(e.value)},options:l,placeholder:"Select Course",isClearable:!0}),(0,r.jsx)(y.Ay,{value:j,onChange:e=>{g(e),w(null),A([]),h([]),m([]),e&&(async e=>{try{const t=await S.FH.get("/semesters/".concat(e,"/sections"));h(t.data.map(e=>({value:e._id,label:e.name})))}catch(t){console.error("Error fetching sections:",t),v.oR.error("Failed to fetch sections.")}})(e.value)},options:i,placeholder:"Select Semester",isClearable:!0,isDisabled:!x}),(0,r.jsx)(y.Ay,{value:f,onChange:e=>{w(e),A([]),m([]),e&&(async e=>{try{const t=await S.FH.get("/sections/".concat(e,"/students"));m(t.data.map(e=>({value:e._id,label:e.name})))}catch(t){console.error("Error fetching students:",t),v.oR.error("Failed to fetch students.")}})(e.value)},options:d,placeholder:"Select Section",isClearable:!0,isDisabled:!j}),(0,r.jsx)(y.Ay,{value:N,onChange:e=>{A(e)},options:u,placeholder:"Select Students",isMulti:!0,isDisabled:!f})]}),(0,r.jsxs)("div",{className:"buttons",children:[(0,r.jsx)("button",{onClick:async()=>{if(e.trim()&&s.trim()&&0!==N.length){k(!0);try{const t=localStorage.getItem("userId")||"current_user_id",n=N.map(e=>e.value);await S.FH.post("/message",{sender_id:t,recipient_ids:n,subject:e,body:s,timestamp:(new Date).toISOString(),status:"sent"}),v.oR.success("Message sent successfully!"),F()}catch(t){console.error("Error sending message:",t),v.oR.error("Failed to send message.")}finally{k(!1)}}else v.oR.error("Please fill all required fields and select at least one student.")},disabled:C||!e.trim()||!s.trim()||0===N.length,children:C?"Sending...":"Send"}),(0,r.jsx)("button",{onClick:F,disabled:C,children:"Reset"})]})]})]})},N=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(""),[o,i]=(0,n.useState)(null),[c,d]=(0,n.useState)(!1);(0,n.useEffect)(()=>{h()},[]);const h=async()=>{try{const e=localStorage.getItem("token"),s={headers:{Authorization:"Bearer ".concat(e)}},n=await l.A.get("/api/staff/students",s);t(n.data)}catch(e){console.error("Error fetching students:",e)}};return(0,r.jsxs)("div",{className:"report-card",children:[(0,r.jsx)("h1",{children:"Report Card"}),(0,r.jsxs)("div",{className:"select-student",children:[(0,r.jsxs)("select",{value:s,onChange:e=>a(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Select Student"}),e.map(e=>(0,r.jsxs)("option",{value:e._id,children:[e.name," - ",e.class]},e._id))]}),(0,r.jsx)("button",{onClick:async()=>{if(s){d(!0);try{const e=localStorage.getItem("token"),t={headers:{Authorization:"Bearer ".concat(e)}},n=await l.A.get("/api/staff/report-card/".concat(s),t);i(n.data)}catch(e){console.error("Error generating report card:",e)}d(!1)}},disabled:c||!s,children:"Generate Report"})]}),c?(0,r.jsx)("div",{children:"Loading..."}):o?(0,r.jsxs)("div",{className:"report-details",children:[(0,r.jsxs)("h2",{children:["Report for ",o.studentName]}),(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Subject"}),(0,r.jsx)("th",{children:"Grade"}),(0,r.jsx)("th",{children:"Attendance %"})]})}),(0,r.jsx)("tbody",{children:o.subjects.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.subject}),(0,r.jsx)("td",{children:e.grade}),(0,r.jsx)("td",{children:e.attendancePercentage})]},e.subject))})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Overall Grade:"})," ",o.overallGrade]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Overall Attendance:"})," ",o.overallAttendance,"%"]})]}):(0,r.jsx)("p",{children:"Select a student to generate report card."})]})},A=()=>{const[e,t]=(0,n.useState)({language:"English",notifications:!0,theme:"light"}),s=e=>{const{name:s,value:n,type:a,checked:r}=e.target;t(e=>(0,c.A)((0,c.A)({},e),{},{[s]:"checkbox"===a?r:n}))};return(0,r.jsxs)("div",{className:"settings",children:[(0,r.jsx)("h1",{children:"Settings"}),(0,r.jsxs)("div",{className:"preferences",children:[(0,r.jsx)("h2",{children:"Preferences"}),(0,r.jsxs)("label",{children:["Language:",(0,r.jsxs)("select",{name:"language",value:e.language,onChange:s,children:[(0,r.jsx)("option",{value:"English",children:"English"}),(0,r.jsx)("option",{value:"Hindi",children:"Hindi"})]})]}),(0,r.jsxs)("label",{children:["Notifications:",(0,r.jsx)("input",{type:"checkbox",name:"notifications",checked:e.notifications,onChange:s})]}),(0,r.jsxs)("label",{children:["Theme:",(0,r.jsxs)("select",{name:"theme",value:e.theme,onChange:s,children:[(0,r.jsx)("option",{value:"light",children:"Light"}),(0,r.jsx)("option",{value:"dark",children:"Dark"})]})]}),(0,r.jsx)("button",{onClick:()=>{localStorage.setItem("preferences",JSON.stringify(e)),alert("Preferences saved!")},children:"Save Preferences"})]}),(0,r.jsx)("div",{className:"logout",children:(0,r.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),window.location.href="/login"},children:"Logout"})})]})},C=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)({type:"sick",startDate:"",endDate:"",reason:""}),[o,i]=(0,n.useState)(!1),[d,h]=(0,n.useState)("");(0,n.useEffect)(()=>{u()},[]);const u=async()=>{try{const e=localStorage.getItem("token"),s={headers:{Authorization:"Bearer ".concat(e)}},n=await l.A.get("/api/staff/leaves",s);t(n.data)}catch(e){console.error("Error fetching leaves:",e)}},m=e=>{a((0,c.A)((0,c.A)({},s),{},{[e.target.name]:e.target.value}))};return(0,r.jsxs)("div",{className:"leave-management",children:[(0,r.jsx)("h1",{children:"Leave Management"}),(0,r.jsxs)("div",{className:"apply-leave",children:[(0,r.jsx)("h2",{children:"Apply for Leave"}),(0,r.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0);try{const e=localStorage.getItem("token"),t={headers:{Authorization:"Bearer ".concat(e)}},n=new Date(s.startDate),r=new Date(s.endDate),o=Math.ceil((r-n)/864e5)+1;await l.A.post("/api/staff/leave/apply",(0,c.A)((0,c.A)({},s),{},{days:o}),t),h("Leave applied successfully"),a({type:"sick",startDate:"",endDate:"",reason:""}),u()}catch(t){h("Failed to apply leave")}i(!1)},children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Type:"}),(0,r.jsxs)("select",{name:"type",value:s.type,onChange:m,required:!0,children:[(0,r.jsx)("option",{value:"sick",children:"Sick"}),(0,r.jsx)("option",{value:"casual",children:"Casual"}),(0,r.jsx)("option",{value:"earned",children:"Earned"}),(0,r.jsx)("option",{value:"maternity",children:"Maternity"}),(0,r.jsx)("option",{value:"other",children:"Other"})]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Start Date:"}),(0,r.jsx)("input",{type:"date",name:"startDate",value:s.startDate,onChange:m,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"End Date:"}),(0,r.jsx)("input",{type:"date",name:"endDate",value:s.endDate,onChange:m,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Reason:"}),(0,r.jsx)("textarea",{name:"reason",value:s.reason,onChange:m,required:!0})]}),(0,r.jsx)("button",{type:"submit",disabled:o,children:"Apply Leave"})]}),d&&(0,r.jsx)("div",{className:"message",children:d})]}),(0,r.jsxs)("div",{className:"leave-history",children:[(0,r.jsx)("h2",{children:"Leave History"}),(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Type"}),(0,r.jsx)("th",{children:"Start Date"}),(0,r.jsx)("th",{children:"End Date"}),(0,r.jsx)("th",{children:"Days"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Reason"})]})}),(0,r.jsx)("tbody",{children:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.type}),(0,r.jsx)("td",{children:new Date(e.startDate).toLocaleDateString()}),(0,r.jsx)("td",{children:new Date(e.endDate).toLocaleDateString()}),(0,r.jsx)("td",{children:e.days}),(0,r.jsx)("td",{children:e.status}),(0,r.jsx)("td",{children:e.reason})]},e._id))})]})]})]})},k=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)("Monday"),[o,i]=(0,n.useState)(!0);(0,n.useEffect)(()=>{c()},[s]);const c=async()=>{try{const e=localStorage.getItem("token"),n={headers:{Authorization:"Bearer ".concat(e)}},a=await l.A.get("/api/staff/timetable?day=".concat(s),n);t(a.data),i(!1)}catch(e){console.error("Error fetching timetable:",e),i(!1)}};return o?(0,r.jsx)("div",{children:"Loading timetable..."}):(0,r.jsxs)("div",{className:"timetable",children:[(0,r.jsx)("h1",{children:"Timetable"}),(0,r.jsxs)("div",{className:"day-selector",children:[(0,r.jsx)("label",{children:"Select Day:"}),(0,r.jsx)("select",{value:s,onChange:e=>a(e.target.value),children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsxs)("div",{className:"timetable-view",children:[(0,r.jsxs)("h2",{children:[s,"'s Schedule"]}),e.length>0?(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Period"}),(0,r.jsx)("th",{children:"Class"}),(0,r.jsx)("th",{children:"Subject"}),(0,r.jsx)("th",{children:"Time"}),(0,r.jsx)("th",{children:"Room"})]})}),(0,r.jsx)("tbody",{children:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.period}),(0,r.jsx)("td",{children:e.class}),(0,r.jsx)("td",{children:e.subject}),(0,r.jsx)("td",{children:e.time}),(0,r.jsx)("td",{children:e.room||"N/A"})]},e._id))})]}):(0,r.jsxs)("p",{children:["No classes scheduled for ",s,"."]})]})]})},D=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)((new Date).toISOString().slice(0,7)),[o,i]=(0,n.useState)(!1),[c,d]=(0,n.useState)("");(0,n.useEffect)(()=>{h()},[s]);const h=async()=>{try{const e=localStorage.getItem("token"),n={headers:{Authorization:"Bearer ".concat(e)}},a=await l.A.get("/api/staff/payroll?month=".concat(s),n);t(a.data)}catch(e){console.error("Error fetching payroll:",e)}};return(0,r.jsxs)("div",{className:"payroll",children:[(0,r.jsx)("h1",{children:"Payroll"}),(0,r.jsxs)("div",{className:"month-selector",children:[(0,r.jsx)("label",{children:"Select Month:"}),(0,r.jsx)("input",{type:"month",value:s,onChange:e=>a(e.target.value)}),(0,r.jsx)("button",{onClick:async()=>{i(!0);try{const e=localStorage.getItem("token"),t={headers:{Authorization:"Bearer ".concat(e)}};await l.A.post("/api/staff/payroll/generate",{month:s},t),d("Payslip generated successfully"),h()}catch(e){d("Failed to generate payslip")}i(!1)},disabled:o,children:"Generate Payslip"})]}),c&&(0,r.jsx)("div",{className:"message",children:c}),(0,r.jsx)("div",{className:"payroll-details",children:e.length>0?e.map(e=>(0,r.jsxs)("div",{className:"payslip",children:[(0,r.jsxs)("h3",{children:["Payslip for ",e.month]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Base Salary:"})," \u20b9",e.baseSalary]}),(0,r.jsx)("p",{children:(0,r.jsx)("strong",{children:"Allowances:"})}),(0,r.jsx)("ul",{children:e.allowances.map((e,t)=>(0,r.jsxs)("li",{children:[e.type,": \u20b9",e.amount]},t))}),(0,r.jsx)("p",{children:(0,r.jsx)("strong",{children:"Deductions:"})}),(0,r.jsx)("ul",{children:e.deductions.map((e,t)=>(0,r.jsxs)("li",{children:[e.type,": \u20b9",e.amount]},t))}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Net Salary:"})," \u20b9",e.netSalary]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Status:"})," ",e.status]}),e.payslipUrl&&(0,r.jsx)("a",{href:e.payslipUrl,target:"_blank",rel:"noopener noreferrer",children:"Download Payslip"})]},e._id)):(0,r.jsx)("p",{children:"No payroll data for selected month."})})]})},F=[{class_id:"C101",class_name:"Physics 101",section:"A",academic_year:"2025"},{class_id:"C102",class_name:"Chemistry 101",section:"B",academic_year:"2025"},{class_id:"C103",class_name:"Mathematics 101",section:"A",academic_year:"2025"}],P={C101:[{subject_id:"S101",subject_name:"Mechanics",subject_code:"PHY101",subject_type:"Theory",semester:"5"},{subject_id:"S102",subject_name:"Physics Lab",subject_code:"PHY101L",subject_type:"Lab",semester:"5"}],C102:[{subject_id:"S201",subject_name:"Organic Chemistry",subject_code:"CHEM101",subject_type:"Theory",semester:"5"}],C103:[{subject_id:"S301",subject_name:"Calculus",subject_code:"MATH101",subject_type:"Theory",semester:"5"},{subject_id:"S302",subject_name:"Linear Algebra",subject_code:"MATH102",subject_type:"Theory",semester:"5"}]},E=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(null),[l,o]=(0,n.useState)([]),[i,c]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t(F)},[]);const d=e=>{a(e),o(P[e.class_id]||[]),c(!0)};return(0,r.jsxs)("div",{className:"assign-class",children:[(0,r.jsx)("h1",{children:"Assigned Classes"}),(0,r.jsxs)("table",{className:"classes-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Class Name"}),(0,r.jsx)("th",{children:"Section"}),(0,r.jsx)("th",{children:"Academic Year"})]})}),(0,r.jsx)("tbody",{children:e.length>0?e.map(e=>(0,r.jsxs)("tr",{onClick:()=>d(e),tabIndex:"0",onKeyDown:t=>"Enter"===t.key&&d(e),children:[(0,r.jsx)("td",{children:e.class_name}),(0,r.jsx)("td",{children:e.section}),(0,r.jsx)("td",{children:e.academic_year})]},e.class_id)):(0,r.jsx)("tr",{className:"empty-state",children:(0,r.jsx)("td",{colSpan:"3",children:"No classes assigned yet"})})})]}),i&&s&&(0,r.jsxs)("div",{className:"subject-panel",children:[(0,r.jsxs)("h2",{children:["Subjects for ",s.class_name," - Section ",s.section]}),(0,r.jsxs)("table",{className:"subjects-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Subject Name"}),(0,r.jsx)("th",{children:"Code"}),(0,r.jsx)("th",{children:"Type"}),(0,r.jsx)("th",{children:"Semester"})]})}),(0,r.jsx)("tbody",{children:l.length>0?l.map(e=>(0,r.jsxs)("tr",{className:"Theory"===e.subject_type?"theory-row":"lab-row",children:[(0,r.jsx)("td",{children:e.subject_name}),(0,r.jsx)("td",{children:e.subject_code}),(0,r.jsx)("td",{children:e.subject_type}),(0,r.jsx)("td",{children:e.semester})]},e.subject_id)):(0,r.jsx)("tr",{className:"empty-state",children:(0,r.jsx)("td",{colSpan:"4",children:"No subjects mapped to this class"})})})]}),(0,r.jsx)("button",{className:"close-btn",onClick:()=>{a(null),o([]),c(!1)},children:"Close"})]})]})};s(1627);const R=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[l,o]=(0,n.useState)("");(0,n.useEffect)(()=>{i()},[]);const i=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("/api/staff/documents/course",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){const e=await s.json();t(e.students),e.students.length>0&&o(e.students[0].course)}else alert("Failed to fetch documents")}catch(e){console.error("Fetch error:",e),alert("Failed to fetch documents")}finally{a(!1)}};return s?(0,r.jsx)("div",{children:"Loading documents..."}):(0,r.jsxs)("div",{className:"view-documents",children:[(0,r.jsxs)("h2",{children:["View Student Documents (",l,")"]}),e.map(e=>(0,r.jsxs)("div",{className:"student-documents",children:[(0,r.jsxs)("h3",{children:[e.studentName," (ID: ",e.studentId,") - Course: ",e.course]}),(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Document Type"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Action"})]})}),(0,r.jsx)("tbody",{children:e.documents.map((t,s)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:t.type}),(0,r.jsx)("td",{children:t.status}),(0,r.jsx)("td",{children:t.fileName?(0,r.jsx)("button",{onClick:()=>(async(e,t)=>{try{const s=localStorage.getItem("token"),n=await fetch("/api/staff/documents/download/".concat(e,"/").concat(encodeURIComponent(t)),{headers:{Authorization:"Bearer ".concat(s)}});if(n.ok){const e=await n.blob(),s=window.URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=t,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s),document.body.removeChild(a)}else alert("Download failed")}catch(s){console.error("Download error:",s),alert("Download failed")}})(e.studentId,t.type),children:"Download"}):(0,r.jsx)("span",{children:"Not Uploaded"})})]},s))})]})]},e.studentId))]})},T=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[l,o]=(0,n.useState)(null);(0,n.useEffect)(()=>{i()},[]);const i=async()=>{try{const e=localStorage.getItem("token");if(!e)return o("No authentication token found"),void a(!1);const s=await fetch("/api/staff/documents/course",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok)throw new Error("HTTP error! status: ".concat(s.status));const n=await s.json();t(n.students||[])}catch(e){o(e.message)}finally{a(!1)}};return s?(0,r.jsx)("div",{className:"verify-documents",children:(0,r.jsx)("p",{children:"Loading documents..."})}):l?(0,r.jsx)("div",{className:"verify-documents",children:(0,r.jsxs)("p",{children:["Error: ",l]})}):(0,r.jsxs)("div",{className:"verify-documents",children:[(0,r.jsx)("h2",{children:"Verify Student Documents"}),0===e.length?(0,r.jsx)("p",{children:"No documents pending verification."}):e.map(e=>(0,r.jsxs)("div",{className:"student-documents",children:[(0,r.jsxs)("h3",{children:[e.studentName," (ID: ",e.studentId,")"]}),(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Document Type"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Actions"})]})}),(0,r.jsx)("tbody",{children:e.documents.map((s,n)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:s.type}),(0,r.jsx)("td",{children:s.status}),(0,r.jsxs)("td",{children:[s.fileName&&(0,r.jsx)("button",{onClick:()=>(async(e,t)=>{try{const s=localStorage.getItem("token"),n=await fetch("/api/staff/documents/download/".concat(e,"/").concat(encodeURIComponent(t)),{headers:{Authorization:"Bearer ".concat(s)}});if(!n.ok)throw new Error("HTTP error! status: ".concat(n.status));const a=await n.blob(),r=window.URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download="".concat(t.replace(/[^a-zA-Z0-9]/g,"_"),".pdf"),document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(r),document.body.removeChild(l)}catch(s){alert("Error downloading document: ".concat(s.message))}})(e.studentId,s.type),children:"View"}),"Pending"===s.status&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>(async(e,s)=>{try{const n=localStorage.getItem("token"),a=await fetch("/api/staff/documents/verify",{method:"PUT",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({studentId:e,documentType:s,status:"Verified"})});if(!a.ok)throw new Error("HTTP error! status: ".concat(a.status));const r=await a.json();alert(r.message),t(t=>t.map(t=>t.studentId===e?(0,c.A)((0,c.A)({},t),{},{documents:t.documents.map(e=>e.type===s?(0,c.A)((0,c.A)({},e),{},{status:"Verified"}):e)}):t))}catch(n){alert("Error verifying document: ".concat(n.message))}})(e.studentId,s.type),children:"Verify"}),(0,r.jsx)("button",{onClick:()=>(async(e,s)=>{try{const n=localStorage.getItem("token"),a=await fetch("/api/staff/documents/verify",{method:"PUT",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({studentId:e,documentType:s,status:"Rejected"})});if(!a.ok)throw new Error("HTTP error! status: ".concat(a.status));const r=await a.json();alert(r.message),t(t=>t.map(t=>t.studentId===e?(0,c.A)((0,c.A)({},t),{},{documents:t.documents.map(e=>e.type===s?(0,c.A)((0,c.A)({},e),{},{status:"Rejected"}):e)}):t))}catch(n){alert("Error rejecting document: ".concat(n.message))}})(e.studentId,s.type),children:"Reject"})]})]})]},n))})]})]},e.studentId))]})};s(3137);var I=s(3383),L=s(328),_=s(5668),B=s(1981);const z=()=>{const[e,t]=(0,n.useState)({daily:[],weekly:[],monthly:[],yearly:[]}),[s,a]=(0,n.useState)(!1),[l,o]=(0,n.useState)("monthly"),[i,d]=(0,n.useState)({course:"",year:"",semester:""}),[h,u]=(0,n.useState)("");(0,n.useEffect)(()=>{m()},[l,i]);const m=async()=>{a(!0);try{const e=localStorage.getItem("token"),s=new URLSearchParams((0,c.A)({period:l},i)),n=await fetch("http://localhost:5000/api/reports/collections?".concat(s),{headers:{Authorization:"Bearer ".concat(e)}});if(n.ok){const e=await n.json();t(t=>(0,c.A)((0,c.A)({},t),{},{[l]:e}))}else u("Failed to fetch collection summary")}catch(e){u("Error fetching collection summary: "+e.message)}finally{a(!1)}},x=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),p=e=>e.reduce((e,t)=>e+t.totalCollection,0),j=e=>e.reduce((e,t)=>e+t.totalPayments,0);return(0,r.jsxs)("div",{className:"menu-content",children:[(0,r.jsx)("h1",{children:"Total Fee Collection Summary"}),(0,r.jsx)("p",{children:"Comprehensive overview of fee collections across different time periods and categories."}),h&&(0,r.jsx)("div",{className:"message ".concat(h.includes("Error")||h.includes("Failed")?"error":"success"),children:h}),(0,r.jsxs)("div",{className:"filters-section",children:[(0,r.jsx)("h3",{children:"Filters"}),(0,r.jsxs)("div",{className:"filter-row",children:[(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{children:"Course:"}),(0,r.jsxs)("select",{value:i.course,onChange:e=>d(t=>(0,c.A)((0,c.A)({},t),{},{course:e.target.value})),children:[(0,r.jsx)("option",{value:"",children:"All Courses"}),(0,r.jsx)("option",{value:"B.A",children:"B.A"}),(0,r.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,r.jsx)("option",{value:"B.Ed",children:"B.Ed"})]})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{children:"Year:"}),(0,r.jsx)("input",{type:"number",value:i.year,onChange:e=>d(t=>(0,c.A)((0,c.A)({},t),{},{year:e.target.value})),placeholder:"e.g., 2024"})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{children:"Semester:"}),(0,r.jsxs)("select",{value:i.semester,onChange:e=>d(t=>(0,c.A)((0,c.A)({},t),{},{semester:e.target.value})),children:[(0,r.jsx)("option",{value:"",children:"All Semesters"}),(0,r.jsx)("option",{value:"1",children:"Semester 1"}),(0,r.jsx)("option",{value:"2",children:"Semester 2"})]})]})]})]}),(0,r.jsx)("div",{className:"tab-navigation",children:["daily","weekly","monthly","yearly"].map(e=>(0,r.jsx)("button",{className:"tab-button ".concat(l===e?"active":""),onClick:()=>o(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,r.jsx)("div",{className:"tab-content",children:(()=>{const t=e[l]||[];return s?(0,r.jsx)("div",{className:"loading",children:"Loading collection summary..."}):0===t.length?(0,r.jsx)("div",{className:"no-data",children:"No collection data available for the selected period."}):(0,r.jsxs)("div",{className:"summary-container",children:[(0,r.jsxs)("div",{className:"summary-cards",children:[(0,r.jsxs)("div",{className:"summary-card",children:[(0,r.jsx)("h3",{children:"Total Collection"}),(0,r.jsx)("p",{className:"amount",children:x(p(t))})]}),(0,r.jsxs)("div",{className:"summary-card",children:[(0,r.jsx)("h3",{children:"Total Payments"}),(0,r.jsx)("p",{className:"count",children:j(t)})]}),(0,r.jsxs)("div",{className:"summary-card",children:[(0,r.jsx)("h3",{children:"Average per Payment"}),(0,r.jsx)("p",{className:"amount",children:j(t)>0?x(p(t)/j(t)):x(0)})]})]}),(0,r.jsx)("div",{className:"table-container",children:(0,r.jsxs)("table",{className:"summary-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Course"}),(0,r.jsx)("th",{children:"Year"}),(0,r.jsx)("th",{children:"Semester"}),(0,r.jsx)("th",{children:"Total Collection"}),(0,r.jsx)("th",{children:"Total Payments"}),(0,r.jsx)("th",{children:"Payment Types"})]})}),(0,r.jsx)("tbody",{children:t.map((e,t)=>{var s;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e._id.course}),(0,r.jsx)("td",{children:e._id.year}),(0,r.jsx)("td",{children:e._id.semester}),(0,r.jsx)("td",{className:"amount-cell",children:x(e.totalCollection)}),(0,r.jsx)("td",{children:e.totalPayments}),(0,r.jsx)("td",{children:null===(s=e.paymentTypes)||void 0===s?void 0:s.map((e,t)=>(0,r.jsxs)("div",{className:"payment-type",children:[e.type,": ",x(e.totalAmount)," (",e.count," payments)"]},t))})]},t)})})]})})]})})()}),(0,r.jsx)("style",{children:"\n        .menu-content {\n          padding: 20px;\n          max-width: 1200px;\n          margin: 0 auto;\n        }\n\n        .message {\n          padding: 10px;\n          margin: 10px 0;\n          border-radius: 4px;\n          font-weight: bold;\n        }\n\n        .message.error {\n          background-color: #ffebee;\n          color: #c62828;\n          border: 1px solid #ef5350;\n        }\n\n        .message.success {\n          background-color: #e8f5e8;\n          color: #2e7d32;\n          border: 1px solid #4caf50;\n        }\n\n        .filters-section {\n          background: #f8f9fa;\n          padding: 20px;\n          border-radius: 8px;\n          margin-bottom: 20px;\n        }\n\n        .filter-row {\n          display: flex;\n          gap: 20px;\n          flex-wrap: wrap;\n        }\n\n        .filter-group {\n          display: flex;\n          flex-direction: column;\n          min-width: 150px;\n        }\n\n        .filter-group label {\n          margin-bottom: 5px;\n          font-weight: bold;\n        }\n\n        .filter-group select,\n        .filter-group input {\n          padding: 8px;\n          border: 1px solid #ddd;\n          border-radius: 4px;\n        }\n\n        .tab-navigation {\n          display: flex;\n          margin-bottom: 20px;\n          border-bottom: 1px solid #ddd;\n        }\n\n        .summary-container {\n          margin-top: 20px;\n        }\n\n        .summary-cards {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n          gap: 20px;\n          margin-bottom: 30px;\n        }\n\n        .summary-card {\n          background: white;\n          padding: 20px;\n          border-radius: 8px;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n          text-align: center;\n        }\n\n        .summary-card h3 {\n          margin: 0 0 10px 0;\n          color: #666;\n          font-size: 14px;\n          text-transform: uppercase;\n        }\n\n        .summary-card .amount {\n          font-size: 24px;\n          font-weight: bold;\n          color: #28a745;\n          margin: 0;\n        }\n\n        .summary-card .count {\n          font-size: 24px;\n          font-weight: bold;\n          color: #007bff;\n          margin: 0;\n        }\n\n        .table-container {\n          background: white;\n          border-radius: 8px;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n          overflow: hidden;\n        }\n\n        .summary-table {\n          width: 100%;\n          border-collapse: collapse;\n        }\n\n        .summary-table th,\n        .summary-table td {\n          padding: 12px;\n          text-align: left;\n          border-bottom: 1px solid #eee;\n        }\n\n        .summary-table th {\n          background: #f8f9fa;\n          font-weight: bold;\n          color: #333;\n        }\n\n        .amount-cell {\n          font-weight: bold;\n          color: #28a745;\n        }\n\n        .payment-type {\n          margin-bottom: 4px;\n          font-size: 12px;\n          color: #666;\n        }\n\n        .loading, .no-data {\n          text-align: center;\n          padding: 40px;\n          font-size: 16px;\n          color: #666;\n        }\n\n        .no-data {\n          color: #999;\n        }\n      "})]})},M=()=>{const[e,t]=(0,n.useState)({paid:{count:0,amount:0,students:[]},pending:{count:0,amount:0,students:[]},overdue:{count:0,amount:0,students:[]}}),[s,a]=(0,n.useState)(!1),[l,o]=(0,n.useState)("overview"),[i,d]=(0,n.useState)({course:"",year:"",semester:""}),[h,u]=(0,n.useState)(""),[m,x]=(0,n.useState)(null);(0,n.useEffect)(()=>{p()},[i]);const p=async()=>{a(!0);try{const e=localStorage.getItem("token"),s=new URLSearchParams(i),n=await fetch("http://localhost:5000/api/reports/payments/stats?".concat(s),{headers:{Authorization:"Bearer ".concat(e)}});let a=null;if(i.course&&(a=await fetch("http://localhost:5000/api/reports/defaulters?".concat(s),{headers:{Authorization:"Bearer ".concat(e)}})),n.ok){const e=await n.json();let s={totalDefaulters:0,totalDueAmount:0,defaulters:[]};a&&(s=await a.json());const r=j(e,s);t(r)}else u("Failed to fetch fee status data")}catch(e){u("Error fetching fee status data: "+e.message)}finally{a(!1)}},j=(e,t)=>{let s=0,n=0,a=0;return e.forEach(e=>{s+=e.paid||0,n+=e.pending||0}),a=t.totalDueAmount||0,{paid:{count:e.reduce((e,t)=>e+(t.paidCount||0),0),amount:s,students:[]},pending:{count:e.reduce((e,t)=>e+(t.pendingCount||0),0),amount:n,students:[]},overdue:{count:t.totalDefaulters||0,amount:a,students:t.defaulters||[]}}},g=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),f=t=>{const n=e[t],a=n.students||[];return s?(0,r.jsxs)("div",{className:"loading",children:["Loading ",t," fee details..."]}):0===a.length?(0,r.jsxs)("div",{className:"no-data",children:["No ",t," fees found."]}):(0,r.jsxs)("div",{className:"detailed-list",children:[(0,r.jsxs)("div",{className:"list-header",children:[(0,r.jsxs)("h3",{children:[t.charAt(0).toUpperCase()+t.slice(1)," Fee Details"]}),(0,r.jsxs)("div",{className:"summary-stats",children:[(0,r.jsxs)("span",{children:["Total Students: ",n.count]}),(0,r.jsxs)("span",{children:["Total Amount: ",g(n.amount)]})]})]}),(0,r.jsx)("div",{className:"table-container",children:(0,r.jsxs)("table",{className:"status-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Student ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Course"}),(0,r.jsx)("th",{children:"Year"}),(0,r.jsx)("th",{children:"Semester"}),"overdue"===t&&(0,r.jsx)("th",{children:"Due Amount"}),"overdue"===t&&(0,r.jsx)("th",{children:"Days Overdue"}),(0,r.jsx)("th",{children:"Actions"})]})}),(0,r.jsx)("tbody",{children:a.map((e,s)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.studentId}),(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{children:e.course}),(0,r.jsx)("td",{children:e.year}),(0,r.jsx)("td",{children:e.semester}),"overdue"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("td",{className:"amount-cell",children:g(e.dueAmount)}),(0,r.jsxs)("td",{className:"overdue-cell ".concat(e.daysOverdue>30?"critical":""),children:[e.daysOverdue," days"]})]}),(0,r.jsxs)("td",{children:[(0,r.jsx)("button",{className:"action-btn view-btn",onClick:()=>x(e),children:"View Details"}),"overdue"===t&&(0,r.jsx)("button",{className:"action-btn notify-btn",children:"Send Reminder"})]})]},s))})]})})]})};return(0,r.jsxs)("div",{className:"menu-content",children:[(0,r.jsx)("h1",{children:"Active/Pending/Overdue Fees"}),(0,r.jsx)("p",{children:"Monitor active, pending, and overdue fees across all students."}),h&&(0,r.jsx)("div",{className:"message ".concat(h.includes("Error")||h.includes("Failed")?"error":"success"),children:h}),(0,r.jsxs)("div",{className:"filters-section",children:[(0,r.jsx)("h3",{children:"Filters"}),(0,r.jsxs)("div",{className:"filter-row",children:[(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{children:"Course:"}),(0,r.jsxs)("select",{value:i.course,onChange:e=>d(t=>(0,c.A)((0,c.A)({},t),{},{course:e.target.value})),children:[(0,r.jsx)("option",{value:"",children:"All Courses"}),(0,r.jsx)("option",{value:"B.A",children:"B.A"}),(0,r.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,r.jsx)("option",{value:"B.Ed",children:"B.Ed"})]})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{children:"Year:"}),(0,r.jsx)("input",{type:"number",value:i.year,onChange:e=>d(t=>(0,c.A)((0,c.A)({},t),{},{year:e.target.value})),placeholder:"e.g., 2024"})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{children:"Semester:"}),(0,r.jsxs)("select",{value:i.semester,onChange:e=>d(t=>(0,c.A)((0,c.A)({},t),{},{semester:e.target.value})),children:[(0,r.jsx)("option",{value:"",children:"All Semesters"}),(0,r.jsx)("option",{value:"1",children:"Semester 1"}),(0,r.jsx)("option",{value:"2",children:"Semester 2"})]})]})]})]}),(0,r.jsxs)("div",{className:"tab-navigation",children:[(0,r.jsx)("button",{className:"tab-button ".concat("overview"===l?"active":""),onClick:()=>o("overview"),children:"Overview"}),(0,r.jsxs)("button",{className:"tab-button ".concat("paid"===l?"active":""),onClick:()=>o("paid"),children:["Paid (",e.paid.count,")"]}),(0,r.jsxs)("button",{className:"tab-button ".concat("pending"===l?"active":""),onClick:()=>o("pending"),children:["Pending (",e.pending.count,")"]}),(0,r.jsxs)("button",{className:"tab-button ".concat("overdue"===l?"active":""),onClick:()=>o("overdue"),children:["Overdue (",e.overdue.count,")"]})]}),(0,r.jsxs)("div",{className:"tab-content",children:["overview"===l&&(0,r.jsxs)("div",{className:"overview-grid",children:[(0,r.jsxs)("div",{className:"status-card paid",children:[(0,r.jsx)("div",{className:"status-icon",children:"\u2713"}),(0,r.jsxs)("div",{className:"status-content",children:[(0,r.jsx)("h3",{children:"Paid Fees"}),(0,r.jsxs)("div",{className:"status-numbers",children:[(0,r.jsx)("span",{className:"count",children:e.paid.count}),(0,r.jsx)("span",{className:"amount",children:g(e.paid.amount)})]})]})]}),(0,r.jsxs)("div",{className:"status-card pending",children:[(0,r.jsx)("div",{className:"status-icon",children:"\u23f3"}),(0,r.jsxs)("div",{className:"status-content",children:[(0,r.jsx)("h3",{children:"Pending Fees"}),(0,r.jsxs)("div",{className:"status-numbers",children:[(0,r.jsx)("span",{className:"count",children:e.pending.count}),(0,r.jsx)("span",{className:"amount",children:g(e.pending.amount)})]})]})]}),(0,r.jsxs)("div",{className:"status-card overdue",children:[(0,r.jsx)("div",{className:"status-icon",children:"\u26a0\ufe0f"}),(0,r.jsxs)("div",{className:"status-content",children:[(0,r.jsx)("h3",{children:"Overdue Fees"}),(0,r.jsxs)("div",{className:"status-numbers",children:[(0,r.jsx)("span",{className:"count",children:e.overdue.count}),(0,r.jsx)("span",{className:"amount",children:g(e.overdue.amount)})]})]})]})]}),"paid"===l&&f("paid"),"pending"===l&&f("pending"),"overdue"===l&&f("overdue")]}),m?(0,r.jsx)("div",{className:"modal-overlay",onClick:()=>x(null),children:(0,r.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"modal-header",children:[(0,r.jsx)("h3",{children:"Student Details"}),(0,r.jsx)("button",{className:"close-btn",onClick:()=>x(null),children:"\xd7"})]}),(0,r.jsx)("div",{className:"modal-body",children:(0,r.jsxs)("div",{className:"student-info",children:[(0,r.jsxs)("div",{className:"info-row",children:[(0,r.jsx)("label",{children:"Student ID:"}),(0,r.jsx)("span",{children:m.studentId})]}),(0,r.jsxs)("div",{className:"info-row",children:[(0,r.jsx)("label",{children:"Name:"}),(0,r.jsx)("span",{children:m.name})]}),(0,r.jsxs)("div",{className:"info-row",children:[(0,r.jsx)("label",{children:"Course:"}),(0,r.jsx)("span",{children:m.course})]}),(0,r.jsxs)("div",{className:"info-row",children:[(0,r.jsx)("label",{children:"Year:"}),(0,r.jsx)("span",{children:m.year})]}),(0,r.jsxs)("div",{className:"info-row",children:[(0,r.jsx)("label",{children:"Semester:"}),(0,r.jsx)("span",{children:m.semester})]}),m.dueAmount&&(0,r.jsxs)("div",{className:"info-row",children:[(0,r.jsx)("label",{children:"Due Amount:"}),(0,r.jsx)("span",{className:"amount",children:g(m.dueAmount)})]}),m.daysOverdue&&(0,r.jsxs)("div",{className:"info-row",children:[(0,r.jsx)("label",{children:"Days Overdue:"}),(0,r.jsxs)("span",{className:m.daysOverdue>30?"critical":"",children:[m.daysOverdue," days"]})]})]})})]})}):null,(0,r.jsx)("style",{children:"\n        .menu-content {\n          padding: 20px;\n          max-width: 1200px;\n          margin: 0 auto;\n        }\n\n        .message {\n          padding: 10px;\n          margin: 10px 0;\n          border-radius: 4px;\n          font-weight: bold;\n        }\n\n        .message.error {\n          background-color: #ffebee;\n          color: #c62828;\n          border: 1px solid #ef5350;\n        }\n\n        .message.success {\n          background-color: #e8f5e8;\n          color: #2e7d32;\n          border: 1px solid #4caf50;\n        }\n\n        .filters-section {\n          background: #f8f9fa;\n          padding: 20px;\n          border-radius: 8px;\n          margin-bottom: 20px;\n        }\n\n        .filter-row {\n          display: flex;\n          gap: 20px;\n          flex-wrap: wrap;\n        }\n\n        .filter-group {\n          display: flex;\n          flex-direction: column;\n          min-width: 150px;\n        }\n\n        .filter-group label {\n          margin-bottom: 5px;\n          font-weight: bold;\n        }\n\n        .filter-group select,\n        .filter-group input {\n          padding: 8px;\n          border: 1px solid #ddd;\n          border-radius: 4px;\n        }\n\n        .tab-navigation {\n          display: flex;\n          margin-bottom: 20px;\n          border-bottom: 1px solid #ddd;\n          flex-wrap: wrap;\n        }\n\n        .overview-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n          gap: 20px;\n          margin-top: 20px;\n        }\n\n        .status-card {\n          background: white;\n          padding: 25px;\n          border-radius: 12px;\n          box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n          display: flex;\n          align-items: center;\n          gap: 20px;\n          transition: transform 0.2s ease;\n        }\n\n        .status-card:hover {\n          transform: translateY(-2px);\n        }\n\n        .status-card.paid {\n          border-left: 4px solid #28a745;\n        }\n\n        .status-card.pending {\n          border-left: 4px solid #ffc107;\n        }\n\n        .status-card.overdue {\n          border-left: 4px solid #dc3545;\n        }\n\n        .status-icon {\n          font-size: 32px;\n          opacity: 0.8;\n        }\n\n        .status-content h3 {\n          margin: 0 0 10px 0;\n          color: #333;\n          font-size: 18px;\n        }\n\n        .status-numbers {\n          display: flex;\n          flex-direction: column;\n          gap: 5px;\n        }\n\n        .status-numbers .count {\n          font-size: 28px;\n          font-weight: bold;\n          color: #007bff;\n        }\n\n        .status-numbers .amount {\n          font-size: 16px;\n          color: #666;\n          font-weight: 500;\n        }\n\n        .detailed-list {\n          margin-top: 20px;\n        }\n\n        .list-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 20px;\n          flex-wrap: wrap;\n          gap: 10px;\n        }\n\n        .summary-stats {\n          display: flex;\n          gap: 20px;\n          flex-wrap: wrap;\n        }\n\n        .summary-stats span {\n          background: #f8f9fa;\n          padding: 8px 16px;\n          border-radius: 20px;\n          font-weight: bold;\n          color: #495057;\n        }\n\n        .table-container {\n          background: white;\n          border-radius: 8px;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n          overflow-x: auto;\n        }\n\n        .status-table {\n          width: 100%;\n          border-collapse: collapse;\n          min-width: 800px;\n        }\n\n        .status-table th,\n        .status-table td {\n          padding: 12px;\n          text-align: left;\n          border-bottom: 1px solid #eee;\n        }\n\n        .status-table th {\n          background: #f8f9fa;\n          font-weight: bold;\n          color: #333;\n          position: sticky;\n          top: 0;\n        }\n\n        .amount-cell {\n          font-weight: bold;\n          color: #28a745;\n        }\n\n        .overdue-cell {\n          font-weight: bold;\n        }\n\n        .overdue-cell.critical {\n          color: #dc3545;\n        }\n\n        .action-btn {\n          padding: 6px 12px;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 12px;\n          margin-right: 5px;\n          transition: background-color 0.2s ease;\n        }\n\n        .view-btn {\n          background-color: #007bff;\n          color: white;\n        }\n\n        .view-btn:hover {\n          background-color: #0056b3;\n        }\n\n        .notify-btn {\n          background-color: #ffc107;\n          color: #212529;\n        }\n\n        .notify-btn:hover {\n          background-color: #e0a800;\n        }\n\n        .loading, .no-data {\n          text-align: center;\n          padding: 40px;\n          font-size: 16px;\n          color: #666;\n        }\n\n        .no-data {\n          color: #999;\n        }\n\n        .modal-overlay {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: rgba(0,0,0,0.5);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          z-index: 1000;\n        }\n\n        .modal-content {\n          background: white;\n          border-radius: 8px;\n          width: 90%;\n          max-width: 500px;\n          max-height: 80vh;\n          overflow-y: auto;\n        }\n\n        .modal-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          padding: 20px;\n          border-bottom: 1px solid #eee;\n        }\n\n        .modal-header h3 {\n          margin: 0;\n        }\n\n        .close-btn {\n          background: none;\n          border: none;\n          font-size: 24px;\n          cursor: pointer;\n          color: #666;\n        }\n\n        .modal-body {\n          padding: 20px;\n        }\n\n        .student-info {\n          display: flex;\n          flex-direction: column;\n          gap: 15px;\n        }\n\n        .info-row {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          padding: 10px 0;\n          border-bottom: 1px solid #f0f0f0;\n        }\n\n        .info-row label {\n          font-weight: bold;\n          color: #555;\n        }\n\n        .info-row span {\n          color: #333;\n        }\n\n        .info-row .amount {\n          color: #28a745;\n          font-weight: bold;\n        }\n\n        .info-row .critical {\n          color: #dc3545;\n          font-weight: bold;\n        }\n      "})]})},U=()=>{const[e,t]=(0,n.useState)("Dashboard"),[l,o]=(0,n.useState)(null),[c,j]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{const e=localStorage.getItem("token");if(e)try{const t=JSON.parse(atob(e.split(".")[1]));j(t.designation||"")}catch(t){console.error("Error parsing token:",t);try{const{auth:e}=await Promise.resolve().then(s.bind(s,5496)),t=await e.getCurrentUser();t.success&&j(t.data.designation||"")}catch(n){console.error("Error fetching user info:",n)}}})()},[]);const f=[{name:"Dashboard",sub:[]},{name:"Profile Management",sub:["Profile","Upload Photo","Contact Info"]},{name:"Class Assignment Management",sub:["Assign Class/Subject","View Assignments"]},{name:"Attendance Management",sub:["Attendance Entry","Attendance View","Daily/Monthly Reports"]},{name:"Leave Management",sub:["Apply for Leave","View Leave History"]},{name:"Messaging",sub:["Send/Receive Messages","Alerts"]},{name:"Timetable",sub:[]},{name:"Circular/Notices",sub:["View Notices","Download"]},{name:"Work Management",sub:["Assignments","Reports"]},{name:"Student Documents",sub:["View Documents","Verify Documents"]},{name:"Report Card",sub:[]},{name:"Payroll",sub:["View Salary","Payslip"]},{name:"Settings",sub:["Preferences","Logout"]}],b="Fees Administrator"===c?[...f.slice(0,9),{name:"Fees",sub:["Collect Fees","Manage Receipts","Duplicate Receipts","Cancel Receipt","Total Fee Collection Summary","Active/Pending/Overdue Fees"]},...f.slice(9)]:f,y={Dashboard:i,Profile:d,"Upload Photo":h.default,"Assign Class/Subject":E,"View Assignments":m,"Attendance Entry":p,"Attendance View":g,"Daily/Monthly Reports":g,"Apply for Leave":C,"View Leave History":C,"Send/Receive Messages":w,Alerts:w,Timetable:k,"View Notices":x,Download:x,Assignments:u,Reports:m,"View Documents":R,"Verify Documents":T,"Collect Fees":I.A,"Manage Receipts":L.A,"Duplicate Receipts":_.A,"Cancel Receipt":B.A,"Total Fee Collection Summary":z,"Active/Pending/Overdue Fees":M,"Detailed Transactions Report":()=>(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Detailed Transactions Report"}),(0,r.jsx)("p",{children:"Sabhi students ke individual transactions: date, amount, mode (cash, card, online), payment status."}),(0,r.jsx)("p",{children:"Filters for courses, batches, payment dates, fee status."})]}),"Fee Structure Management":()=>(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Fee Structure Management"}),(0,r.jsx)("p",{children:"Create/update fee heads and amounts for every course/batch/semester/year."}),(0,r.jsx)("p",{children:"Change history log (kis admin/staff ne kya update kiya)."})]}),"Receipt Management":()=>(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Receipt Management"}),(0,r.jsx)("p",{children:"Generate, view, download, print receipts for all transactions."}),(0,r.jsx)("p",{children:"Re-issue or correct receipts (with approval system)."})]}),"Scholarship/Concession Monitoring":()=>(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Scholarship/Concession Monitoring"}),(0,r.jsx)("p",{children:"Kis student ko kya concession/scholarship mila, total concession amount ka summary."})]}),"Refund/Adjustment Tracking":()=>(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Refund/Adjustment Tracking"}),(0,r.jsx)("p",{children:"Kis cases me refund/adjustment hua, reason, approval status."})]}),"Alerts & Notifications":()=>(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Alerts & Notifications"}),(0,r.jsx)("p",{children:"Due fee reminders, overdue alerts, communication logs (SMS, Email)."})]}),"Audit Log":()=>(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Audit Log"}),(0,r.jsx)("p",{children:"All changes/actions performed in fee system\u2014complete activity trail."})]}),"Export Reports":()=>(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Export Reports"}),(0,r.jsx)("p",{children:"Download reports in PDF/Excel (collection, dues, batch-wise, etc.)."})]}),"Role/Permission Management":()=>(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Role/Permission Management"}),(0,r.jsx)("p",{children:"Kis staff/admin ko kya access hai\u2014user management panel."})]}),"Report Card":N,"View Salary":D,Payslip:D,Preferences:A,Logout:()=>{localStorage.removeItem("token"),window.location.href="/login"}};return(0,r.jsxs)("div",{className:"admin-panel",children:[(0,r.jsxs)("nav",{className:"side-nav",children:[(0,r.jsx)("h2",{children:"Staff Panel"}),(0,r.jsx)("ul",{className:"nav-menu",children:b.map(s=>(0,r.jsxs)("li",{className:s.sub.length>0&&l===s.name?"open":"",children:[(0,r.jsxs)("button",{className:0===s.sub.length&&e===s.name?"active":"",onClick:()=>(e=>{0===e.sub.length?(t(e.name),o(null)):o(t=>t===e.name?null:e.name)})(s),children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[0===s.sub.length?(0,r.jsx)(a.NfF,{}):(0,r.jsx)(a.M1W,{})," ",s.name]}),s.sub.length>0&&(0,r.jsx)("span",{className:"arrow ".concat(l===s.name?"rotated":""),children:"\u25bc"})]}),s.sub.length>0&&(0,r.jsx)("ul",{className:"sub-menu ".concat(l===s.name?"open":""),children:s.sub.map(s=>(0,r.jsx)("li",{children:(0,r.jsx)("button",{className:e===s?"active":"",onClick:()=>{t(s)},children:s})},s))})]},s.name))})]}),(0,r.jsx)("main",{className:"content",children:(()=>{const t=y[e];return"function"===typeof t&&"Logout"===t.name?(t(),(0,r.jsx)("div",{children:"Logging out..."})):t?(0,r.jsx)(t,{}):(0,r.jsx)(i,{})})()})]})}},3137:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(5043),a=(s(7265),s(579));const r=()=>{const[e,t]=(0,n.useState)(null),[s,r]=(0,n.useState)([]),[l,o]=(0,n.useState)(null),[i,c]=(0,n.useState)(!1),[d,h]=(0,n.useState)(""),[u,m]=(0,n.useState)("fees"),[x,p]=(0,n.useState)("semester"),[j,g]=(0,n.useState)([]);(0,n.useEffect)(()=>{f(),y()},[]),(0,n.useEffect)(()=>{null!==l&&void 0!==l&&l.department&&b(l.department)},[l]),(0,n.useEffect)(()=>{if(e&&s.length>=0){const e=w(s);g(e)}},[e,s]);const f=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();o(e)}}catch(e){console.error("Error fetching student info:",e)}},b=async e=>{try{const s=localStorage.getItem("token"),n=await fetch("http://localhost:5000/api/fees/".concat(e),{headers:{Authorization:"Bearer ".concat(s)}});if(n.ok){const e=await n.json();t(e)}}catch(s){console.error("Error fetching fee structure:",s)}},y=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/payments/my-payments",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();r(e)}}catch(e){console.error("Error fetching payments:",e)}},v=()=>e,S=(e,t)=>{if(!e)return 0;const s=e.totalFee;return"semester"===t?s/2:s},w=t=>{if(!e)return[];const s=[{head:"Tuition Fee",total:e.feeComponents.tuitionFee},{head:"Library Fee",total:e.feeComponents.libraryFee},{head:"Laboratory Fee",total:e.feeComponents.laboratoryFee},{head:"Examination Fee",total:e.feeComponents.examinationFee},{head:"Sports Fee",total:e.feeComponents.sportsFee},{head:"Development Fee",total:e.feeComponents.developmentFee},{head:"Miscellaneous",total:e.feeComponents.miscellaneousFee}];let n=t.reduce((e,t)=>"Paid"===t.status?e+t.amount:e,0);return s.map(e=>{const t=Math.min(n,e.total);return n-=t,{head:e.head,amount:e.total,paid:t,balance:Math.max(0,e.total-t)}})},N=e=>{switch(e){case"Paid":return"#28a745";case"Pending":return"#ffc107";case"Failed":return"#dc3545";default:return"#6c757d"}},A=v(),C=S(A,x);return(0,a.jsxs)("div",{className:"menu-content",children:[(0,a.jsx)("h1",{children:"My Fees"}),(0,a.jsx)("p",{children:"View your fee structure and payment history."}),d&&(0,a.jsx)("div",{style:{padding:"10px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:d.includes("Error")||d.includes("Failed")?"#ffebee":"#e8f5e8",color:d.includes("Error")||d.includes("Failed")?"#c62828":"#2e7d32"},children:d}),(0,a.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,a.jsx)("button",{onClick:()=>m("fees"),style:{padding:"10px 20px",marginRight:"10px",backgroundColor:"fees"===u?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Fee Details"}),(0,a.jsx)("button",{onClick:()=>m("payments"),style:{padding:"10px 20px",backgroundColor:"payments"===u?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Payment History"})]}),"fees"===u&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Fees Summary"}),l&&j.length>0&&(0,a.jsx)("div",{style:{overflowX:"auto",marginBottom:"20px"},children:(0,a.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #ddd"},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,a.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Fee Head"}),(0,a.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"center"},children:"Total Amount"}),(0,a.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"center"},children:"Paid"}),(0,a.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"center"},children:"Balance"})]})}),(0,a.jsxs)("tbody",{children:[j.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd",fontWeight:"Tuition Fee"===e.head?"bold":"normal"},children:e.head}),(0,a.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"center"},children:["\u20b9",e.amount.toLocaleString()]}),(0,a.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"center"},children:["\u20b9",e.paid.toLocaleString()]}),(0,a.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"center"},children:["\u20b9",e.balance.toLocaleString()]})]},t)),(0,a.jsxs)("tr",{style:{backgroundColor:"#e7f3ff"},children:[(0,a.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd",fontWeight:"bold"},children:"Total"}),(0,a.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"center",fontWeight:"bold"},children:["\u20b9",j.reduce((e,t)=>e+t.amount,0).toLocaleString()]}),(0,a.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"center",fontWeight:"bold"},children:["\u20b9",j.reduce((e,t)=>e+t.paid,0).toLocaleString()]}),(0,a.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"center",fontWeight:"bold"},children:["\u20b9",j.reduce((e,t)=>e+t.balance,0).toLocaleString()]})]})]})]})}),!j.length&&l&&(0,a.jsx)("div",{style:{marginBottom:"20px",padding:"20px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#f8f9fa"},children:(0,a.jsxs)("p",{children:["No fee summary available for your course: ",l.department]})}),A&&(0,a.jsx)("div",{style:{marginBottom:"20px"},children:(0,a.jsxs)("div",{style:{border:"2px solid #007bff",borderRadius:"8px",padding:"20px",backgroundColor:"#e7f3ff",marginBottom:"20px"},children:[(0,a.jsxs)("p",{style:{fontSize:"18px",fontWeight:"bold",color:"#007bff"},children:["Total Annual Fee: \u20b9",A.totalFee.toLocaleString()]}),(0,a.jsxs)("p",{children:["Semester Fee: \u20b9",(A.totalFee/2).toLocaleString()]})]})}),(0,a.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,a.jsx)("h4",{children:"Submit Fee Payment"}),(0,a.jsxs)("div",{style:{display:"flex",gap:"15px",alignItems:"center",marginBottom:"15px"},children:[(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{type:"radio",value:"semester",checked:"semester"===x,onChange:e=>p(e.target.value)}),"Pay for Semester (\u20b9",A?(A.totalFee/2).toLocaleString():0,")"]}),(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{type:"radio",value:"year",checked:"year"===x,onChange:e=>p(e.target.value)}),"Pay for Year (\u20b9",A?A.totalFee.toLocaleString():0,")"]})]}),(0,a.jsx)("button",{onClick:async()=>{if(!l||!v())return void h("Unable to process payment. Student information or fee structure not found.");const e=v(),t=S(e,x);c(!0),h("");try{const e=localStorage.getItem("token"),s=await fetch("http://localhost:5000/api/payments/initiate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({course:l.department,year:l.year,semester:l.semester,paymentType:x,amount:t})}),n=await s.json();s.ok?(h("Payment initiated successfully! Please complete the payment process."),y()):h(n.message||"Failed to initiate payment")}catch(s){h("Error initiating payment: "+s.message)}finally{c(!1)}},disabled:i||!A,style:{padding:"12px 24px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:i||!A?"not-allowed":"pointer",fontSize:"16px"},children:i?"Processing...":"Submit Payment \u20b9".concat(C.toLocaleString()," for ").concat("semester"===x?"Semester":"Year")})]})]}),"payments"===u&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Payment History"}),(0,a.jsx)("div",{style:{maxHeight:"600px",overflowY:"auto"},children:s.length>0?(0,a.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,a.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Year"}),(0,a.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Semester"}),(0,a.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Type"}),(0,a.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Amount"}),(0,a.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Status"}),(0,a.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"Date"})]})}),(0,a.jsx)("tbody",{children:s.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.year}),(0,a.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.semester}),(0,a.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.paymentType}),(0,a.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:["\u20b9",e.amount]}),(0,a.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,a.jsx)("span",{style:{padding:"3px 8px",borderRadius:"12px",backgroundColor:N(e.status),color:"white",fontSize:"12px"},children:e.status})}),(0,a.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:new Date(e.createdAt).toLocaleDateString()})]},e._id))})]}):(0,a.jsx)("p",{children:"No payment records found."})})]})]})}},5257:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var n=s(5043),a=s(9722),r=s(579);const l=()=>{const[e,t]=(0,n.useState)(null),[s,l]=(0,n.useState)(null),[o,i]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),[h,u]=(0,n.useState)(""),m=(0,n.useRef)(null);return(0,r.jsxs)("div",{className:"upload-photo-container",children:[(0,r.jsx)("h1",{children:"Upload Profile Photo"}),(0,r.jsx)("p",{children:"Upload and crop profile picture for ID card, attendance logs, and dashboard."}),h&&(0,r.jsx)("div",{className:"error-message",style:{color:"red",marginBottom:"10px"},children:h}),c&&(0,r.jsx)("div",{className:"success-message",style:{color:"green",marginBottom:"10px"},children:c}),(0,r.jsxs)("div",{className:"upload-section",children:[(0,r.jsx)("input",{type:"file",ref:m,onChange:e=>{const s=e.target.files[0];if(s){if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(s.type))return void u("Please select a valid image file (JPEG, PNG, GIF)");if(s.size>5242880)return void u("File size must be less than 5MB");t(s),u("");const e=new FileReader;e.onload=e=>l(e.target.result),e.readAsDataURL(s)}},accept:"image/*",style:{marginBottom:"10px"}}),s&&(0,r.jsxs)("div",{className:"preview-section",style:{marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"Preview:"}),(0,r.jsx)("img",{src:s,alt:"Profile Preview",style:{maxWidth:"200px",maxHeight:"200px",borderRadius:"50%",objectFit:"cover",border:"2px solid #ccc"}})]}),(0,r.jsxs)("div",{className:"upload-actions",children:[(0,r.jsx)("button",{onClick:async()=>{if(e){i(!0),u(""),d("");try{const s=localStorage.getItem("token"),n=new FormData;n.append("profilePicture",e);const r={headers:{Authorization:"Bearer ".concat(s),"Content-Type":"multipart/form-data"}};await a.A.post("http://localhost:5000/api/staff/profile-picture",n,r);d("Profile picture uploaded successfully!"),t(null),l(null),m.current&&(m.current.value=""),setTimeout(()=>{window.location.reload()},1500)}catch(h){var s,n;u((null===(s=h.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.message)||"Failed to upload profile picture")}finally{i(!1)}}else u("Please select a file first")},disabled:!e||o,style:{padding:"10px 20px",marginRight:"10px",backgroundColor:e&&!o?"#007bff":"#ccc",color:"white",border:"none",borderRadius:"4px",cursor:e&&!o?"pointer":"not-allowed"},children:o?"Uploading...":"Upload Photo"}),(0,r.jsx)("button",{onClick:()=>{t(null),l(null),u(""),d(""),m.current&&(m.current.value="")},disabled:o,style:{padding:"10px 20px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:o?"not-allowed":"pointer"},children:"Cancel"})]})]}),(0,r.jsxs)("div",{className:"upload-info",style:{marginTop:"20px",fontSize:"14px",color:"#666"},children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Supported formats:"})," JPEG, PNG, GIF"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Maximum file size:"})," 5MB"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Recommended:"})," Square images (1:1 aspect ratio) for best results"]})]})]})}}}]);
//# sourceMappingURL=810.b4081439.chunk.js.map